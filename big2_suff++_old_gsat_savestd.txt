nohup: ignoring input

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:44:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:29 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:43 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:46 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:48 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:50 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:52 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:52 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 11:44:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:44:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3178
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3259
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3250
OOD Validation ACCURACY: 0.8527
OOD Validation Loss: 0.5111
OOD Test ACCURACY: 0.6287
OOD Test Loss: 1.1683

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9295
Train Loss: 0.3278
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3391
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3296
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3661
OOD Test ACCURACY: 0.5353
OOD Test Loss: 1.3356

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.6287 0.9287 0.5353 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.692
WIoU for r=0.3 = 0.567
F1 for r=0.6 = 0.583
WIoU for r=0.6 = 0.463
F1 for r=0.9 = 0.469
WIoU for r=0.9 = 0.347
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.326
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.869
WIoU for r=0.3 = 0.780
F1 for r=0.6 = 0.798
WIoU for r=0.6 = 0.710
F1 for r=0.9 = 0.618
WIoU for r=0.9 = 0.499
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 0.460
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.353
WIoU for r=0.3 = 0.253
F1 for r=0.6 = 0.626
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.592
WIoU for r=0.9 = 0.434
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.401


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  0.69200125
Model XAI WIoU of binarized graphs for r=0.3 =  0.5666525
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.426
SUFF++ for r=0.3 class 0 = 0.413 +- 0.279 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.3 class 1 = 0.538 +- 0.279 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.3 class 2 = 0.583 +- 0.279 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.3 all KL = 0.475 +- 0.279 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.3 all L1 = 0.513 +- 0.198 (in-sample avg dev_std = 0.499)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.5828512499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.4629225
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.615
SUFF++ for r=0.6 class 0 = 0.426 +- 0.290 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 1 = 0.549 +- 0.290 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 2 = 0.654 +- 0.290 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 all KL = 0.523 +- 0.290 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 all L1 = 0.546 +- 0.211 (in-sample avg dev_std = 0.504)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.4685725
Model XAI WIoU of binarized graphs for r=0.9 =  0.34654
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.837
SUFF++ for r=0.9 class 0 = 0.666 +- 0.169 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 1 = 0.793 +- 0.169 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 2 = 0.862 +- 0.169 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all KL = 0.844 +- 0.169 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all L1 = 0.776 +- 0.166 (in-sample avg dev_std = 0.261)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.441
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.78040875
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.373
SUFF++ for r=0.3 class 0 = 0.467 +- 0.321 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 1 = 0.64 +- 0.321 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 2 = 0.564 +- 0.321 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 all KL = 0.494 +- 0.321 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 all L1 = 0.556 +- 0.201 (in-sample avg dev_std = 0.586)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.65
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.7103800000000001
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.74
SUFF++ for r=0.6 class 0 = 0.621 +- 0.322 (in-sample avg dev_std = 0.546)
SUFF++ for r=0.6 class 1 = 0.579 +- 0.322 (in-sample avg dev_std = 0.546)
SUFF++ for r=0.6 class 2 = 0.757 +- 0.322 (in-sample avg dev_std = 0.546)
SUFF++ for r=0.6 all KL = 0.59 +- 0.322 (in-sample avg dev_std = 0.546)
SUFF++ for r=0.6 all L1 = 0.652 +- 0.198 (in-sample avg dev_std = 0.546)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.877
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.49911875
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF++ for r=0.9 class 0 = 0.796 +- 0.118 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.9 class 1 = 0.828 +- 0.118 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.9 class 2 = 0.946 +- 0.118 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.9 all KL = 0.937 +- 0.118 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.9 all L1 = 0.857 +- 0.128 (in-sample avg dev_std = 0.204)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.34
Model XAI F1 of binarized graphs for r=0.3 =  0.35290625000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.25268625
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.351
SUFF++ for r=0.3 class 0 = 0.609 +- 0.229 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 1 = 0.671 +- 0.229 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 2 = 0.635 +- 0.229 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 all KL = 0.652 +- 0.229 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 all L1 = 0.638 +- 0.160 (in-sample avg dev_std = 0.407)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.459
Model XAI F1 of binarized graphs for r=0.6 =  0.626405
Model XAI WIoU of binarized graphs for r=0.6 =  0.48389875000000004
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.513
SUFF++ for r=0.6 class 0 = 0.463 +- 0.259 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.6 class 1 = 0.542 +- 0.259 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.6 class 2 = 0.576 +- 0.259 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.6 all KL = 0.517 +- 0.259 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.6 all L1 = 0.527 +- 0.195 (in-sample avg dev_std = 0.523)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  0.59177625
Model XAI WIoU of binarized graphs for r=0.9 =  0.43375749999999996
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.676
SUFF++ for r=0.9 class 0 = 0.665 +- 0.172 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 1 = 0.887 +- 0.172 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 2 = 0.739 +- 0.172 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 all KL = 0.849 +- 0.172 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 all L1 = 0.761 +- 0.189 (in-sample avg dev_std = 0.303)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.538
Model XAI F1 of binarized graphs for r=0.3 =  0.69200125
Model XAI WIoU of binarized graphs for r=0.3 =  0.5666525
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.342
NEC for r=0.3 class 0 = 0.648 +- 0.305 (in-sample avg dev_std = 0.430)
NEC for r=0.3 class 1 = 0.535 +- 0.305 (in-sample avg dev_std = 0.430)
NEC for r=0.3 class 2 = 0.505 +- 0.305 (in-sample avg dev_std = 0.430)
NEC for r=0.3 all KL = 0.599 +- 0.305 (in-sample avg dev_std = 0.430)
NEC for r=0.3 all L1 = 0.561 +- 0.207 (in-sample avg dev_std = 0.430)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.5828512499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.4629225
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.392
NEC for r=0.6 class 0 = 0.582 +- 0.257 (in-sample avg dev_std = 0.504)
NEC for r=0.6 class 1 = 0.595 +- 0.257 (in-sample avg dev_std = 0.504)
NEC for r=0.6 class 2 = 0.581 +- 0.257 (in-sample avg dev_std = 0.504)
NEC for r=0.6 all KL = 0.643 +- 0.257 (in-sample avg dev_std = 0.504)
NEC for r=0.6 all L1 = 0.586 +- 0.168 (in-sample avg dev_std = 0.504)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.905
Model XAI F1 of binarized graphs for r=0.9 =  0.4685725
Model XAI WIoU of binarized graphs for r=0.9 =  0.34654
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.495
NEC for r=0.9 class 0 = 0.621 +- 0.222 (in-sample avg dev_std = 0.608)
NEC for r=0.9 class 1 = 0.558 +- 0.222 (in-sample avg dev_std = 0.608)
NEC for r=0.9 class 2 = 0.541 +- 0.222 (in-sample avg dev_std = 0.608)
NEC for r=0.9 all KL = 0.644 +- 0.222 (in-sample avg dev_std = 0.608)
NEC for r=0.9 all L1 = 0.572 +- 0.150 (in-sample avg dev_std = 0.608)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.32596125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.515
NEC for r=1.0 class 0 = 0.563 +- 0.243 (in-sample avg dev_std = 0.649)
NEC for r=1.0 class 1 = 0.517 +- 0.243 (in-sample avg dev_std = 0.649)
NEC for r=1.0 class 2 = 0.57 +- 0.243 (in-sample avg dev_std = 0.649)
NEC for r=1.0 all KL = 0.622 +- 0.243 (in-sample avg dev_std = 0.649)
NEC for r=1.0 all L1 = 0.55 +- 0.170 (in-sample avg dev_std = 0.649)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.442
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.78040875
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.223
NEC for r=0.3 class 0 = 0.676 +- 0.319 (in-sample avg dev_std = 0.482)
NEC for r=0.3 class 1 = 0.479 +- 0.319 (in-sample avg dev_std = 0.482)
NEC for r=0.3 class 2 = 0.614 +- 0.319 (in-sample avg dev_std = 0.482)
NEC for r=0.3 all KL = 0.643 +- 0.319 (in-sample avg dev_std = 0.482)
NEC for r=0.3 all L1 = 0.591 +- 0.212 (in-sample avg dev_std = 0.482)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.65
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.7103800000000001
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.436
NEC for r=0.6 class 0 = 0.481 +- 0.319 (in-sample avg dev_std = 0.450)
NEC for r=0.6 class 1 = 0.353 +- 0.319 (in-sample avg dev_std = 0.450)
NEC for r=0.6 class 2 = 0.301 +- 0.319 (in-sample avg dev_std = 0.450)
NEC for r=0.6 all KL = 0.386 +- 0.319 (in-sample avg dev_std = 0.450)
NEC for r=0.6 all L1 = 0.378 +- 0.256 (in-sample avg dev_std = 0.450)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.877
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.49911875
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.579
NEC for r=0.9 class 0 = 0.425 +- 0.225 (in-sample avg dev_std = 0.557)
NEC for r=0.9 class 1 = 0.351 +- 0.225 (in-sample avg dev_std = 0.557)
NEC for r=0.9 class 2 = 0.369 +- 0.225 (in-sample avg dev_std = 0.557)
NEC for r=0.9 all KL = 0.327 +- 0.225 (in-sample avg dev_std = 0.557)
NEC for r=0.9 all L1 = 0.382 +- 0.162 (in-sample avg dev_std = 0.557)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.87
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  0.45974875000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.623
NEC for r=1.0 class 0 = 0.427 +- 0.226 (in-sample avg dev_std = 0.560)
NEC for r=1.0 class 1 = 0.334 +- 0.226 (in-sample avg dev_std = 0.560)
NEC for r=1.0 class 2 = 0.363 +- 0.226 (in-sample avg dev_std = 0.560)
NEC for r=1.0 all KL = 0.331 +- 0.226 (in-sample avg dev_std = 0.560)
NEC for r=1.0 all L1 = 0.375 +- 0.160 (in-sample avg dev_std = 0.560)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.34
Model XAI F1 of binarized graphs for r=0.3 =  0.35290625000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.25268625
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.337
NEC for r=0.3 class 0 = 0.518 +- 0.287 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 1 = 0.304 +- 0.287 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 2 = 0.433 +- 0.287 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all KL = 0.413 +- 0.287 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all L1 = 0.421 +- 0.205 (in-sample avg dev_std = 0.401)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.459
Model XAI F1 of binarized graphs for r=0.6 =  0.626405
Model XAI WIoU of binarized graphs for r=0.6 =  0.48389875000000004
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.445
NEC for r=0.6 class 0 = 0.639 +- 0.245 (in-sample avg dev_std = 0.553)
NEC for r=0.6 class 1 = 0.588 +- 0.245 (in-sample avg dev_std = 0.553)
NEC for r=0.6 class 2 = 0.62 +- 0.245 (in-sample avg dev_std = 0.553)
NEC for r=0.6 all KL = 0.66 +- 0.245 (in-sample avg dev_std = 0.553)
NEC for r=0.6 all L1 = 0.616 +- 0.137 (in-sample avg dev_std = 0.553)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  0.59177625
Model XAI WIoU of binarized graphs for r=0.9 =  0.43375749999999996
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.533
NEC for r=0.9 class 0 = 0.538 +- 0.214 (in-sample avg dev_std = 0.545)
NEC for r=0.9 class 1 = 0.429 +- 0.214 (in-sample avg dev_std = 0.545)
NEC for r=0.9 class 2 = 0.529 +- 0.214 (in-sample avg dev_std = 0.545)
NEC for r=0.9 all KL = 0.481 +- 0.214 (in-sample avg dev_std = 0.545)
NEC for r=0.9 all L1 = 0.5 +- 0.137 (in-sample avg dev_std = 0.545)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.629
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.401135
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.562
NEC for r=1.0 class 0 = 0.492 +- 0.210 (in-sample avg dev_std = 0.509)
NEC for r=1.0 class 1 = 0.309 +- 0.210 (in-sample avg dev_std = 0.509)
NEC for r=1.0 class 2 = 0.512 +- 0.210 (in-sample avg dev_std = 0.509)
NEC for r=1.0 all KL = 0.432 +- 0.210 (in-sample avg dev_std = 0.509)
NEC for r=1.0 all L1 = 0.44 +- 0.173 (in-sample avg dev_std = 0.509)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:48:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 11:48:52 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:05 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:07 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:09 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:11 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:13 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:13 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 11:49:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.713
WIoU for r=0.3 = 0.588
F1 for r=0.6 = 0.608
WIoU for r=0.6 = 0.491
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.354
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.329
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.869
WIoU for r=0.3 = 0.781
F1 for r=0.6 = 0.798
WIoU for r=0.6 = 0.697
F1 for r=0.9 = 0.618
WIoU for r=0.9 = 0.484
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 0.445
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.361
WIoU for r=0.3 = 0.265
F1 for r=0.6 = 0.628
WIoU for r=0.6 = 0.491
F1 for r=0.9 = 0.590
WIoU for r=0.9 = 0.432
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.402


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.501
Model XAI F1 of binarized graphs for r=0.3 =  0.71258375
Model XAI WIoU of binarized graphs for r=0.3 =  0.5879375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.459
SUFF++ for r=0.3 class 0 = 0.436 +- 0.255 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.3 class 1 = 0.546 +- 0.255 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.3 class 2 = 0.564 +- 0.255 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.3 all KL = 0.547 +- 0.255 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.3 all L1 = 0.517 +- 0.154 (in-sample avg dev_std = 0.472)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.684
Model XAI F1 of binarized graphs for r=0.6 =  0.60751
Model XAI WIoU of binarized graphs for r=0.6 =  0.49118375000000003
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.635
SUFF++ for r=0.6 class 0 = 0.441 +- 0.278 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 1 = 0.683 +- 0.278 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 2 = 0.664 +- 0.278 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 all KL = 0.618 +- 0.278 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 all L1 = 0.599 +- 0.208 (in-sample avg dev_std = 0.436)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  0.47401625
Model XAI WIoU of binarized graphs for r=0.9 =  0.35372499999999996
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.853
SUFF++ for r=0.9 class 0 = 0.66 +- 0.175 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 1 = 0.829 +- 0.175 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 2 = 0.872 +- 0.175 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all KL = 0.857 +- 0.175 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all L1 = 0.79 +- 0.167 (in-sample avg dev_std = 0.252)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.439
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.78059125
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.413
SUFF++ for r=0.3 class 0 = 0.534 +- 0.294 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.3 class 1 = 0.74 +- 0.294 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.3 class 2 = 0.56 +- 0.294 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.3 all KL = 0.551 +- 0.294 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.3 all L1 = 0.611 +- 0.197 (in-sample avg dev_std = 0.533)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.736
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.6969562499999999
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.798
SUFF++ for r=0.6 class 0 = 0.647 +- 0.280 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 class 1 = 0.712 +- 0.280 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 class 2 = 0.939 +- 0.280 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 all KL = 0.787 +- 0.280 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 all L1 = 0.766 +- 0.224 (in-sample avg dev_std = 0.383)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.825
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.48420875
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.866
SUFF++ for r=0.9 class 0 = 0.855 +- 0.076 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 class 1 = 0.942 +- 0.076 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 class 2 = 0.852 +- 0.076 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 all KL = 0.952 +- 0.076 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 all L1 = 0.882 +- 0.119 (in-sample avg dev_std = 0.174)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.279
Model XAI F1 of binarized graphs for r=0.3 =  0.36146124999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.26462250000000004
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.307
SUFF++ for r=0.3 class 0 = 0.521 +- 0.179 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 1 = 0.518 +- 0.179 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 2 = 0.532 +- 0.179 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 all KL = 0.619 +- 0.179 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 all L1 = 0.524 +- 0.110 (in-sample avg dev_std = 0.454)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.635
Model XAI F1 of binarized graphs for r=0.6 =  0.62756625
Model XAI WIoU of binarized graphs for r=0.6 =  0.49079625
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.61
SUFF++ for r=0.6 class 0 = 0.685 +- 0.226 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 class 1 = 0.774 +- 0.226 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 class 2 = 0.773 +- 0.226 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 all KL = 0.771 +- 0.226 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 all L1 = 0.743 +- 0.184 (in-sample avg dev_std = 0.387)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.663
Model XAI F1 of binarized graphs for r=0.9 =  0.5903499999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.43229999999999996
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.642
SUFF++ for r=0.9 class 0 = 0.74 +- 0.106 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 class 1 = 0.96 +- 0.106 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 class 2 = 0.782 +- 0.106 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 all KL = 0.92 +- 0.106 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 all L1 = 0.825 +- 0.160 (in-sample avg dev_std = 0.183)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.5
Model XAI F1 of binarized graphs for r=0.3 =  0.71258375
Model XAI WIoU of binarized graphs for r=0.3 =  0.5879375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
NEC for r=0.3 class 0 = 0.611 +- 0.266 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 1 = 0.515 +- 0.266 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 2 = 0.587 +- 0.266 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all KL = 0.543 +- 0.266 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all L1 = 0.57 +- 0.140 (in-sample avg dev_std = 0.415)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.68
Model XAI F1 of binarized graphs for r=0.6 =  0.60751
Model XAI WIoU of binarized graphs for r=0.6 =  0.49118375000000003
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.395
NEC for r=0.6 class 0 = 0.62 +- 0.271 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.536 +- 0.271 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.603 +- 0.271 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.614 +- 0.271 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.586 +- 0.159 (in-sample avg dev_std = 0.489)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  0.47401625
Model XAI WIoU of binarized graphs for r=0.9 =  0.35372499999999996
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.503
NEC for r=0.9 class 0 = 0.626 +- 0.237 (in-sample avg dev_std = 0.564)
NEC for r=0.9 class 1 = 0.491 +- 0.237 (in-sample avg dev_std = 0.564)
NEC for r=0.9 class 2 = 0.57 +- 0.237 (in-sample avg dev_std = 0.564)
NEC for r=0.9 all KL = 0.602 +- 0.237 (in-sample avg dev_std = 0.564)
NEC for r=0.9 all L1 = 0.561 +- 0.160 (in-sample avg dev_std = 0.564)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.329255
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.559
NEC for r=1.0 class 0 = 0.565 +- 0.245 (in-sample avg dev_std = 0.593)
NEC for r=1.0 class 1 = 0.422 +- 0.245 (in-sample avg dev_std = 0.593)
NEC for r=1.0 class 2 = 0.55 +- 0.245 (in-sample avg dev_std = 0.593)
NEC for r=1.0 all KL = 0.54 +- 0.245 (in-sample avg dev_std = 0.593)
NEC for r=1.0 all L1 = 0.512 +- 0.175 (in-sample avg dev_std = 0.593)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.439
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.78059125
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.209
NEC for r=0.3 class 0 = 0.676 +- 0.302 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 1 = 0.575 +- 0.302 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 2 = 0.552 +- 0.302 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all KL = 0.662 +- 0.302 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all L1 = 0.602 +- 0.204 (in-sample avg dev_std = 0.389)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.736
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.6969562499999999
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.437
NEC for r=0.6 class 0 = 0.501 +- 0.322 (in-sample avg dev_std = 0.499)
NEC for r=0.6 class 1 = 0.384 +- 0.322 (in-sample avg dev_std = 0.499)
NEC for r=0.6 class 2 = 0.38 +- 0.322 (in-sample avg dev_std = 0.499)
NEC for r=0.6 all KL = 0.448 +- 0.322 (in-sample avg dev_std = 0.499)
NEC for r=0.6 all L1 = 0.422 +- 0.248 (in-sample avg dev_std = 0.499)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.825
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.48420875
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.627
NEC for r=0.9 class 0 = 0.406 +- 0.211 (in-sample avg dev_std = 0.492)
NEC for r=0.9 class 1 = 0.194 +- 0.211 (in-sample avg dev_std = 0.492)
NEC for r=0.9 class 2 = 0.391 +- 0.211 (in-sample avg dev_std = 0.492)
NEC for r=0.9 all KL = 0.259 +- 0.211 (in-sample avg dev_std = 0.492)
NEC for r=0.9 all L1 = 0.331 +- 0.171 (in-sample avg dev_std = 0.492)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.8
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  0.44504875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.619
NEC for r=1.0 class 0 = 0.412 +- 0.199 (in-sample avg dev_std = 0.453)
NEC for r=1.0 class 1 = 0.163 +- 0.199 (in-sample avg dev_std = 0.453)
NEC for r=1.0 class 2 = 0.337 +- 0.199 (in-sample avg dev_std = 0.453)
NEC for r=1.0 all KL = 0.225 +- 0.199 (in-sample avg dev_std = 0.453)
NEC for r=1.0 all L1 = 0.305 +- 0.184 (in-sample avg dev_std = 0.453)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.28
Model XAI F1 of binarized graphs for r=0.3 =  0.36146124999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.26462250000000004
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.329
NEC for r=0.3 class 0 = 0.576 +- 0.236 (in-sample avg dev_std = 0.355)
NEC for r=0.3 class 1 = 0.529 +- 0.236 (in-sample avg dev_std = 0.355)
NEC for r=0.3 class 2 = 0.541 +- 0.236 (in-sample avg dev_std = 0.355)
NEC for r=0.3 all KL = 0.463 +- 0.236 (in-sample avg dev_std = 0.355)
NEC for r=0.3 all L1 = 0.549 +- 0.153 (in-sample avg dev_std = 0.355)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.636
Model XAI F1 of binarized graphs for r=0.6 =  0.62756625
Model XAI WIoU of binarized graphs for r=0.6 =  0.49079625
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.482
NEC for r=0.6 class 0 = 0.544 +- 0.291 (in-sample avg dev_std = 0.550)
NEC for r=0.6 class 1 = 0.343 +- 0.291 (in-sample avg dev_std = 0.550)
NEC for r=0.6 class 2 = 0.615 +- 0.291 (in-sample avg dev_std = 0.550)
NEC for r=0.6 all KL = 0.551 +- 0.291 (in-sample avg dev_std = 0.550)
NEC for r=0.6 all L1 = 0.504 +- 0.206 (in-sample avg dev_std = 0.550)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.663
Model XAI F1 of binarized graphs for r=0.9 =  0.5903499999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.43229999999999996
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.558
NEC for r=0.9 class 0 = 0.475 +- 0.239 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 1 = 0.199 +- 0.239 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 2 = 0.516 +- 0.239 (in-sample avg dev_std = 0.454)
NEC for r=0.9 all KL = 0.353 +- 0.239 (in-sample avg dev_std = 0.454)
NEC for r=0.9 all L1 = 0.4 +- 0.203 (in-sample avg dev_std = 0.454)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.586
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.4020425
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.407 +- 0.230 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 1 = 0.149 +- 0.230 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 2 = 0.49 +- 0.230 (in-sample avg dev_std = 0.425)
NEC for r=1.0 all KL = 0.3 +- 0.230 (in-sample avg dev_std = 0.425)
NEC for r=1.0 all L1 = 0.352 +- 0.208 (in-sample avg dev_std = 0.425)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:53:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:04 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:18 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:20 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:22 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:24 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:26 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:26 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 11:53:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:53:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.709
WIoU for r=0.3 = 0.582
F1 for r=0.6 = 0.609
WIoU for r=0.6 = 0.489
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.350
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.326
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.869
WIoU for r=0.3 = 0.781
F1 for r=0.6 = 0.798
WIoU for r=0.6 = 0.700
F1 for r=0.9 = 0.618
WIoU for r=0.9 = 0.486
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 0.447
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.409
WIoU for r=0.3 = 0.307
F1 for r=0.6 = 0.616
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.575
WIoU for r=0.9 = 0.419
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.400


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.534
Model XAI F1 of binarized graphs for r=0.3 =  0.7089462499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.58243875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.473
SUFF++ for r=0.3 class 0 = 0.433 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 1 = 0.519 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 2 = 0.529 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 all KL = 0.5 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 all L1 = 0.495 +- 0.143 (in-sample avg dev_std = 0.510)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.69
Model XAI F1 of binarized graphs for r=0.6 =  0.6085575
Model XAI WIoU of binarized graphs for r=0.6 =  0.48855000000000004
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.628
SUFF++ for r=0.6 class 0 = 0.461 +- 0.272 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 class 1 = 0.638 +- 0.272 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 class 2 = 0.625 +- 0.272 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all KL = 0.564 +- 0.272 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all L1 = 0.577 +- 0.195 (in-sample avg dev_std = 0.466)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.4740412500000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.350205
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.854
SUFF++ for r=0.9 class 0 = 0.678 +- 0.186 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 1 = 0.859 +- 0.186 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 2 = 0.856 +- 0.186 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all KL = 0.857 +- 0.186 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all L1 = 0.8 +- 0.163 (in-sample avg dev_std = 0.261)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.466
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.78103625
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.44
SUFF++ for r=0.3 class 0 = 0.479 +- 0.272 (in-sample avg dev_std = 0.626)
SUFF++ for r=0.3 class 1 = 0.611 +- 0.272 (in-sample avg dev_std = 0.626)
SUFF++ for r=0.3 class 2 = 0.554 +- 0.272 (in-sample avg dev_std = 0.626)
SUFF++ for r=0.3 all KL = 0.444 +- 0.272 (in-sample avg dev_std = 0.626)
SUFF++ for r=0.3 all L1 = 0.547 +- 0.167 (in-sample avg dev_std = 0.626)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.6999175
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.798
SUFF++ for r=0.6 class 0 = 0.658 +- 0.314 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 class 1 = 0.665 +- 0.314 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 class 2 = 0.817 +- 0.314 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 all KL = 0.69 +- 0.314 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 all L1 = 0.713 +- 0.214 (in-sample avg dev_std = 0.483)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.723
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.4864625
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.762
SUFF++ for r=0.9 class 0 = 0.743 +- 0.121 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 1 = 0.923 +- 0.121 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 2 = 0.851 +- 0.121 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all KL = 0.913 +- 0.121 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all L1 = 0.838 +- 0.153 (in-sample avg dev_std = 0.225)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.262
Model XAI F1 of binarized graphs for r=0.3 =  0.4089475
Model XAI WIoU of binarized graphs for r=0.3 =  0.30743499999999996
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.296
SUFF++ for r=0.3 class 0 = 0.491 +- 0.191 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.3 class 1 = 0.511 +- 0.191 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.3 class 2 = 0.512 +- 0.191 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.3 all KL = 0.604 +- 0.191 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.3 all L1 = 0.505 +- 0.106 (in-sample avg dev_std = 0.447)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.631
Model XAI F1 of binarized graphs for r=0.6 =  0.61630375
Model XAI WIoU of binarized graphs for r=0.6 =  0.48371500000000006
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.624
SUFF++ for r=0.6 class 0 = 0.628 +- 0.226 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 class 1 = 0.713 +- 0.226 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 class 2 = 0.742 +- 0.226 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 all KL = 0.732 +- 0.226 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 all L1 = 0.694 +- 0.184 (in-sample avg dev_std = 0.409)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.668
Model XAI F1 of binarized graphs for r=0.9 =  0.57488375
Model XAI WIoU of binarized graphs for r=0.9 =  0.418655
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.656
SUFF++ for r=0.9 class 0 = 0.729 +- 0.129 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.9 class 1 = 0.946 +- 0.129 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.9 class 2 = 0.746 +- 0.129 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.9 all KL = 0.893 +- 0.129 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.9 all L1 = 0.804 +- 0.161 (in-sample avg dev_std = 0.214)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.534
Model XAI F1 of binarized graphs for r=0.3 =  0.7089462499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.58243875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.373
NEC for r=0.3 class 0 = 0.622 +- 0.273 (in-sample avg dev_std = 0.426)
NEC for r=0.3 class 1 = 0.502 +- 0.273 (in-sample avg dev_std = 0.426)
NEC for r=0.3 class 2 = 0.591 +- 0.273 (in-sample avg dev_std = 0.426)
NEC for r=0.3 all KL = 0.558 +- 0.273 (in-sample avg dev_std = 0.426)
NEC for r=0.3 all L1 = 0.571 +- 0.155 (in-sample avg dev_std = 0.426)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.69
Model XAI F1 of binarized graphs for r=0.6 =  0.6085575
Model XAI WIoU of binarized graphs for r=0.6 =  0.48855000000000004
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.407
NEC for r=0.6 class 0 = 0.575 +- 0.277 (in-sample avg dev_std = 0.495)
NEC for r=0.6 class 1 = 0.492 +- 0.277 (in-sample avg dev_std = 0.495)
NEC for r=0.6 class 2 = 0.633 +- 0.277 (in-sample avg dev_std = 0.495)
NEC for r=0.6 all KL = 0.614 +- 0.277 (in-sample avg dev_std = 0.495)
NEC for r=0.6 all L1 = 0.567 +- 0.179 (in-sample avg dev_std = 0.495)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  0.4740412500000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.350205
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.498
NEC for r=0.9 class 0 = 0.641 +- 0.225 (in-sample avg dev_std = 0.583)
NEC for r=0.9 class 1 = 0.487 +- 0.225 (in-sample avg dev_std = 0.583)
NEC for r=0.9 class 2 = 0.553 +- 0.225 (in-sample avg dev_std = 0.583)
NEC for r=0.9 all KL = 0.613 +- 0.225 (in-sample avg dev_std = 0.583)
NEC for r=0.9 all L1 = 0.559 +- 0.154 (in-sample avg dev_std = 0.583)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.32575249999999994
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.546
NEC for r=1.0 class 0 = 0.584 +- 0.236 (in-sample avg dev_std = 0.621)
NEC for r=1.0 class 1 = 0.433 +- 0.236 (in-sample avg dev_std = 0.621)
NEC for r=1.0 class 2 = 0.592 +- 0.236 (in-sample avg dev_std = 0.621)
NEC for r=1.0 all KL = 0.589 +- 0.236 (in-sample avg dev_std = 0.621)
NEC for r=1.0 all L1 = 0.536 +- 0.173 (in-sample avg dev_std = 0.621)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.466
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.78103625
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.29
NEC for r=0.3 class 0 = 0.682 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=0.3 class 1 = 0.592 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=0.3 class 2 = 0.588 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=0.3 all KL = 0.696 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=0.3 all L1 = 0.621 +- 0.162 (in-sample avg dev_std = 0.438)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.6999175
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.466
NEC for r=0.6 class 0 = 0.492 +- 0.317 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.384 +- 0.317 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.324 +- 0.317 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.416 +- 0.317 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.4 +- 0.256 (in-sample avg dev_std = 0.489)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.723
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.4864625
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.577
NEC for r=0.9 class 0 = 0.366 +- 0.207 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 1 = 0.175 +- 0.207 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 2 = 0.369 +- 0.207 (in-sample avg dev_std = 0.441)
NEC for r=0.9 all KL = 0.229 +- 0.207 (in-sample avg dev_std = 0.441)
NEC for r=0.9 all L1 = 0.304 +- 0.180 (in-sample avg dev_std = 0.441)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.62
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  0.4470975
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.52
NEC for r=1.0 class 0 = 0.298 +- 0.186 (in-sample avg dev_std = 0.361)
NEC for r=1.0 class 1 = 0.116 +- 0.186 (in-sample avg dev_std = 0.361)
NEC for r=1.0 class 2 = 0.349 +- 0.186 (in-sample avg dev_std = 0.361)
NEC for r=1.0 all KL = 0.175 +- 0.186 (in-sample avg dev_std = 0.361)
NEC for r=1.0 all L1 = 0.255 +- 0.191 (in-sample avg dev_std = 0.361)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.264
Model XAI F1 of binarized graphs for r=0.3 =  0.4089475
Model XAI WIoU of binarized graphs for r=0.3 =  0.30743499999999996
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.254
NEC for r=0.3 class 0 = 0.578 +- 0.242 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 1 = 0.519 +- 0.242 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 2 = 0.518 +- 0.242 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all KL = 0.448 +- 0.242 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all L1 = 0.539 +- 0.159 (in-sample avg dev_std = 0.364)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.631
Model XAI F1 of binarized graphs for r=0.6 =  0.61630375
Model XAI WIoU of binarized graphs for r=0.6 =  0.48371500000000006
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.489
NEC for r=0.6 class 0 = 0.58 +- 0.274 (in-sample avg dev_std = 0.565)
NEC for r=0.6 class 1 = 0.439 +- 0.274 (in-sample avg dev_std = 0.565)
NEC for r=0.6 class 2 = 0.623 +- 0.274 (in-sample avg dev_std = 0.565)
NEC for r=0.6 all KL = 0.584 +- 0.274 (in-sample avg dev_std = 0.565)
NEC for r=0.6 all L1 = 0.55 +- 0.176 (in-sample avg dev_std = 0.565)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.668
Model XAI F1 of binarized graphs for r=0.9 =  0.57488375
Model XAI WIoU of binarized graphs for r=0.9 =  0.418655
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.561
NEC for r=0.9 class 0 = 0.473 +- 0.242 (in-sample avg dev_std = 0.464)
NEC for r=0.9 class 1 = 0.226 +- 0.242 (in-sample avg dev_std = 0.464)
NEC for r=0.9 class 2 = 0.517 +- 0.242 (in-sample avg dev_std = 0.464)
NEC for r=0.9 all KL = 0.386 +- 0.242 (in-sample avg dev_std = 0.464)
NEC for r=0.9 all L1 = 0.408 +- 0.197 (in-sample avg dev_std = 0.464)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.582
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.3998625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.384 +- 0.228 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 1 = 0.147 +- 0.228 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 2 = 0.492 +- 0.228 (in-sample avg dev_std = 0.416)
NEC for r=1.0 all KL = 0.3 +- 0.228 (in-sample avg dev_std = 0.416)
NEC for r=1.0 all L1 = 0.345 +- 0.207 (in-sample avg dev_std = 0.416)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:57:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:06 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:20 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:22 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:24 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:26 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:28 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:28 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 11:57:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.703
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.592
WIoU for r=0.6 = 0.475
F1 for r=0.9 = 0.466
WIoU for r=0.9 = 0.343
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.325
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.869
WIoU for r=0.3 = 0.780
F1 for r=0.6 = 0.798
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.618
WIoU for r=0.9 = 0.484
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 0.445
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.357
WIoU for r=0.3 = 0.258
F1 for r=0.6 = 0.596
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.587
WIoU for r=0.9 = 0.425
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.398


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.516
Model XAI F1 of binarized graphs for r=0.3 =  0.702765
Model XAI WIoU of binarized graphs for r=0.3 =  0.5784475
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.454
SUFF++ for r=0.3 class 0 = 0.438 +- 0.265 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 class 1 = 0.508 +- 0.265 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 class 2 = 0.551 +- 0.265 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 all KL = 0.514 +- 0.265 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 all L1 = 0.5 +- 0.153 (in-sample avg dev_std = 0.482)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.647
Model XAI F1 of binarized graphs for r=0.6 =  0.5916562499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.47481375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.641
SUFF++ for r=0.6 class 0 = 0.473 +- 0.290 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 class 1 = 0.679 +- 0.290 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 class 2 = 0.599 +- 0.290 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 all KL = 0.586 +- 0.290 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 all L1 = 0.585 +- 0.203 (in-sample avg dev_std = 0.460)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.918
Model XAI F1 of binarized graphs for r=0.9 =  0.46630874999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.34304625
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.861
SUFF++ for r=0.9 class 0 = 0.679 +- 0.169 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 class 1 = 0.865 +- 0.169 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 class 2 = 0.812 +- 0.169 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 all KL = 0.858 +- 0.169 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 all L1 = 0.787 +- 0.157 (in-sample avg dev_std = 0.259)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.419
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.7796799999999999
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.393
SUFF++ for r=0.3 class 0 = 0.513 +- 0.269 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 1 = 0.527 +- 0.269 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 2 = 0.57 +- 0.269 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 all KL = 0.488 +- 0.269 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 all L1 = 0.537 +- 0.149 (in-sample avg dev_std = 0.588)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.712
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.6985062500000001
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.767
SUFF++ for r=0.6 class 0 = 0.616 +- 0.349 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 1 = 0.693 +- 0.349 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 2 = 0.731 +- 0.349 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 all KL = 0.634 +- 0.349 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 all L1 = 0.68 +- 0.226 (in-sample avg dev_std = 0.544)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.48391999999999996
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.888
SUFF++ for r=0.9 class 0 = 0.831 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 1 = 0.928 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 2 = 0.896 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 all KL = 0.951 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 all L1 = 0.885 +- 0.117 (in-sample avg dev_std = 0.178)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.177
Model XAI F1 of binarized graphs for r=0.3 =  0.3568325
Model XAI WIoU of binarized graphs for r=0.3 =  0.25753875
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.287
SUFF++ for r=0.3 class 0 = 0.497 +- 0.187 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.3 class 1 = 0.529 +- 0.187 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.3 class 2 = 0.54 +- 0.187 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.3 all KL = 0.631 +- 0.187 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.3 all L1 = 0.522 +- 0.112 (in-sample avg dev_std = 0.431)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.579
Model XAI F1 of binarized graphs for r=0.6 =  0.59626875
Model XAI WIoU of binarized graphs for r=0.6 =  0.45321625
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.545
SUFF++ for r=0.6 class 0 = 0.533 +- 0.227 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 1 = 0.696 +- 0.227 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 2 = 0.626 +- 0.227 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all KL = 0.664 +- 0.227 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all L1 = 0.617 +- 0.196 (in-sample avg dev_std = 0.421)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.671
Model XAI F1 of binarized graphs for r=0.9 =  0.58662625
Model XAI WIoU of binarized graphs for r=0.9 =  0.42531874999999997
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.648
SUFF++ for r=0.9 class 0 = 0.671 +- 0.146 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.9 class 1 = 0.916 +- 0.146 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.9 class 2 = 0.697 +- 0.146 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.9 all KL = 0.861 +- 0.146 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.9 all L1 = 0.759 +- 0.179 (in-sample avg dev_std = 0.274)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.511
Model XAI F1 of binarized graphs for r=0.3 =  0.702765
Model XAI WIoU of binarized graphs for r=0.3 =  0.5784475
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
NEC for r=0.3 class 0 = 0.589 +- 0.277 (in-sample avg dev_std = 0.418)
NEC for r=0.3 class 1 = 0.549 +- 0.277 (in-sample avg dev_std = 0.418)
NEC for r=0.3 class 2 = 0.591 +- 0.277 (in-sample avg dev_std = 0.418)
NEC for r=0.3 all KL = 0.564 +- 0.277 (in-sample avg dev_std = 0.418)
NEC for r=0.3 all L1 = 0.576 +- 0.146 (in-sample avg dev_std = 0.418)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.647
Model XAI F1 of binarized graphs for r=0.6 =  0.5916562499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.47481375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.378
NEC for r=0.6 class 0 = 0.567 +- 0.283 (in-sample avg dev_std = 0.479)
NEC for r=0.6 class 1 = 0.521 +- 0.283 (in-sample avg dev_std = 0.479)
NEC for r=0.6 class 2 = 0.618 +- 0.283 (in-sample avg dev_std = 0.479)
NEC for r=0.6 all KL = 0.613 +- 0.283 (in-sample avg dev_std = 0.479)
NEC for r=0.6 all L1 = 0.569 +- 0.180 (in-sample avg dev_std = 0.479)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.919
Model XAI F1 of binarized graphs for r=0.9 =  0.46630874999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.34304625
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.605 +- 0.223 (in-sample avg dev_std = 0.600)
NEC for r=0.9 class 1 = 0.497 +- 0.223 (in-sample avg dev_std = 0.600)
NEC for r=0.9 class 2 = 0.558 +- 0.223 (in-sample avg dev_std = 0.600)
NEC for r=0.9 all KL = 0.614 +- 0.223 (in-sample avg dev_std = 0.600)
NEC for r=0.9 all L1 = 0.553 +- 0.164 (in-sample avg dev_std = 0.600)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.32451625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.535
NEC for r=1.0 class 0 = 0.572 +- 0.226 (in-sample avg dev_std = 0.633)
NEC for r=1.0 class 1 = 0.456 +- 0.226 (in-sample avg dev_std = 0.633)
NEC for r=1.0 class 2 = 0.578 +- 0.226 (in-sample avg dev_std = 0.633)
NEC for r=1.0 all KL = 0.6 +- 0.226 (in-sample avg dev_std = 0.633)
NEC for r=1.0 all L1 = 0.535 +- 0.171 (in-sample avg dev_std = 0.633)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.419
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.7796799999999999
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.312
NEC for r=0.3 class 0 = 0.641 +- 0.288 (in-sample avg dev_std = 0.437)
NEC for r=0.3 class 1 = 0.55 +- 0.288 (in-sample avg dev_std = 0.437)
NEC for r=0.3 class 2 = 0.619 +- 0.288 (in-sample avg dev_std = 0.437)
NEC for r=0.3 all KL = 0.62 +- 0.288 (in-sample avg dev_std = 0.437)
NEC for r=0.3 all L1 = 0.604 +- 0.160 (in-sample avg dev_std = 0.437)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.712
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.6985062500000001
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.446
NEC for r=0.6 class 0 = 0.481 +- 0.323 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 1 = 0.373 +- 0.323 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 2 = 0.351 +- 0.323 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all KL = 0.433 +- 0.323 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all L1 = 0.402 +- 0.257 (in-sample avg dev_std = 0.505)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.48391999999999996
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.663
NEC for r=0.9 class 0 = 0.395 +- 0.195 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 1 = 0.239 +- 0.195 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 2 = 0.362 +- 0.195 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all KL = 0.265 +- 0.195 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all L1 = 0.332 +- 0.168 (in-sample avg dev_std = 0.496)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.933
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  0.44457749999999996
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.695
NEC for r=1.0 class 0 = 0.394 +- 0.177 (in-sample avg dev_std = 0.486)
NEC for r=1.0 class 1 = 0.225 +- 0.177 (in-sample avg dev_std = 0.486)
NEC for r=1.0 class 2 = 0.36 +- 0.177 (in-sample avg dev_std = 0.486)
NEC for r=1.0 all KL = 0.246 +- 0.177 (in-sample avg dev_std = 0.486)
NEC for r=1.0 all L1 = 0.327 +- 0.164 (in-sample avg dev_std = 0.486)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.18
Model XAI F1 of binarized graphs for r=0.3 =  0.3568325
Model XAI WIoU of binarized graphs for r=0.3 =  0.25753875
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.299
NEC for r=0.3 class 0 = 0.562 +- 0.235 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 1 = 0.498 +- 0.235 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 2 = 0.526 +- 0.235 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all KL = 0.434 +- 0.235 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all L1 = 0.529 +- 0.157 (in-sample avg dev_std = 0.344)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.58
Model XAI F1 of binarized graphs for r=0.6 =  0.59626875
Model XAI WIoU of binarized graphs for r=0.6 =  0.45321625
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.48
NEC for r=0.6 class 0 = 0.571 +- 0.273 (in-sample avg dev_std = 0.514)
NEC for r=0.6 class 1 = 0.459 +- 0.273 (in-sample avg dev_std = 0.514)
NEC for r=0.6 class 2 = 0.631 +- 0.273 (in-sample avg dev_std = 0.514)
NEC for r=0.6 all KL = 0.556 +- 0.273 (in-sample avg dev_std = 0.514)
NEC for r=0.6 all L1 = 0.555 +- 0.170 (in-sample avg dev_std = 0.514)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.671
Model XAI F1 of binarized graphs for r=0.9 =  0.58662625
Model XAI WIoU of binarized graphs for r=0.9 =  0.42531874999999997
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.577
NEC for r=0.9 class 0 = 0.475 +- 0.218 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 1 = 0.271 +- 0.218 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 2 = 0.496 +- 0.218 (in-sample avg dev_std = 0.454)
NEC for r=0.9 all KL = 0.358 +- 0.218 (in-sample avg dev_std = 0.454)
NEC for r=0.9 all L1 = 0.417 +- 0.171 (in-sample avg dev_std = 0.454)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.521
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.39820125000000006
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.532
NEC for r=1.0 class 0 = 0.415 +- 0.219 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 1 = 0.176 +- 0.219 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 2 = 0.473 +- 0.219 (in-sample avg dev_std = 0.441)
NEC for r=1.0 all KL = 0.317 +- 0.219 (in-sample avg dev_std = 0.441)
NEC for r=1.0 all L1 = 0.358 +- 0.196 (in-sample avg dev_std = 0.441)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:01:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:20 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:22 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:24 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:26 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:26 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:01:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:01:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.657
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.571
WIoU for r=0.6 = 0.452
F1 for r=0.9 = 0.455
WIoU for r=0.9 = 0.333
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.324
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.869
WIoU for r=0.3 = 0.781
F1 for r=0.6 = 0.798
WIoU for r=0.6 = 0.709
F1 for r=0.9 = 0.618
WIoU for r=0.9 = 0.497
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 0.458
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.335
WIoU for r=0.3 = 0.243
F1 for r=0.6 = 0.584
WIoU for r=0.6 = 0.447
F1 for r=0.9 = 0.579
WIoU for r=0.9 = 0.419
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.398


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.546
Model XAI F1 of binarized graphs for r=0.3 =  0.6567374999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.53097875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.434
SUFF++ for r=0.3 class 0 = 0.452 +- 0.270 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 1 = 0.559 +- 0.270 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 2 = 0.605 +- 0.270 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 all KL = 0.553 +- 0.270 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 all L1 = 0.54 +- 0.171 (in-sample avg dev_std = 0.467)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.635
Model XAI F1 of binarized graphs for r=0.6 =  0.57065625
Model XAI WIoU of binarized graphs for r=0.6 =  0.4520375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.6
SUFF++ for r=0.6 class 0 = 0.423 +- 0.274 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 1 = 0.598 +- 0.274 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 2 = 0.604 +- 0.274 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 all KL = 0.515 +- 0.274 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 all L1 = 0.544 +- 0.200 (in-sample avg dev_std = 0.504)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.4546725
Model XAI WIoU of binarized graphs for r=0.9 =  0.33281
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.793
SUFF++ for r=0.9 class 0 = 0.557 +- 0.200 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 1 = 0.792 +- 0.200 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 2 = 0.858 +- 0.200 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 all KL = 0.801 +- 0.200 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 all L1 = 0.74 +- 0.197 (in-sample avg dev_std = 0.306)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.459
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.78127375
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.359
SUFF++ for r=0.3 class 0 = 0.48 +- 0.309 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 class 1 = 0.634 +- 0.309 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 class 2 = 0.557 +- 0.309 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 all KL = 0.517 +- 0.309 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 all L1 = 0.556 +- 0.176 (in-sample avg dev_std = 0.554)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.752
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.70853875
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.831
SUFF++ for r=0.6 class 0 = 0.646 +- 0.292 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 class 1 = 0.781 +- 0.292 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 class 2 = 0.907 +- 0.292 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 all KL = 0.779 +- 0.292 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 all L1 = 0.778 +- 0.225 (in-sample avg dev_std = 0.373)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.68
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.49698875000000003
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.757
SUFF++ for r=0.9 class 0 = 0.815 +- 0.102 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 1 = 0.962 +- 0.102 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 2 = 0.825 +- 0.102 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all KL = 0.937 +- 0.102 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all L1 = 0.867 +- 0.136 (in-sample avg dev_std = 0.229)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.373
Model XAI F1 of binarized graphs for r=0.3 =  0.33503
Model XAI WIoU of binarized graphs for r=0.3 =  0.24286000000000002
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.351
SUFF++ for r=0.3 class 0 = 0.592 +- 0.178 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 class 1 = 0.647 +- 0.178 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 class 2 = 0.623 +- 0.178 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 all KL = 0.728 +- 0.178 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 all L1 = 0.62 +- 0.127 (in-sample avg dev_std = 0.357)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.477
Model XAI F1 of binarized graphs for r=0.6 =  0.584365
Model XAI WIoU of binarized graphs for r=0.6 =  0.4468237499999999
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.504
SUFF++ for r=0.6 class 0 = 0.525 +- 0.240 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 1 = 0.642 +- 0.240 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 2 = 0.636 +- 0.240 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all KL = 0.623 +- 0.240 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all L1 = 0.6 +- 0.204 (in-sample avg dev_std = 0.465)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.65
Model XAI F1 of binarized graphs for r=0.9 =  0.5792587499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.41902750000000005
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.624
SUFF++ for r=0.9 class 0 = 0.655 +- 0.181 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 1 = 0.919 +- 0.181 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 2 = 0.691 +- 0.181 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 all KL = 0.831 +- 0.181 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 all L1 = 0.752 +- 0.197 (in-sample avg dev_std = 0.321)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.548
Model XAI F1 of binarized graphs for r=0.3 =  0.6567374999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.53097875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.37
NEC for r=0.3 class 0 = 0.604 +- 0.277 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 1 = 0.528 +- 0.277 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 2 = 0.522 +- 0.277 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all KL = 0.542 +- 0.277 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all L1 = 0.55 +- 0.154 (in-sample avg dev_std = 0.421)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.639
Model XAI F1 of binarized graphs for r=0.6 =  0.57065625
Model XAI WIoU of binarized graphs for r=0.6 =  0.4520375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.364
NEC for r=0.6 class 0 = 0.573 +- 0.282 (in-sample avg dev_std = 0.492)
NEC for r=0.6 class 1 = 0.55 +- 0.282 (in-sample avg dev_std = 0.492)
NEC for r=0.6 class 2 = 0.628 +- 0.282 (in-sample avg dev_std = 0.492)
NEC for r=0.6 all KL = 0.636 +- 0.282 (in-sample avg dev_std = 0.492)
NEC for r=0.6 all L1 = 0.584 +- 0.175 (in-sample avg dev_std = 0.492)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  0.4546725
Model XAI WIoU of binarized graphs for r=0.9 =  0.33281
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.487
NEC for r=0.9 class 0 = 0.584 +- 0.244 (in-sample avg dev_std = 0.581)
NEC for r=0.9 class 1 = 0.528 +- 0.244 (in-sample avg dev_std = 0.581)
NEC for r=0.9 class 2 = 0.573 +- 0.244 (in-sample avg dev_std = 0.581)
NEC for r=0.9 all KL = 0.619 +- 0.244 (in-sample avg dev_std = 0.581)
NEC for r=0.9 all L1 = 0.561 +- 0.154 (in-sample avg dev_std = 0.581)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.32355625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.524
NEC for r=1.0 class 0 = 0.566 +- 0.242 (in-sample avg dev_std = 0.626)
NEC for r=1.0 class 1 = 0.476 +- 0.242 (in-sample avg dev_std = 0.626)
NEC for r=1.0 class 2 = 0.577 +- 0.242 (in-sample avg dev_std = 0.626)
NEC for r=1.0 all KL = 0.596 +- 0.242 (in-sample avg dev_std = 0.626)
NEC for r=1.0 all L1 = 0.54 +- 0.170 (in-sample avg dev_std = 0.626)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.46
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.78127375
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.277
NEC for r=0.3 class 0 = 0.633 +- 0.313 (in-sample avg dev_std = 0.374)
NEC for r=0.3 class 1 = 0.496 +- 0.313 (in-sample avg dev_std = 0.374)
NEC for r=0.3 class 2 = 0.6 +- 0.313 (in-sample avg dev_std = 0.374)
NEC for r=0.3 all KL = 0.577 +- 0.313 (in-sample avg dev_std = 0.374)
NEC for r=0.3 all L1 = 0.577 +- 0.176 (in-sample avg dev_std = 0.374)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.752
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.70853875
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.466
NEC for r=0.6 class 0 = 0.525 +- 0.313 (in-sample avg dev_std = 0.549)
NEC for r=0.6 class 1 = 0.427 +- 0.313 (in-sample avg dev_std = 0.549)
NEC for r=0.6 class 2 = 0.402 +- 0.313 (in-sample avg dev_std = 0.549)
NEC for r=0.6 all KL = 0.487 +- 0.313 (in-sample avg dev_std = 0.549)
NEC for r=0.6 all L1 = 0.452 +- 0.221 (in-sample avg dev_std = 0.549)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.68
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.49698875000000003
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.551
NEC for r=0.9 class 0 = 0.38 +- 0.232 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 1 = 0.17 +- 0.232 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 2 = 0.376 +- 0.232 (in-sample avg dev_std = 0.457)
NEC for r=0.9 all KL = 0.257 +- 0.232 (in-sample avg dev_std = 0.457)
NEC for r=0.9 all L1 = 0.309 +- 0.193 (in-sample avg dev_std = 0.457)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.58
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  0.45765874999999995
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.506
NEC for r=1.0 class 0 = 0.32 +- 0.208 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 1 = 0.112 +- 0.208 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 2 = 0.314 +- 0.208 (in-sample avg dev_std = 0.367)
NEC for r=1.0 all KL = 0.19 +- 0.208 (in-sample avg dev_std = 0.367)
NEC for r=1.0 all L1 = 0.249 +- 0.200 (in-sample avg dev_std = 0.367)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.373
Model XAI F1 of binarized graphs for r=0.3 =  0.33503
Model XAI WIoU of binarized graphs for r=0.3 =  0.24286000000000002
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.326
NEC for r=0.3 class 0 = 0.51 +- 0.229 (in-sample avg dev_std = 0.331)
NEC for r=0.3 class 1 = 0.364 +- 0.229 (in-sample avg dev_std = 0.331)
NEC for r=0.3 class 2 = 0.443 +- 0.229 (in-sample avg dev_std = 0.331)
NEC for r=0.3 all KL = 0.344 +- 0.229 (in-sample avg dev_std = 0.331)
NEC for r=0.3 all L1 = 0.44 +- 0.170 (in-sample avg dev_std = 0.331)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.48
Model XAI F1 of binarized graphs for r=0.6 =  0.584365
Model XAI WIoU of binarized graphs for r=0.6 =  0.4468237499999999
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.483
NEC for r=0.6 class 0 = 0.6 +- 0.260 (in-sample avg dev_std = 0.550)
NEC for r=0.6 class 1 = 0.512 +- 0.260 (in-sample avg dev_std = 0.550)
NEC for r=0.6 class 2 = 0.624 +- 0.260 (in-sample avg dev_std = 0.550)
NEC for r=0.6 all KL = 0.613 +- 0.260 (in-sample avg dev_std = 0.550)
NEC for r=0.6 all L1 = 0.58 +- 0.155 (in-sample avg dev_std = 0.550)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.65
Model XAI F1 of binarized graphs for r=0.9 =  0.5792587499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.41902750000000005
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.535
NEC for r=0.9 class 0 = 0.498 +- 0.250 (in-sample avg dev_std = 0.514)
NEC for r=0.9 class 1 = 0.308 +- 0.250 (in-sample avg dev_std = 0.514)
NEC for r=0.9 class 2 = 0.536 +- 0.250 (in-sample avg dev_std = 0.514)
NEC for r=0.9 all KL = 0.436 +- 0.250 (in-sample avg dev_std = 0.514)
NEC for r=0.9 all L1 = 0.45 +- 0.175 (in-sample avg dev_std = 0.514)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.554
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.39755250000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.419 +- 0.221 (in-sample avg dev_std = 0.456)
NEC for r=1.0 class 1 = 0.201 +- 0.221 (in-sample avg dev_std = 0.456)
NEC for r=1.0 class 2 = 0.494 +- 0.221 (in-sample avg dev_std = 0.456)
NEC for r=1.0 all KL = 0.346 +- 0.221 (in-sample avg dev_std = 0.456)
NEC for r=1.0 all L1 = 0.375 +- 0.195 (in-sample avg dev_std = 0.456)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.475, 0.523, 0.844, 1.0], 'all_L1': [0.513, 0.546, 0.776, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.547, 0.618, 0.857, 1.0], 'all_L1': [0.517, 0.599, 0.79, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.5, 0.564, 0.857, 1.0], 'all_L1': [0.495, 0.577, 0.8, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.514, 0.586, 0.858, 1.0], 'all_L1': [0.5, 0.585, 0.787, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.553, 0.515, 0.801, 1.0], 'all_L1': [0.54, 0.544, 0.74, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.599, 0.643, 0.644, 0.622], 'all_L1': [0.561, 0.586, 0.572, 0.55]}), defaultdict(<class 'list'>, {'all_KL': [0.543, 0.614, 0.602, 0.54], 'all_L1': [0.57, 0.586, 0.561, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.558, 0.614, 0.613, 0.589], 'all_L1': [0.571, 0.567, 0.559, 0.536]}), defaultdict(<class 'list'>, {'all_KL': [0.564, 0.613, 0.614, 0.6], 'all_L1': [0.576, 0.569, 0.553, 0.535]}), defaultdict(<class 'list'>, {'all_KL': [0.542, 0.636, 0.619, 0.596], 'all_L1': [0.55, 0.584, 0.561, 0.54]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.494, 0.59, 0.937, 1.0], 'all_L1': [0.556, 0.652, 0.857, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.551, 0.787, 0.952, 1.0], 'all_L1': [0.611, 0.766, 0.882, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.444, 0.69, 0.913, 1.0], 'all_L1': [0.547, 0.713, 0.838, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.488, 0.634, 0.951, 1.0], 'all_L1': [0.537, 0.68, 0.885, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.517, 0.779, 0.937, 1.0], 'all_L1': [0.556, 0.778, 0.867, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.643, 0.386, 0.327, 0.331], 'all_L1': [0.591, 0.378, 0.382, 0.375]}), defaultdict(<class 'list'>, {'all_KL': [0.662, 0.448, 0.259, 0.225], 'all_L1': [0.602, 0.422, 0.331, 0.305]}), defaultdict(<class 'list'>, {'all_KL': [0.696, 0.416, 0.229, 0.175], 'all_L1': [0.621, 0.4, 0.304, 0.255]}), defaultdict(<class 'list'>, {'all_KL': [0.62, 0.433, 0.265, 0.246], 'all_L1': [0.604, 0.402, 0.332, 0.327]}), defaultdict(<class 'list'>, {'all_KL': [0.577, 0.487, 0.257, 0.19], 'all_L1': [0.577, 0.452, 0.309, 0.249]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.652, 0.517, 0.849, 1.0], 'all_L1': [0.638, 0.527, 0.761, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.619, 0.771, 0.92, 1.0], 'all_L1': [0.524, 0.743, 0.825, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.604, 0.732, 0.893, 1.0], 'all_L1': [0.505, 0.694, 0.804, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.631, 0.664, 0.861, 1.0], 'all_L1': [0.522, 0.617, 0.759, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.728, 0.623, 0.831, 1.0], 'all_L1': [0.62, 0.6, 0.752, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.413, 0.66, 0.481, 0.432], 'all_L1': [0.421, 0.616, 0.5, 0.44]}), defaultdict(<class 'list'>, {'all_KL': [0.463, 0.551, 0.353, 0.3], 'all_L1': [0.549, 0.504, 0.4, 0.352]}), defaultdict(<class 'list'>, {'all_KL': [0.448, 0.584, 0.386, 0.3], 'all_L1': [0.539, 0.55, 0.408, 0.345]}), defaultdict(<class 'list'>, {'all_KL': [0.434, 0.556, 0.358, 0.317], 'all_L1': [0.529, 0.555, 0.417, 0.358]}), defaultdict(<class 'list'>, {'all_KL': [0.344, 0.613, 0.436, 0.346], 'all_L1': [0.44, 0.58, 0.45, 0.375]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.513 +- 0.016, 0.570 +- 0.022, 0.779 +- 0.021, 1.000 +- 0.000
suff++ class all_KL  =  0.518 +- 0.029, 0.561 +- 0.039, 0.843 +- 0.022, 1.000 +- 0.000
suff++_acc_int  =  0.449 +- 0.017, 0.624 +- 0.015, 0.840 +- 0.024
nec class all_L1  =  0.566 +- 0.009, 0.578 +- 0.009, 0.561 +- 0.006, 0.535 +- 0.012
nec class all_KL  =  0.561 +- 0.021, 0.624 +- 0.013, 0.618 +- 0.014, 0.589 +- 0.027
nec_acc_int  =  0.352 +- 0.016, 0.387 +- 0.015, 0.499 +- 0.008, 0.536 +- 0.015

Eval split val
suff++ class all_L1  =  0.561 +- 0.026, 0.718 +- 0.048, 0.866 +- 0.017, 1.000 +- 0.000
suff++ class all_KL  =  0.499 +- 0.035, 0.696 +- 0.078, 0.938 +- 0.014, 1.000 +- 0.000
suff++_acc_int  =  0.396 +- 0.029, 0.787 +- 0.031, 0.829 +- 0.057
nec class all_L1  =  0.599 +- 0.015, 0.411 +- 0.025, 0.332 +- 0.028, 0.302 +- 0.047
nec class all_KL  =  0.640 +- 0.040, 0.434 +- 0.034, 0.267 +- 0.032, 0.233 +- 0.055
nec_acc_int  =  0.262 +- 0.040, 0.450 +- 0.014, 0.599 +- 0.040, 0.593 +- 0.070

Eval split test
suff++ class all_L1  =  0.562 +- 0.056, 0.636 +- 0.075, 0.780 +- 0.029, 1.000 +- 0.000
suff++ class all_KL  =  0.647 +- 0.044, 0.661 +- 0.089, 0.871 +- 0.032, 1.000 +- 0.000
suff++_acc_int  =  0.318 +- 0.027, 0.559 +- 0.049, 0.649 +- 0.017
nec class all_L1  =  0.496 +- 0.054, 0.561 +- 0.037, 0.435 +- 0.037, 0.374 +- 0.034
nec class all_KL  =  0.420 +- 0.042, 0.593 +- 0.040, 0.403 +- 0.049, 0.339 +- 0.049
nec_acc_int  =  0.309 +- 0.030, 0.476 +- 0.016, 0.553 +- 0.017, 0.540 +- 0.011


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.539 +- 0.004, 0.574 +- 0.010, 0.670 +- 0.010, 0.767 +- 0.006
Faith. Armon (L1)= 		  =  0.538 +- 0.005, 0.574 +- 0.010, 0.652 +- 0.008, 0.697 +- 0.011
Faith. GMean (L1)= 	  =  0.539 +- 0.005, 0.574 +- 0.010, 0.661 +- 0.009, 0.731 +- 0.009
Faith. Aritm (KL)= 		  =  0.540 +- 0.006, 0.593 +- 0.014, 0.731 +- 0.011, 0.795 +- 0.014
Faith. Armon (KL)= 		  =  0.538 +- 0.008, 0.590 +- 0.017, 0.713 +- 0.011, 0.741 +- 0.022
Faith. GMean (KL)= 	  =  0.539 +- 0.007, 0.591 +- 0.015, 0.722 +- 0.011, 0.768 +- 0.018

Eval split val
Faith. Aritm (L1)= 		  =  0.580 +- 0.014, 0.564 +- 0.036, 0.599 +- 0.017, 0.651 +- 0.023
Faith. Armon (L1)= 		  =  0.579 +- 0.015, 0.522 +- 0.032, 0.479 +- 0.029, 0.462 +- 0.055
Faith. GMean (L1)= 	  =  0.580 +- 0.014, 0.543 +- 0.034, 0.535 +- 0.023, 0.548 +- 0.042
Faith. Aritm (KL)= 		  =  0.569 +- 0.021, 0.565 +- 0.054, 0.603 +- 0.020, 0.617 +- 0.027
Faith. Armon (KL)= 		  =  0.559 +- 0.022, 0.534 +- 0.046, 0.415 +- 0.039, 0.375 +- 0.070
Faith. GMean (KL)= 	  =  0.564 +- 0.021, 0.549 +- 0.050, 0.500 +- 0.031, 0.480 +- 0.055

Eval split test
Faith. Aritm (L1)= 		  =  0.529 +- 0.005, 0.599 +- 0.021, 0.608 +- 0.014, 0.687 +- 0.017
Faith. Armon (L1)= 		  =  0.521 +- 0.010, 0.591 +- 0.015, 0.557 +- 0.025, 0.544 +- 0.035
Faith. GMean (L1)= 	  =  0.525 +- 0.006, 0.595 +- 0.018, 0.582 +- 0.019, 0.611 +- 0.027
Faith. Aritm (KL)= 		  =  0.534 +- 0.005, 0.627 +- 0.028, 0.637 +- 0.018, 0.669 +- 0.025
Faith. Armon (KL)= 		  =  0.506 +- 0.021, 0.619 +- 0.025, 0.548 +- 0.041, 0.504 +- 0.053
Faith. GMean (KL)= 	  =  0.520 +- 0.011, 0.623 +- 0.027, 0.591 +- 0.029, 0.581 +- 0.041
Computed for split load_split = id



Completed in  0:20:44.389741  for GSATGIN GOODMotif/basis



DONE GSAT GOODMotif/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:05:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/22/2024 12:05:43 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:05:43 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:05:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:05:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:05:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:05:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:05:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:05:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:05:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:05:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3252
ID Validation ACCURACY: 0.9357
ID Validation Loss: 0.3127
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3421
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.4181
OOD Test ACCURACY: 0.7947
OOD Test Loss: 0.8208

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 47...
[0m[1;37mINFO[0m: [1mCheckpoint 47: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.3388
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.3254
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3540
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.3738
OOD Test ACCURACY: 0.6353
OOD Test Loss: 1.7363

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.7947 0.9243 0.6353 0.9317 0.9300[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.690
WIoU for r=0.3 = 0.571
F1 for r=0.6 = 0.574
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.464
WIoU for r=0.9 = 0.339
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.328
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.481
WIoU for r=0.3 = 0.372
F1 for r=0.6 = 0.313
WIoU for r=0.6 = 0.211
F1 for r=0.9 = 0.252
WIoU for r=0.9 = 0.161
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.169
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.570
WIoU for r=0.3 = 0.454
F1 for r=0.6 = 0.495
WIoU for r=0.6 = 0.360
F1 for r=0.9 = 0.413
WIoU for r=0.9 = 0.282
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.264


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.438
Model XAI F1 of binarized graphs for r=0.3 =  0.6901037500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5714425
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.45
SUFF++ for r=0.3 class 0 = 0.5 +- 0.272 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.3 class 1 = 0.577 +- 0.272 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.3 class 2 = 0.515 +- 0.272 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.3 all KL = 0.549 +- 0.272 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.3 all L1 = 0.531 +- 0.158 (in-sample avg dev_std = 0.452)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.671
Model XAI F1 of binarized graphs for r=0.6 =  0.5735825
Model XAI WIoU of binarized graphs for r=0.6 =  0.45319249999999994
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.617
SUFF++ for r=0.6 class 0 = 0.439 +- 0.266 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 1 = 0.777 +- 0.266 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 2 = 0.644 +- 0.266 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 all KL = 0.638 +- 0.266 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 all L1 = 0.62 +- 0.217 (in-sample avg dev_std = 0.389)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.46355375000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.33887749999999994
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.823
SUFF++ for r=0.9 class 0 = 0.6 +- 0.188 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 1 = 0.859 +- 0.188 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 2 = 0.815 +- 0.188 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 all KL = 0.823 +- 0.188 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 all L1 = 0.758 +- 0.178 (in-sample avg dev_std = 0.322)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.57
Model XAI F1 of binarized graphs for r=0.3 =  0.48095625
Model XAI WIoU of binarized graphs for r=0.3 =  0.3720125
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.544
SUFF++ for r=0.3 class 0 = 0.582 +- 0.233 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 1 = 0.642 +- 0.233 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 2 = 0.554 +- 0.233 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 all KL = 0.681 +- 0.233 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 all L1 = 0.592 +- 0.157 (in-sample avg dev_std = 0.389)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.678
Model XAI F1 of binarized graphs for r=0.6 =  0.3126775
Model XAI WIoU of binarized graphs for r=0.6 =  0.21100875000000002
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.549
SUFF++ for r=0.6 class 0 = 0.458 +- 0.208 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.6 class 1 = 0.695 +- 0.208 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.6 class 2 = 0.564 +- 0.208 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.6 all KL = 0.697 +- 0.208 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.6 all L1 = 0.571 +- 0.159 (in-sample avg dev_std = 0.324)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.844
Model XAI F1 of binarized graphs for r=0.9 =  0.2524925
Model XAI WIoU of binarized graphs for r=0.9 =  0.1609675
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.732
SUFF++ for r=0.9 class 0 = 0.565 +- 0.170 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.9 class 1 = 0.732 +- 0.170 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.9 class 2 = 0.695 +- 0.170 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.9 all KL = 0.779 +- 0.170 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.9 all L1 = 0.663 +- 0.146 (in-sample avg dev_std = 0.310)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.359
Model XAI F1 of binarized graphs for r=0.3 =  0.56971625
Model XAI WIoU of binarized graphs for r=0.3 =  0.45398375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.466
SUFF++ for r=0.3 class 0 = 0.567 +- 0.235 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 class 1 = 0.639 +- 0.235 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 class 2 = 0.621 +- 0.235 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 all KL = 0.659 +- 0.235 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 all L1 = 0.61 +- 0.165 (in-sample avg dev_std = 0.376)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.766
Model XAI F1 of binarized graphs for r=0.6 =  0.4948887500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.35975250000000003
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.669
SUFF++ for r=0.6 class 0 = 0.47 +- 0.188 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 1 = 0.802 +- 0.188 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 2 = 0.673 +- 0.188 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 all KL = 0.727 +- 0.188 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 all L1 = 0.651 +- 0.192 (in-sample avg dev_std = 0.367)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.754
Model XAI F1 of binarized graphs for r=0.9 =  0.4132875
Model XAI WIoU of binarized graphs for r=0.9 =  0.281845
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.755
SUFF++ for r=0.9 class 0 = 0.594 +- 0.141 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 1 = 0.827 +- 0.141 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 2 = 0.838 +- 0.141 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all KL = 0.866 +- 0.141 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all L1 = 0.755 +- 0.174 (in-sample avg dev_std = 0.221)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.435
Model XAI F1 of binarized graphs for r=0.3 =  0.6901037500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5714425
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.312
NEC for r=0.3 class 0 = 0.582 +- 0.307 (in-sample avg dev_std = 0.374)
NEC for r=0.3 class 1 = 0.462 +- 0.307 (in-sample avg dev_std = 0.374)
NEC for r=0.3 class 2 = 0.628 +- 0.307 (in-sample avg dev_std = 0.374)
NEC for r=0.3 all KL = 0.553 +- 0.307 (in-sample avg dev_std = 0.374)
NEC for r=0.3 all L1 = 0.557 +- 0.193 (in-sample avg dev_std = 0.374)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.669
Model XAI F1 of binarized graphs for r=0.6 =  0.5735825
Model XAI WIoU of binarized graphs for r=0.6 =  0.45319249999999994
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.405
NEC for r=0.6 class 0 = 0.582 +- 0.264 (in-sample avg dev_std = 0.455)
NEC for r=0.6 class 1 = 0.471 +- 0.264 (in-sample avg dev_std = 0.455)
NEC for r=0.6 class 2 = 0.656 +- 0.264 (in-sample avg dev_std = 0.455)
NEC for r=0.6 all KL = 0.617 +- 0.264 (in-sample avg dev_std = 0.455)
NEC for r=0.6 all L1 = 0.569 +- 0.172 (in-sample avg dev_std = 0.455)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.915
Model XAI F1 of binarized graphs for r=0.9 =  0.46355375000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.33887749999999994
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.515
NEC for r=0.9 class 0 = 0.612 +- 0.227 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 1 = 0.46 +- 0.227 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 2 = 0.584 +- 0.227 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all KL = 0.581 +- 0.227 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all L1 = 0.552 +- 0.157 (in-sample avg dev_std = 0.571)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.942
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.32798125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.549
NEC for r=1.0 class 0 = 0.563 +- 0.231 (in-sample avg dev_std = 0.616)
NEC for r=1.0 class 1 = 0.428 +- 0.231 (in-sample avg dev_std = 0.616)
NEC for r=1.0 class 2 = 0.566 +- 0.231 (in-sample avg dev_std = 0.616)
NEC for r=1.0 all KL = 0.553 +- 0.231 (in-sample avg dev_std = 0.616)
NEC for r=1.0 all L1 = 0.519 +- 0.168 (in-sample avg dev_std = 0.616)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.574
Model XAI F1 of binarized graphs for r=0.3 =  0.48095625
Model XAI WIoU of binarized graphs for r=0.3 =  0.3720125
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.44 +- 0.274 (in-sample avg dev_std = 0.340)
NEC for r=0.3 class 1 = 0.479 +- 0.274 (in-sample avg dev_std = 0.340)
NEC for r=0.3 class 2 = 0.674 +- 0.274 (in-sample avg dev_std = 0.340)
NEC for r=0.3 all KL = 0.456 +- 0.274 (in-sample avg dev_std = 0.340)
NEC for r=0.3 all L1 = 0.532 +- 0.162 (in-sample avg dev_std = 0.340)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.3126775
Model XAI WIoU of binarized graphs for r=0.6 =  0.21100875000000002
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.431
NEC for r=0.6 class 0 = 0.562 +- 0.217 (in-sample avg dev_std = 0.402)
NEC for r=0.6 class 1 = 0.424 +- 0.217 (in-sample avg dev_std = 0.402)
NEC for r=0.6 class 2 = 0.561 +- 0.217 (in-sample avg dev_std = 0.402)
NEC for r=0.6 all KL = 0.416 +- 0.217 (in-sample avg dev_std = 0.402)
NEC for r=0.6 all L1 = 0.516 +- 0.135 (in-sample avg dev_std = 0.402)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.839
Model XAI F1 of binarized graphs for r=0.9 =  0.2524925
Model XAI WIoU of binarized graphs for r=0.9 =  0.1609675
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.529
NEC for r=0.9 class 0 = 0.544 +- 0.183 (in-sample avg dev_std = 0.482)
NEC for r=0.9 class 1 = 0.491 +- 0.183 (in-sample avg dev_std = 0.482)
NEC for r=0.9 class 2 = 0.484 +- 0.183 (in-sample avg dev_std = 0.482)
NEC for r=0.9 all KL = 0.451 +- 0.183 (in-sample avg dev_std = 0.482)
NEC for r=0.9 all L1 = 0.506 +- 0.111 (in-sample avg dev_std = 0.482)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.16925374999999998
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.573
NEC for r=1.0 class 0 = 0.483 +- 0.208 (in-sample avg dev_std = 0.542)
NEC for r=1.0 class 1 = 0.459 +- 0.208 (in-sample avg dev_std = 0.542)
NEC for r=1.0 class 2 = 0.522 +- 0.208 (in-sample avg dev_std = 0.542)
NEC for r=1.0 all KL = 0.478 +- 0.208 (in-sample avg dev_std = 0.542)
NEC for r=1.0 all L1 = 0.488 +- 0.121 (in-sample avg dev_std = 0.542)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.359
Model XAI F1 of binarized graphs for r=0.3 =  0.56971625
Model XAI WIoU of binarized graphs for r=0.3 =  0.45398375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.403
NEC for r=0.3 class 0 = 0.468 +- 0.259 (in-sample avg dev_std = 0.391)
NEC for r=0.3 class 1 = 0.541 +- 0.259 (in-sample avg dev_std = 0.391)
NEC for r=0.3 class 2 = 0.575 +- 0.259 (in-sample avg dev_std = 0.391)
NEC for r=0.3 all KL = 0.51 +- 0.259 (in-sample avg dev_std = 0.391)
NEC for r=0.3 all L1 = 0.529 +- 0.160 (in-sample avg dev_std = 0.391)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.767
Model XAI F1 of binarized graphs for r=0.6 =  0.4948887500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.35975250000000003
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.444
NEC for r=0.6 class 0 = 0.611 +- 0.251 (in-sample avg dev_std = 0.544)
NEC for r=0.6 class 1 = 0.417 +- 0.251 (in-sample avg dev_std = 0.544)
NEC for r=0.6 class 2 = 0.621 +- 0.251 (in-sample avg dev_std = 0.544)
NEC for r=0.6 all KL = 0.564 +- 0.251 (in-sample avg dev_std = 0.544)
NEC for r=0.6 all L1 = 0.548 +- 0.181 (in-sample avg dev_std = 0.544)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.754
Model XAI F1 of binarized graphs for r=0.9 =  0.4132875
Model XAI WIoU of binarized graphs for r=0.9 =  0.281845
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.572
NEC for r=0.9 class 0 = 0.533 +- 0.247 (in-sample avg dev_std = 0.500)
NEC for r=0.9 class 1 = 0.357 +- 0.247 (in-sample avg dev_std = 0.500)
NEC for r=0.9 class 2 = 0.453 +- 0.247 (in-sample avg dev_std = 0.500)
NEC for r=0.9 all KL = 0.407 +- 0.247 (in-sample avg dev_std = 0.500)
NEC for r=0.9 all L1 = 0.446 +- 0.183 (in-sample avg dev_std = 0.500)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.809
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26427125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.608
NEC for r=1.0 class 0 = 0.457 +- 0.259 (in-sample avg dev_std = 0.473)
NEC for r=1.0 class 1 = 0.331 +- 0.259 (in-sample avg dev_std = 0.473)
NEC for r=1.0 class 2 = 0.407 +- 0.259 (in-sample avg dev_std = 0.473)
NEC for r=1.0 all KL = 0.369 +- 0.259 (in-sample avg dev_std = 0.473)
NEC for r=1.0 all L1 = 0.397 +- 0.174 (in-sample avg dev_std = 0.473)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:10:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/22/2024 12:10:43 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:10:43 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:10:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:10:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:10:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:10:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:10:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:10:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:10:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:10:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9303
Train Loss: 0.3173
ID Validation ACCURACY: 0.9357
ID Validation Loss: 0.3076
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3411
OOD Validation ACCURACY: 0.8477
OOD Validation Loss: 0.4798
OOD Test ACCURACY: 0.6430
OOD Test Loss: 0.9596

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ACCURACY: 0.9249
Train Loss: 0.3435
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3292
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3609
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3859
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.8691

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6430 0.9200 0.5833 0.9297 0.9273[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.733
WIoU for r=0.3 = 0.617
F1 for r=0.6 = 0.605
WIoU for r=0.6 = 0.483
F1 for r=0.9 = 0.479
WIoU for r=0.9 = 0.356
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.332
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.553
WIoU for r=0.3 = 0.427
F1 for r=0.6 = 0.362
WIoU for r=0.6 = 0.244
F1 for r=0.9 = 0.277
WIoU for r=0.9 = 0.178
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.172
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.676
WIoU for r=0.3 = 0.547
F1 for r=0.6 = 0.508
WIoU for r=0.6 = 0.374
F1 for r=0.9 = 0.413
WIoU for r=0.9 = 0.285
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.268


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.494
Model XAI F1 of binarized graphs for r=0.3 =  0.7330737500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6167475
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.449
SUFF++ for r=0.3 class 0 = 0.453 +- 0.280 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 1 = 0.478 +- 0.280 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 2 = 0.537 +- 0.280 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 all KL = 0.5 +- 0.280 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 all L1 = 0.489 +- 0.167 (in-sample avg dev_std = 0.479)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.6049450000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.48334250000000006
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.675
SUFF++ for r=0.6 class 0 = 0.461 +- 0.254 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 1 = 0.71 +- 0.254 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 2 = 0.686 +- 0.254 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 all KL = 0.628 +- 0.254 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 all L1 = 0.619 +- 0.193 (in-sample avg dev_std = 0.434)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.47906499999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.3562675
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.853
SUFF++ for r=0.9 class 0 = 0.704 +- 0.186 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 1 = 0.83 +- 0.186 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 2 = 0.829 +- 0.186 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 all KL = 0.851 +- 0.186 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 all L1 = 0.788 +- 0.182 (in-sample avg dev_std = 0.273)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.788
Model XAI F1 of binarized graphs for r=0.3 =  0.55335375
Model XAI WIoU of binarized graphs for r=0.3 =  0.4268925
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.606
SUFF++ for r=0.3 class 0 = 0.44 +- 0.284 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 class 1 = 0.621 +- 0.284 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 class 2 = 0.637 +- 0.284 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 all KL = 0.58 +- 0.284 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 all L1 = 0.565 +- 0.190 (in-sample avg dev_std = 0.453)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.777
Model XAI F1 of binarized graphs for r=0.6 =  0.36238249999999994
Model XAI WIoU of binarized graphs for r=0.6 =  0.24410375
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.65
SUFF++ for r=0.6 class 0 = 0.44 +- 0.226 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 class 1 = 0.657 +- 0.226 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 class 2 = 0.592 +- 0.226 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 all KL = 0.647 +- 0.226 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 all L1 = 0.562 +- 0.162 (in-sample avg dev_std = 0.348)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.754
Model XAI F1 of binarized graphs for r=0.9 =  0.2766025
Model XAI WIoU of binarized graphs for r=0.9 =  0.17758000000000002
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.686
SUFF++ for r=0.9 class 0 = 0.54 +- 0.170 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.9 class 1 = 0.625 +- 0.170 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.9 class 2 = 0.734 +- 0.170 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.9 all KL = 0.752 +- 0.170 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.9 all L1 = 0.633 +- 0.152 (in-sample avg dev_std = 0.317)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.694
Model XAI F1 of binarized graphs for r=0.3 =  0.6756125000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5474874999999999
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.525
SUFF++ for r=0.3 class 0 = 0.477 +- 0.296 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 class 1 = 0.621 +- 0.296 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 class 2 = 0.597 +- 0.296 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 all KL = 0.554 +- 0.296 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 all L1 = 0.566 +- 0.190 (in-sample avg dev_std = 0.511)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.75
Model XAI F1 of binarized graphs for r=0.6 =  0.50813
Model XAI WIoU of binarized graphs for r=0.6 =  0.374095
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.69
SUFF++ for r=0.6 class 0 = 0.464 +- 0.230 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.6 class 1 = 0.73 +- 0.230 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.6 class 2 = 0.713 +- 0.230 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.6 all KL = 0.663 +- 0.230 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.6 all L1 = 0.638 +- 0.179 (in-sample avg dev_std = 0.420)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.754
Model XAI F1 of binarized graphs for r=0.9 =  0.413335
Model XAI WIoU of binarized graphs for r=0.9 =  0.2854925
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.706
SUFF++ for r=0.9 class 0 = 0.596 +- 0.229 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 1 = 0.737 +- 0.229 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 2 = 0.908 +- 0.229 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 all KL = 0.805 +- 0.229 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 all L1 = 0.748 +- 0.195 (in-sample avg dev_std = 0.347)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.494
Model XAI F1 of binarized graphs for r=0.3 =  0.7330737500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6167475
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.308
NEC for r=0.3 class 0 = 0.647 +- 0.268 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 1 = 0.589 +- 0.268 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 2 = 0.636 +- 0.268 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all KL = 0.63 +- 0.268 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all L1 = 0.624 +- 0.149 (in-sample avg dev_std = 0.411)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.77
Model XAI F1 of binarized graphs for r=0.6 =  0.6049450000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.48334250000000006
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.376
NEC for r=0.6 class 0 = 0.61 +- 0.289 (in-sample avg dev_std = 0.479)
NEC for r=0.6 class 1 = 0.465 +- 0.289 (in-sample avg dev_std = 0.479)
NEC for r=0.6 class 2 = 0.653 +- 0.289 (in-sample avg dev_std = 0.479)
NEC for r=0.6 all KL = 0.609 +- 0.289 (in-sample avg dev_std = 0.479)
NEC for r=0.6 all L1 = 0.576 +- 0.194 (in-sample avg dev_std = 0.479)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.47906499999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.3562675
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.535
NEC for r=0.9 class 0 = 0.592 +- 0.242 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 1 = 0.472 +- 0.242 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 2 = 0.549 +- 0.242 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all KL = 0.566 +- 0.242 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all L1 = 0.538 +- 0.159 (in-sample avg dev_std = 0.568)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.942
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.3318175
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.538
NEC for r=1.0 class 0 = 0.551 +- 0.236 (in-sample avg dev_std = 0.609)
NEC for r=1.0 class 1 = 0.448 +- 0.236 (in-sample avg dev_std = 0.609)
NEC for r=1.0 class 2 = 0.555 +- 0.236 (in-sample avg dev_std = 0.609)
NEC for r=1.0 all KL = 0.553 +- 0.236 (in-sample avg dev_std = 0.609)
NEC for r=1.0 all L1 = 0.518 +- 0.164 (in-sample avg dev_std = 0.609)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.79
Model XAI F1 of binarized graphs for r=0.3 =  0.55335375
Model XAI WIoU of binarized graphs for r=0.3 =  0.4268925
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.32
NEC for r=0.3 class 0 = 0.604 +- 0.282 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 1 = 0.544 +- 0.282 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 2 = 0.722 +- 0.282 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all KL = 0.636 +- 0.282 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all L1 = 0.625 +- 0.147 (in-sample avg dev_std = 0.428)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.775
Model XAI F1 of binarized graphs for r=0.6 =  0.36238249999999994
Model XAI WIoU of binarized graphs for r=0.6 =  0.24410375
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.438
NEC for r=0.6 class 0 = 0.611 +- 0.235 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 1 = 0.474 +- 0.235 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 2 = 0.604 +- 0.235 (in-sample avg dev_std = 0.460)
NEC for r=0.6 all KL = 0.521 +- 0.235 (in-sample avg dev_std = 0.460)
NEC for r=0.6 all L1 = 0.564 +- 0.128 (in-sample avg dev_std = 0.460)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.756
Model XAI F1 of binarized graphs for r=0.9 =  0.2766025
Model XAI WIoU of binarized graphs for r=0.9 =  0.17758000000000002
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.492
NEC for r=0.9 class 0 = 0.546 +- 0.189 (in-sample avg dev_std = 0.473)
NEC for r=0.9 class 1 = 0.552 +- 0.189 (in-sample avg dev_std = 0.473)
NEC for r=0.9 class 2 = 0.439 +- 0.189 (in-sample avg dev_std = 0.473)
NEC for r=0.9 all KL = 0.452 +- 0.189 (in-sample avg dev_std = 0.473)
NEC for r=0.9 all L1 = 0.512 +- 0.122 (in-sample avg dev_std = 0.473)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.85
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.1719625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.567
NEC for r=1.0 class 0 = 0.504 +- 0.207 (in-sample avg dev_std = 0.532)
NEC for r=1.0 class 1 = 0.475 +- 0.207 (in-sample avg dev_std = 0.532)
NEC for r=1.0 class 2 = 0.503 +- 0.207 (in-sample avg dev_std = 0.532)
NEC for r=1.0 all KL = 0.471 +- 0.207 (in-sample avg dev_std = 0.532)
NEC for r=1.0 all L1 = 0.494 +- 0.110 (in-sample avg dev_std = 0.532)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.694
Model XAI F1 of binarized graphs for r=0.3 =  0.6756125000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5474874999999999
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.445
NEC for r=0.3 class 0 = 0.578 +- 0.247 (in-sample avg dev_std = 0.491)
NEC for r=0.3 class 1 = 0.599 +- 0.247 (in-sample avg dev_std = 0.491)
NEC for r=0.3 class 2 = 0.635 +- 0.247 (in-sample avg dev_std = 0.491)
NEC for r=0.3 all KL = 0.652 +- 0.247 (in-sample avg dev_std = 0.491)
NEC for r=0.3 all L1 = 0.604 +- 0.137 (in-sample avg dev_std = 0.491)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.751
Model XAI F1 of binarized graphs for r=0.6 =  0.50813
Model XAI WIoU of binarized graphs for r=0.6 =  0.374095
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.432
NEC for r=0.6 class 0 = 0.606 +- 0.250 (in-sample avg dev_std = 0.573)
NEC for r=0.6 class 1 = 0.548 +- 0.250 (in-sample avg dev_std = 0.573)
NEC for r=0.6 class 2 = 0.617 +- 0.250 (in-sample avg dev_std = 0.573)
NEC for r=0.6 all KL = 0.642 +- 0.250 (in-sample avg dev_std = 0.573)
NEC for r=0.6 all L1 = 0.59 +- 0.138 (in-sample avg dev_std = 0.573)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.754
Model XAI F1 of binarized graphs for r=0.9 =  0.413335
Model XAI WIoU of binarized graphs for r=0.9 =  0.2854925
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.578
NEC for r=0.9 class 0 = 0.552 +- 0.291 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 1 = 0.437 +- 0.291 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 2 = 0.43 +- 0.291 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all KL = 0.546 +- 0.291 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all L1 = 0.472 +- 0.162 (in-sample avg dev_std = 0.566)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.656
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26764499999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.575
NEC for r=1.0 class 0 = 0.454 +- 0.235 (in-sample avg dev_std = 0.455)
NEC for r=1.0 class 1 = 0.407 +- 0.235 (in-sample avg dev_std = 0.455)
NEC for r=1.0 class 2 = 0.327 +- 0.235 (in-sample avg dev_std = 0.455)
NEC for r=1.0 all KL = 0.378 +- 0.235 (in-sample avg dev_std = 0.455)
NEC for r=1.0 all L1 = 0.396 +- 0.150 (in-sample avg dev_std = 0.455)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:15:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:21 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:21 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:15:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3303
ID Validation ACCURACY: 0.9350
ID Validation Loss: 0.3133
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3501
OOD Validation ACCURACY: 0.8013
OOD Validation Loss: 0.5544
OOD Test ACCURACY: 0.7917
OOD Test Loss: 0.8351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9260
Train Loss: 0.3556
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.3333
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3700
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.4586
OOD Test ACCURACY: 0.6470
OOD Test Loss: 1.3751

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.7917 0.9233 0.6470 0.9317 0.9260[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.674
WIoU for r=0.3 = 0.553
F1 for r=0.6 = 0.558
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.469
WIoU for r=0.9 = 0.342
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.325
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.426
WIoU for r=0.3 = 0.329
F1 for r=0.6 = 0.284
WIoU for r=0.6 = 0.187
F1 for r=0.9 = 0.247
WIoU for r=0.9 = 0.151
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.163
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.636
WIoU for r=0.3 = 0.515
F1 for r=0.6 = 0.490
WIoU for r=0.6 = 0.355
F1 for r=0.9 = 0.411
WIoU for r=0.9 = 0.279
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.263


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.464
Model XAI F1 of binarized graphs for r=0.3 =  0.6743412499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.55327125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.44
SUFF++ for r=0.3 class 0 = 0.423 +- 0.251 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 1 = 0.504 +- 0.251 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 2 = 0.489 +- 0.251 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all KL = 0.464 +- 0.251 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all L1 = 0.472 +- 0.167 (in-sample avg dev_std = 0.488)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.664
Model XAI F1 of binarized graphs for r=0.6 =  0.5575725
Model XAI WIoU of binarized graphs for r=0.6 =  0.4339775
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.621
SUFF++ for r=0.6 class 0 = 0.454 +- 0.253 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 1 = 0.674 +- 0.253 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 2 = 0.678 +- 0.253 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all KL = 0.603 +- 0.253 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all L1 = 0.602 +- 0.184 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.4692375
Model XAI WIoU of binarized graphs for r=0.9 =  0.34176125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.846
SUFF++ for r=0.9 class 0 = 0.658 +- 0.192 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 1 = 0.853 +- 0.192 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 2 = 0.818 +- 0.192 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 all KL = 0.834 +- 0.192 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 all L1 = 0.776 +- 0.175 (in-sample avg dev_std = 0.303)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.42621375
Model XAI WIoU of binarized graphs for r=0.3 =  0.3291075
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.571
SUFF++ for r=0.3 class 0 = 0.45 +- 0.253 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.3 class 1 = 0.618 +- 0.253 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.3 class 2 = 0.598 +- 0.253 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.3 all KL = 0.599 +- 0.253 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.3 all L1 = 0.555 +- 0.177 (in-sample avg dev_std = 0.422)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.716
Model XAI F1 of binarized graphs for r=0.6 =  0.28413124999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.1874425
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.586
SUFF++ for r=0.6 class 0 = 0.398 +- 0.249 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 1 = 0.646 +- 0.249 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 2 = 0.569 +- 0.249 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 all KL = 0.628 +- 0.249 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 all L1 = 0.537 +- 0.180 (in-sample avg dev_std = 0.346)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.634
Model XAI F1 of binarized graphs for r=0.9 =  0.24661249999999998
Model XAI WIoU of binarized graphs for r=0.9 =  0.15134125
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.632
SUFF++ for r=0.9 class 0 = 0.537 +- 0.192 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 1 = 0.671 +- 0.192 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 2 = 0.656 +- 0.192 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 all KL = 0.733 +- 0.192 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 all L1 = 0.621 +- 0.156 (in-sample avg dev_std = 0.340)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.688
Model XAI F1 of binarized graphs for r=0.3 =  0.63566625
Model XAI WIoU of binarized graphs for r=0.3 =  0.515265
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.519
SUFF++ for r=0.3 class 0 = 0.512 +- 0.278 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.3 class 1 = 0.625 +- 0.278 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.3 class 2 = 0.566 +- 0.278 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.3 all KL = 0.582 +- 0.278 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.3 all L1 = 0.569 +- 0.190 (in-sample avg dev_std = 0.472)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.48989374999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.35478499999999996
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.627
SUFF++ for r=0.6 class 0 = 0.474 +- 0.203 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.6 class 1 = 0.699 +- 0.203 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.6 class 2 = 0.712 +- 0.203 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.6 all KL = 0.716 +- 0.203 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.6 all L1 = 0.631 +- 0.177 (in-sample avg dev_std = 0.345)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.738
Model XAI F1 of binarized graphs for r=0.9 =  0.41095375000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.2793825
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.688
SUFF++ for r=0.9 class 0 = 0.685 +- 0.173 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 1 = 0.754 +- 0.173 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 2 = 0.829 +- 0.173 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all KL = 0.836 +- 0.173 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all L1 = 0.757 +- 0.176 (in-sample avg dev_std = 0.278)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.463
Model XAI F1 of binarized graphs for r=0.3 =  0.6743412499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.55327125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.318
NEC for r=0.3 class 0 = 0.628 +- 0.242 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 1 = 0.544 +- 0.242 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 2 = 0.677 +- 0.242 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all KL = 0.639 +- 0.242 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all L1 = 0.616 +- 0.150 (in-sample avg dev_std = 0.452)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.663
Model XAI F1 of binarized graphs for r=0.6 =  0.5575725
Model XAI WIoU of binarized graphs for r=0.6 =  0.4339775
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.396
NEC for r=0.6 class 0 = 0.593 +- 0.273 (in-sample avg dev_std = 0.473)
NEC for r=0.6 class 1 = 0.462 +- 0.273 (in-sample avg dev_std = 0.473)
NEC for r=0.6 class 2 = 0.648 +- 0.273 (in-sample avg dev_std = 0.473)
NEC for r=0.6 all KL = 0.607 +- 0.273 (in-sample avg dev_std = 0.473)
NEC for r=0.6 all L1 = 0.567 +- 0.181 (in-sample avg dev_std = 0.473)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.4692375
Model XAI WIoU of binarized graphs for r=0.9 =  0.34176125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.505
NEC for r=0.9 class 0 = 0.635 +- 0.226 (in-sample avg dev_std = 0.589)
NEC for r=0.9 class 1 = 0.465 +- 0.226 (in-sample avg dev_std = 0.589)
NEC for r=0.9 class 2 = 0.574 +- 0.226 (in-sample avg dev_std = 0.589)
NEC for r=0.9 all KL = 0.622 +- 0.226 (in-sample avg dev_std = 0.589)
NEC for r=0.9 all L1 = 0.558 +- 0.160 (in-sample avg dev_std = 0.589)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.942
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.32542875000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.563
NEC for r=1.0 class 0 = 0.576 +- 0.240 (in-sample avg dev_std = 0.617)
NEC for r=1.0 class 1 = 0.399 +- 0.240 (in-sample avg dev_std = 0.617)
NEC for r=1.0 class 2 = 0.568 +- 0.240 (in-sample avg dev_std = 0.617)
NEC for r=1.0 all KL = 0.572 +- 0.240 (in-sample avg dev_std = 0.617)
NEC for r=1.0 all L1 = 0.514 +- 0.176 (in-sample avg dev_std = 0.617)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.42621375
Model XAI WIoU of binarized graphs for r=0.3 =  0.3291075
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.34
NEC for r=0.3 class 0 = 0.566 +- 0.260 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 1 = 0.509 +- 0.260 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 2 = 0.665 +- 0.260 (in-sample avg dev_std = 0.408)
NEC for r=0.3 all KL = 0.573 +- 0.260 (in-sample avg dev_std = 0.408)
NEC for r=0.3 all L1 = 0.581 +- 0.142 (in-sample avg dev_std = 0.408)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.712
Model XAI F1 of binarized graphs for r=0.6 =  0.28413124999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.1874425
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.427
NEC for r=0.6 class 0 = 0.625 +- 0.229 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 1 = 0.455 +- 0.229 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 2 = 0.575 +- 0.229 (in-sample avg dev_std = 0.409)
NEC for r=0.6 all KL = 0.493 +- 0.229 (in-sample avg dev_std = 0.409)
NEC for r=0.6 all L1 = 0.553 +- 0.144 (in-sample avg dev_std = 0.409)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.635
Model XAI F1 of binarized graphs for r=0.9 =  0.24661249999999998
Model XAI WIoU of binarized graphs for r=0.9 =  0.15134125
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.53
NEC for r=0.9 class 0 = 0.591 +- 0.182 (in-sample avg dev_std = 0.481)
NEC for r=0.9 class 1 = 0.491 +- 0.182 (in-sample avg dev_std = 0.481)
NEC for r=0.9 class 2 = 0.489 +- 0.182 (in-sample avg dev_std = 0.481)
NEC for r=0.9 all KL = 0.468 +- 0.182 (in-sample avg dev_std = 0.481)
NEC for r=0.9 all L1 = 0.524 +- 0.114 (in-sample avg dev_std = 0.481)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.809
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.16315125000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.598
NEC for r=1.0 class 0 = 0.555 +- 0.203 (in-sample avg dev_std = 0.507)
NEC for r=1.0 class 1 = 0.457 +- 0.203 (in-sample avg dev_std = 0.507)
NEC for r=1.0 class 2 = 0.524 +- 0.203 (in-sample avg dev_std = 0.507)
NEC for r=1.0 all KL = 0.47 +- 0.203 (in-sample avg dev_std = 0.507)
NEC for r=1.0 all L1 = 0.512 +- 0.115 (in-sample avg dev_std = 0.507)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.688
Model XAI F1 of binarized graphs for r=0.3 =  0.63566625
Model XAI WIoU of binarized graphs for r=0.3 =  0.515265
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.365
NEC for r=0.3 class 0 = 0.653 +- 0.242 (in-sample avg dev_std = 0.467)
NEC for r=0.3 class 1 = 0.515 +- 0.242 (in-sample avg dev_std = 0.467)
NEC for r=0.3 class 2 = 0.658 +- 0.242 (in-sample avg dev_std = 0.467)
NEC for r=0.3 all KL = 0.637 +- 0.242 (in-sample avg dev_std = 0.467)
NEC for r=0.3 all L1 = 0.607 +- 0.139 (in-sample avg dev_std = 0.467)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.48989374999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.35478499999999996
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.473
NEC for r=0.6 class 0 = 0.571 +- 0.220 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 1 = 0.433 +- 0.220 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 2 = 0.549 +- 0.220 (in-sample avg dev_std = 0.460)
NEC for r=0.6 all KL = 0.476 +- 0.220 (in-sample avg dev_std = 0.460)
NEC for r=0.6 all L1 = 0.516 +- 0.155 (in-sample avg dev_std = 0.460)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.738
Model XAI F1 of binarized graphs for r=0.9 =  0.41095375000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.2793825
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.583
NEC for r=0.9 class 0 = 0.611 +- 0.296 (in-sample avg dev_std = 0.528)
NEC for r=0.9 class 1 = 0.382 +- 0.296 (in-sample avg dev_std = 0.528)
NEC for r=0.9 class 2 = 0.459 +- 0.296 (in-sample avg dev_std = 0.528)
NEC for r=0.9 all KL = 0.507 +- 0.296 (in-sample avg dev_std = 0.528)
NEC for r=0.9 all L1 = 0.482 +- 0.176 (in-sample avg dev_std = 0.528)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.806
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26323375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.613
NEC for r=1.0 class 0 = 0.502 +- 0.262 (in-sample avg dev_std = 0.548)
NEC for r=1.0 class 1 = 0.369 +- 0.262 (in-sample avg dev_std = 0.548)
NEC for r=1.0 class 2 = 0.394 +- 0.262 (in-sample avg dev_std = 0.548)
NEC for r=1.0 all KL = 0.438 +- 0.262 (in-sample avg dev_std = 0.548)
NEC for r=1.0 all L1 = 0.42 +- 0.171 (in-sample avg dev_std = 0.548)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:19:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/22/2024 12:19:22 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:19:22 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:19:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:19:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:19:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:19:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:19:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9303
Train Loss: 0.3118
ID Validation ACCURACY: 0.9357
ID Validation Loss: 0.3016
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3358
OOD Validation ACCURACY: 0.8073
OOD Validation Loss: 0.5158
OOD Test ACCURACY: 0.7527
OOD Test Loss: 1.0888

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9293
Train Loss: 0.3258
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3155
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3465
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.4445
OOD Test ACCURACY: 0.5280
OOD Test Loss: 1.3857

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7527 0.9257 0.5280 0.9347 0.9260[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.729
WIoU for r=0.3 = 0.612
F1 for r=0.6 = 0.603
WIoU for r=0.6 = 0.479
F1 for r=0.9 = 0.477
WIoU for r=0.9 = 0.353
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.331
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.536
WIoU for r=0.3 = 0.413
F1 for r=0.6 = 0.342
WIoU for r=0.6 = 0.228
F1 for r=0.9 = 0.265
WIoU for r=0.9 = 0.168
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.169
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.654
WIoU for r=0.3 = 0.519
F1 for r=0.6 = 0.483
WIoU for r=0.6 = 0.348
F1 for r=0.9 = 0.390
WIoU for r=0.9 = 0.262
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.263


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.486
Model XAI F1 of binarized graphs for r=0.3 =  0.72892875
Model XAI WIoU of binarized graphs for r=0.3 =  0.6118412500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.494
SUFF++ for r=0.3 class 0 = 0.479 +- 0.253 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 1 = 0.621 +- 0.253 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 2 = 0.532 +- 0.253 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 all KL = 0.578 +- 0.253 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 all L1 = 0.544 +- 0.162 (in-sample avg dev_std = 0.466)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.796
Model XAI F1 of binarized graphs for r=0.6 =  0.602595
Model XAI WIoU of binarized graphs for r=0.6 =  0.47919875000000006
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.688
SUFF++ for r=0.6 class 0 = 0.458 +- 0.250 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 1 = 0.733 +- 0.250 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 2 = 0.694 +- 0.250 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 all KL = 0.682 +- 0.250 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 all L1 = 0.628 +- 0.197 (in-sample avg dev_std = 0.397)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.47736125
Model XAI WIoU of binarized graphs for r=0.9 =  0.35338875000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.872
SUFF++ for r=0.9 class 0 = 0.713 +- 0.176 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 1 = 0.843 +- 0.176 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 2 = 0.822 +- 0.176 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 all KL = 0.86 +- 0.176 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 all L1 = 0.793 +- 0.164 (in-sample avg dev_std = 0.283)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.626
Model XAI F1 of binarized graphs for r=0.3 =  0.5358762499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.41256875
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.568
SUFF++ for r=0.3 class 0 = 0.516 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.3 class 1 = 0.687 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.3 class 2 = 0.591 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.3 all KL = 0.688 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.3 all L1 = 0.597 +- 0.184 (in-sample avg dev_std = 0.365)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.663
Model XAI F1 of binarized graphs for r=0.6 =  0.34156
Model XAI WIoU of binarized graphs for r=0.6 =  0.22752249999999996
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.604
SUFF++ for r=0.6 class 0 = 0.444 +- 0.209 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 1 = 0.698 +- 0.209 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 2 = 0.559 +- 0.209 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 all KL = 0.678 +- 0.209 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 all L1 = 0.566 +- 0.163 (in-sample avg dev_std = 0.328)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.767
Model XAI F1 of binarized graphs for r=0.9 =  0.265325
Model XAI WIoU of binarized graphs for r=0.9 =  0.16789
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.696
SUFF++ for r=0.9 class 0 = 0.557 +- 0.181 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 1 = 0.69 +- 0.181 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 2 = 0.695 +- 0.181 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 all KL = 0.749 +- 0.181 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 all L1 = 0.647 +- 0.160 (in-sample avg dev_std = 0.335)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.459
Model XAI F1 of binarized graphs for r=0.3 =  0.6542587499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.51921125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.519
SUFF++ for r=0.3 class 0 = 0.498 +- 0.276 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.3 class 1 = 0.644 +- 0.276 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.3 class 2 = 0.639 +- 0.276 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.3 all KL = 0.598 +- 0.276 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.3 all L1 = 0.595 +- 0.183 (in-sample avg dev_std = 0.468)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.48279250000000007
Model XAI WIoU of binarized graphs for r=0.6 =  0.3483737499999999
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.681
SUFF++ for r=0.6 class 0 = 0.456 +- 0.206 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.6 class 1 = 0.696 +- 0.206 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.6 class 2 = 0.54 +- 0.206 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.6 all KL = 0.677 +- 0.206 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.6 all L1 = 0.566 +- 0.195 (in-sample avg dev_std = 0.320)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.76
Model XAI F1 of binarized graphs for r=0.9 =  0.38961875
Model XAI WIoU of binarized graphs for r=0.9 =  0.26186
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.696
SUFF++ for r=0.9 class 0 = 0.662 +- 0.156 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 1 = 0.82 +- 0.156 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 2 = 0.881 +- 0.156 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all KL = 0.884 +- 0.156 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all L1 = 0.789 +- 0.184 (in-sample avg dev_std = 0.256)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.484
Model XAI F1 of binarized graphs for r=0.3 =  0.72892875
Model XAI WIoU of binarized graphs for r=0.3 =  0.6118412500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.317
NEC for r=0.3 class 0 = 0.626 +- 0.266 (in-sample avg dev_std = 0.390)
NEC for r=0.3 class 1 = 0.475 +- 0.266 (in-sample avg dev_std = 0.390)
NEC for r=0.3 class 2 = 0.601 +- 0.266 (in-sample avg dev_std = 0.390)
NEC for r=0.3 all KL = 0.56 +- 0.266 (in-sample avg dev_std = 0.390)
NEC for r=0.3 all L1 = 0.567 +- 0.171 (in-sample avg dev_std = 0.390)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.796
Model XAI F1 of binarized graphs for r=0.6 =  0.602595
Model XAI WIoU of binarized graphs for r=0.6 =  0.47919875000000006
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.442
NEC for r=0.6 class 0 = 0.651 +- 0.255 (in-sample avg dev_std = 0.463)
NEC for r=0.6 class 1 = 0.453 +- 0.255 (in-sample avg dev_std = 0.463)
NEC for r=0.6 class 2 = 0.624 +- 0.255 (in-sample avg dev_std = 0.463)
NEC for r=0.6 all KL = 0.573 +- 0.255 (in-sample avg dev_std = 0.463)
NEC for r=0.6 all L1 = 0.576 +- 0.165 (in-sample avg dev_std = 0.463)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.47736125
Model XAI WIoU of binarized graphs for r=0.9 =  0.35338875000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.514
NEC for r=0.9 class 0 = 0.612 +- 0.216 (in-sample avg dev_std = 0.562)
NEC for r=0.9 class 1 = 0.455 +- 0.216 (in-sample avg dev_std = 0.562)
NEC for r=0.9 class 2 = 0.572 +- 0.216 (in-sample avg dev_std = 0.562)
NEC for r=0.9 all KL = 0.564 +- 0.216 (in-sample avg dev_std = 0.562)
NEC for r=0.9 all L1 = 0.546 +- 0.157 (in-sample avg dev_std = 0.562)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.944
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.3305025
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.55
NEC for r=1.0 class 0 = 0.579 +- 0.246 (in-sample avg dev_std = 0.617)
NEC for r=1.0 class 1 = 0.389 +- 0.246 (in-sample avg dev_std = 0.617)
NEC for r=1.0 class 2 = 0.576 +- 0.246 (in-sample avg dev_std = 0.617)
NEC for r=1.0 all KL = 0.555 +- 0.246 (in-sample avg dev_std = 0.617)
NEC for r=1.0 all L1 = 0.514 +- 0.180 (in-sample avg dev_std = 0.617)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  0.5358762499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.41256875
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.32
NEC for r=0.3 class 0 = 0.5 +- 0.263 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 1 = 0.487 +- 0.263 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 2 = 0.666 +- 0.263 (in-sample avg dev_std = 0.372)
NEC for r=0.3 all KL = 0.486 +- 0.263 (in-sample avg dev_std = 0.372)
NEC for r=0.3 all L1 = 0.552 +- 0.159 (in-sample avg dev_std = 0.372)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.665
Model XAI F1 of binarized graphs for r=0.6 =  0.34156
Model XAI WIoU of binarized graphs for r=0.6 =  0.22752249999999996
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.414
NEC for r=0.6 class 0 = 0.571 +- 0.199 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 1 = 0.499 +- 0.199 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 2 = 0.579 +- 0.199 (in-sample avg dev_std = 0.459)
NEC for r=0.6 all KL = 0.481 +- 0.199 (in-sample avg dev_std = 0.459)
NEC for r=0.6 all L1 = 0.55 +- 0.115 (in-sample avg dev_std = 0.459)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.769
Model XAI F1 of binarized graphs for r=0.9 =  0.265325
Model XAI WIoU of binarized graphs for r=0.9 =  0.16789
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.527
NEC for r=0.9 class 0 = 0.599 +- 0.190 (in-sample avg dev_std = 0.534)
NEC for r=0.9 class 1 = 0.537 +- 0.190 (in-sample avg dev_std = 0.534)
NEC for r=0.9 class 2 = 0.489 +- 0.190 (in-sample avg dev_std = 0.534)
NEC for r=0.9 all KL = 0.52 +- 0.190 (in-sample avg dev_std = 0.534)
NEC for r=0.9 all L1 = 0.542 +- 0.119 (in-sample avg dev_std = 0.534)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.804
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.16923624999999998
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.577
NEC for r=1.0 class 0 = 0.581 +- 0.207 (in-sample avg dev_std = 0.565)
NEC for r=1.0 class 1 = 0.465 +- 0.207 (in-sample avg dev_std = 0.565)
NEC for r=1.0 class 2 = 0.551 +- 0.207 (in-sample avg dev_std = 0.565)
NEC for r=1.0 all KL = 0.54 +- 0.207 (in-sample avg dev_std = 0.565)
NEC for r=1.0 all L1 = 0.533 +- 0.123 (in-sample avg dev_std = 0.565)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.456
Model XAI F1 of binarized graphs for r=0.3 =  0.6542587499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.51921125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.413
NEC for r=0.3 class 0 = 0.507 +- 0.233 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 1 = 0.578 +- 0.233 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 2 = 0.578 +- 0.233 (in-sample avg dev_std = 0.489)
NEC for r=0.3 all KL = 0.603 +- 0.233 (in-sample avg dev_std = 0.489)
NEC for r=0.3 all L1 = 0.555 +- 0.171 (in-sample avg dev_std = 0.489)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.589
Model XAI F1 of binarized graphs for r=0.6 =  0.48279250000000007
Model XAI WIoU of binarized graphs for r=0.6 =  0.3483737499999999
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.447
NEC for r=0.6 class 0 = 0.58 +- 0.240 (in-sample avg dev_std = 0.432)
NEC for r=0.6 class 1 = 0.488 +- 0.240 (in-sample avg dev_std = 0.432)
NEC for r=0.6 class 2 = 0.542 +- 0.240 (in-sample avg dev_std = 0.432)
NEC for r=0.6 all KL = 0.487 +- 0.240 (in-sample avg dev_std = 0.432)
NEC for r=0.6 all L1 = 0.536 +- 0.151 (in-sample avg dev_std = 0.432)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.76
Model XAI F1 of binarized graphs for r=0.9 =  0.38961875
Model XAI WIoU of binarized graphs for r=0.9 =  0.26186
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.59
NEC for r=0.9 class 0 = 0.527 +- 0.295 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 1 = 0.389 +- 0.295 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 2 = 0.424 +- 0.295 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all KL = 0.446 +- 0.295 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all L1 = 0.446 +- 0.180 (in-sample avg dev_std = 0.533)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.772
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26257375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.609
NEC for r=1.0 class 0 = 0.472 +- 0.289 (in-sample avg dev_std = 0.507)
NEC for r=1.0 class 1 = 0.362 +- 0.289 (in-sample avg dev_std = 0.507)
NEC for r=1.0 class 2 = 0.357 +- 0.289 (in-sample avg dev_std = 0.507)
NEC for r=1.0 all KL = 0.413 +- 0.289 (in-sample avg dev_std = 0.507)
NEC for r=1.0 all L1 = 0.396 +- 0.176 (in-sample avg dev_std = 0.507)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:23:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/22/2024 12:23:20 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:23:20 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:23:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:23:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:23:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:23:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:23:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:23:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:23:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:23:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3216
ID Validation ACCURACY: 0.9353
ID Validation Loss: 0.3083
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3413
OOD Validation ACCURACY: 0.9157
OOD Validation Loss: 0.4277
OOD Test ACCURACY: 0.7673
OOD Test Loss: 0.8079

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3200
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3075
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3766
OOD Test ACCURACY: 0.7923
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.7673 0.9250 0.7923 0.9337 0.9280[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.705
WIoU for r=0.3 = 0.588
F1 for r=0.6 = 0.577
WIoU for r=0.6 = 0.457
F1 for r=0.9 = 0.457
WIoU for r=0.9 = 0.332
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.327
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.478
WIoU for r=0.3 = 0.363
F1 for r=0.6 = 0.308
WIoU for r=0.6 = 0.203
F1 for r=0.9 = 0.244
WIoU for r=0.9 = 0.152
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.165
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.595
WIoU for r=0.3 = 0.477
F1 for r=0.6 = 0.440
WIoU for r=0.6 = 0.317
F1 for r=0.9 = 0.389
WIoU for r=0.9 = 0.261
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.260


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.48
Model XAI F1 of binarized graphs for r=0.3 =  0.7048700000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.587735
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.45
SUFF++ for r=0.3 class 0 = 0.477 +- 0.270 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 1 = 0.49 +- 0.270 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 2 = 0.548 +- 0.270 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 all KL = 0.561 +- 0.270 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 all L1 = 0.505 +- 0.168 (in-sample avg dev_std = 0.437)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.711
Model XAI F1 of binarized graphs for r=0.6 =  0.57654625
Model XAI WIoU of binarized graphs for r=0.6 =  0.45657375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.651
SUFF++ for r=0.6 class 0 = 0.485 +- 0.240 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 1 = 0.707 +- 0.240 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 2 = 0.663 +- 0.240 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 all KL = 0.657 +- 0.240 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 all L1 = 0.618 +- 0.185 (in-sample avg dev_std = 0.422)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.933
Model XAI F1 of binarized graphs for r=0.9 =  0.45686875
Model XAI WIoU of binarized graphs for r=0.9 =  0.33242875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.863
SUFF++ for r=0.9 class 0 = 0.638 +- 0.179 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 1 = 0.845 +- 0.179 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 2 = 0.836 +- 0.179 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 all KL = 0.841 +- 0.179 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 all L1 = 0.773 +- 0.154 (in-sample avg dev_std = 0.319)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.68
Model XAI F1 of binarized graphs for r=0.3 =  0.47763875
Model XAI WIoU of binarized graphs for r=0.3 =  0.36338125
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.606
SUFF++ for r=0.3 class 0 = 0.58 +- 0.215 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.3 class 1 = 0.608 +- 0.215 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.3 class 2 = 0.613 +- 0.215 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.3 all KL = 0.711 +- 0.215 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.3 all L1 = 0.6 +- 0.143 (in-sample avg dev_std = 0.375)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.67
Model XAI F1 of binarized graphs for r=0.6 =  0.30756375
Model XAI WIoU of binarized graphs for r=0.6 =  0.20333125
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.586
SUFF++ for r=0.6 class 0 = 0.462 +- 0.209 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 1 = 0.684 +- 0.209 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 2 = 0.559 +- 0.209 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 all KL = 0.695 +- 0.209 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 all L1 = 0.567 +- 0.157 (in-sample avg dev_std = 0.300)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.835
Model XAI F1 of binarized graphs for r=0.9 =  0.24438125
Model XAI WIoU of binarized graphs for r=0.9 =  0.1524625
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.719
SUFF++ for r=0.9 class 0 = 0.57 +- 0.187 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.9 class 1 = 0.679 +- 0.187 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.9 class 2 = 0.64 +- 0.187 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.9 all KL = 0.736 +- 0.187 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.9 all L1 = 0.629 +- 0.145 (in-sample avg dev_std = 0.343)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.476
Model XAI F1 of binarized graphs for r=0.3 =  0.59546125
Model XAI WIoU of binarized graphs for r=0.3 =  0.47737999999999997
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.535
SUFF++ for r=0.3 class 0 = 0.561 +- 0.276 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 class 1 = 0.582 +- 0.276 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 class 2 = 0.61 +- 0.276 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 all KL = 0.616 +- 0.276 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 all L1 = 0.584 +- 0.171 (in-sample avg dev_std = 0.448)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.717
Model XAI F1 of binarized graphs for r=0.6 =  0.44035624999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.3166975
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.687
SUFF++ for r=0.6 class 0 = 0.428 +- 0.258 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 1 = 0.663 +- 0.258 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 2 = 0.644 +- 0.258 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 all KL = 0.681 +- 0.258 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 all L1 = 0.581 +- 0.188 (in-sample avg dev_std = 0.328)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.705
Model XAI F1 of binarized graphs for r=0.9 =  0.38863
Model XAI WIoU of binarized graphs for r=0.9 =  0.26089125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.664
SUFF++ for r=0.9 class 0 = 0.583 +- 0.176 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.9 class 1 = 0.822 +- 0.176 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.9 class 2 = 0.831 +- 0.176 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.9 all KL = 0.819 +- 0.176 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.9 all L1 = 0.748 +- 0.155 (in-sample avg dev_std = 0.281)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.482
Model XAI F1 of binarized graphs for r=0.3 =  0.7048700000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.587735
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.295
NEC for r=0.3 class 0 = 0.601 +- 0.278 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 1 = 0.583 +- 0.278 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 2 = 0.588 +- 0.278 (in-sample avg dev_std = 0.408)
NEC for r=0.3 all KL = 0.556 +- 0.278 (in-sample avg dev_std = 0.408)
NEC for r=0.3 all L1 = 0.591 +- 0.154 (in-sample avg dev_std = 0.408)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.709
Model XAI F1 of binarized graphs for r=0.6 =  0.57654625
Model XAI WIoU of binarized graphs for r=0.6 =  0.45657375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.389
NEC for r=0.6 class 0 = 0.589 +- 0.268 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 1 = 0.518 +- 0.268 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 2 = 0.66 +- 0.268 (in-sample avg dev_std = 0.459)
NEC for r=0.6 all KL = 0.597 +- 0.268 (in-sample avg dev_std = 0.459)
NEC for r=0.6 all L1 = 0.589 +- 0.158 (in-sample avg dev_std = 0.459)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.933
Model XAI F1 of binarized graphs for r=0.9 =  0.45686875
Model XAI WIoU of binarized graphs for r=0.9 =  0.33242875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.507
NEC for r=0.9 class 0 = 0.592 +- 0.200 (in-sample avg dev_std = 0.588)
NEC for r=0.9 class 1 = 0.493 +- 0.200 (in-sample avg dev_std = 0.588)
NEC for r=0.9 class 2 = 0.57 +- 0.200 (in-sample avg dev_std = 0.588)
NEC for r=0.9 all KL = 0.577 +- 0.200 (in-sample avg dev_std = 0.588)
NEC for r=0.9 all L1 = 0.551 +- 0.146 (in-sample avg dev_std = 0.588)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.944
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.326995
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.547 +- 0.234 (in-sample avg dev_std = 0.609)
NEC for r=1.0 class 1 = 0.43 +- 0.234 (in-sample avg dev_std = 0.609)
NEC for r=1.0 class 2 = 0.57 +- 0.234 (in-sample avg dev_std = 0.609)
NEC for r=1.0 all KL = 0.539 +- 0.234 (in-sample avg dev_std = 0.609)
NEC for r=1.0 all L1 = 0.515 +- 0.175 (in-sample avg dev_std = 0.609)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.68
Model XAI F1 of binarized graphs for r=0.3 =  0.47763875
Model XAI WIoU of binarized graphs for r=0.3 =  0.36338125
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.306
NEC for r=0.3 class 0 = 0.453 +- 0.286 (in-sample avg dev_std = 0.342)
NEC for r=0.3 class 1 = 0.507 +- 0.286 (in-sample avg dev_std = 0.342)
NEC for r=0.3 class 2 = 0.648 +- 0.286 (in-sample avg dev_std = 0.342)
NEC for r=0.3 all KL = 0.45 +- 0.286 (in-sample avg dev_std = 0.342)
NEC for r=0.3 all L1 = 0.536 +- 0.154 (in-sample avg dev_std = 0.342)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.673
Model XAI F1 of binarized graphs for r=0.6 =  0.30756375
Model XAI WIoU of binarized graphs for r=0.6 =  0.20333125
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.421
NEC for r=0.6 class 0 = 0.553 +- 0.211 (in-sample avg dev_std = 0.379)
NEC for r=0.6 class 1 = 0.43 +- 0.211 (in-sample avg dev_std = 0.379)
NEC for r=0.6 class 2 = 0.589 +- 0.211 (in-sample avg dev_std = 0.379)
NEC for r=0.6 all KL = 0.423 +- 0.211 (in-sample avg dev_std = 0.379)
NEC for r=0.6 all L1 = 0.525 +- 0.132 (in-sample avg dev_std = 0.379)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.837
Model XAI F1 of binarized graphs for r=0.9 =  0.24438125
Model XAI WIoU of binarized graphs for r=0.9 =  0.1524625
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.531
NEC for r=0.9 class 0 = 0.555 +- 0.178 (in-sample avg dev_std = 0.492)
NEC for r=0.9 class 1 = 0.495 +- 0.178 (in-sample avg dev_std = 0.492)
NEC for r=0.9 class 2 = 0.495 +- 0.178 (in-sample avg dev_std = 0.492)
NEC for r=0.9 all KL = 0.463 +- 0.178 (in-sample avg dev_std = 0.492)
NEC for r=0.9 all L1 = 0.515 +- 0.107 (in-sample avg dev_std = 0.492)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.16467624999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.593
NEC for r=1.0 class 0 = 0.477 +- 0.214 (in-sample avg dev_std = 0.540)
NEC for r=1.0 class 1 = 0.456 +- 0.214 (in-sample avg dev_std = 0.540)
NEC for r=1.0 class 2 = 0.518 +- 0.214 (in-sample avg dev_std = 0.540)
NEC for r=1.0 all KL = 0.453 +- 0.214 (in-sample avg dev_std = 0.540)
NEC for r=1.0 all L1 = 0.484 +- 0.122 (in-sample avg dev_std = 0.540)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.476
Model XAI F1 of binarized graphs for r=0.3 =  0.59546125
Model XAI WIoU of binarized graphs for r=0.3 =  0.47737999999999997
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.437
NEC for r=0.3 class 0 = 0.526 +- 0.259 (in-sample avg dev_std = 0.470)
NEC for r=0.3 class 1 = 0.642 +- 0.259 (in-sample avg dev_std = 0.470)
NEC for r=0.3 class 2 = 0.64 +- 0.259 (in-sample avg dev_std = 0.470)
NEC for r=0.3 all KL = 0.635 +- 0.259 (in-sample avg dev_std = 0.470)
NEC for r=0.3 all L1 = 0.604 +- 0.147 (in-sample avg dev_std = 0.470)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.717
Model XAI F1 of binarized graphs for r=0.6 =  0.44035624999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.3166975
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.467
NEC for r=0.6 class 0 = 0.595 +- 0.277 (in-sample avg dev_std = 0.419)
NEC for r=0.6 class 1 = 0.449 +- 0.277 (in-sample avg dev_std = 0.419)
NEC for r=0.6 class 2 = 0.581 +- 0.277 (in-sample avg dev_std = 0.419)
NEC for r=0.6 all KL = 0.498 +- 0.277 (in-sample avg dev_std = 0.419)
NEC for r=0.6 all L1 = 0.54 +- 0.162 (in-sample avg dev_std = 0.419)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.705
Model XAI F1 of binarized graphs for r=0.9 =  0.38863
Model XAI WIoU of binarized graphs for r=0.9 =  0.26089125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.572
NEC for r=0.9 class 0 = 0.561 +- 0.327 (in-sample avg dev_std = 0.511)
NEC for r=0.9 class 1 = 0.366 +- 0.327 (in-sample avg dev_std = 0.511)
NEC for r=0.9 class 2 = 0.495 +- 0.327 (in-sample avg dev_std = 0.511)
NEC for r=0.9 all KL = 0.473 +- 0.327 (in-sample avg dev_std = 0.511)
NEC for r=0.9 all L1 = 0.472 +- 0.191 (in-sample avg dev_std = 0.511)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.771
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26045625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.604
NEC for r=1.0 class 0 = 0.478 +- 0.250 (in-sample avg dev_std = 0.473)
NEC for r=1.0 class 1 = 0.372 +- 0.250 (in-sample avg dev_std = 0.473)
NEC for r=1.0 class 2 = 0.432 +- 0.250 (in-sample avg dev_std = 0.473)
NEC for r=1.0 all KL = 0.383 +- 0.250 (in-sample avg dev_std = 0.473)
NEC for r=1.0 all L1 = 0.427 +- 0.146 (in-sample avg dev_std = 0.473)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.549, 0.638, 0.823, 1.0], 'all_L1': [0.531, 0.62, 0.758, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.5, 0.628, 0.851, 1.0], 'all_L1': [0.489, 0.619, 0.788, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.464, 0.603, 0.834, 1.0], 'all_L1': [0.472, 0.602, 0.776, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.578, 0.682, 0.86, 1.0], 'all_L1': [0.544, 0.628, 0.793, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.561, 0.657, 0.841, 1.0], 'all_L1': [0.505, 0.618, 0.773, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.553, 0.617, 0.581, 0.553], 'all_L1': [0.557, 0.569, 0.552, 0.519]}), defaultdict(<class 'list'>, {'all_KL': [0.63, 0.609, 0.566, 0.553], 'all_L1': [0.624, 0.576, 0.538, 0.518]}), defaultdict(<class 'list'>, {'all_KL': [0.639, 0.607, 0.622, 0.572], 'all_L1': [0.616, 0.567, 0.558, 0.514]}), defaultdict(<class 'list'>, {'all_KL': [0.56, 0.573, 0.564, 0.555], 'all_L1': [0.567, 0.576, 0.546, 0.514]}), defaultdict(<class 'list'>, {'all_KL': [0.556, 0.597, 0.577, 0.539], 'all_L1': [0.591, 0.589, 0.551, 0.515]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.681, 0.697, 0.779, 1.0], 'all_L1': [0.592, 0.571, 0.663, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.58, 0.647, 0.752, 1.0], 'all_L1': [0.565, 0.562, 0.633, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.599, 0.628, 0.733, 1.0], 'all_L1': [0.555, 0.537, 0.621, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.688, 0.678, 0.749, 1.0], 'all_L1': [0.597, 0.566, 0.647, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.711, 0.695, 0.736, 1.0], 'all_L1': [0.6, 0.567, 0.629, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.456, 0.416, 0.451, 0.478], 'all_L1': [0.532, 0.516, 0.506, 0.488]}), defaultdict(<class 'list'>, {'all_KL': [0.636, 0.521, 0.452, 0.471], 'all_L1': [0.625, 0.564, 0.512, 0.494]}), defaultdict(<class 'list'>, {'all_KL': [0.573, 0.493, 0.468, 0.47], 'all_L1': [0.581, 0.553, 0.524, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.486, 0.481, 0.52, 0.54], 'all_L1': [0.552, 0.55, 0.542, 0.533]}), defaultdict(<class 'list'>, {'all_KL': [0.45, 0.423, 0.463, 0.453], 'all_L1': [0.536, 0.525, 0.515, 0.484]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.659, 0.727, 0.866, 1.0], 'all_L1': [0.61, 0.651, 0.755, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.554, 0.663, 0.805, 1.0], 'all_L1': [0.566, 0.638, 0.748, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.716, 0.836, 1.0], 'all_L1': [0.569, 0.631, 0.757, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.598, 0.677, 0.884, 1.0], 'all_L1': [0.595, 0.566, 0.789, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.616, 0.681, 0.819, 1.0], 'all_L1': [0.584, 0.581, 0.748, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.51, 0.564, 0.407, 0.369], 'all_L1': [0.529, 0.548, 0.446, 0.397]}), defaultdict(<class 'list'>, {'all_KL': [0.652, 0.642, 0.546, 0.378], 'all_L1': [0.604, 0.59, 0.472, 0.396]}), defaultdict(<class 'list'>, {'all_KL': [0.637, 0.476, 0.507, 0.438], 'all_L1': [0.607, 0.516, 0.482, 0.42]}), defaultdict(<class 'list'>, {'all_KL': [0.603, 0.487, 0.446, 0.413], 'all_L1': [0.555, 0.536, 0.446, 0.396]}), defaultdict(<class 'list'>, {'all_KL': [0.635, 0.498, 0.473, 0.383], 'all_L1': [0.604, 0.54, 0.472, 0.427]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.508 +- 0.026, 0.617 +- 0.008, 0.778 +- 0.012, 1.000 +- 0.000
suff++ class all_KL  =  0.530 +- 0.042, 0.642 +- 0.027, 0.842 +- 0.013, 1.000 +- 0.000
suff++_acc_int  =  0.457 +- 0.019, 0.650 +- 0.028, 0.851 +- 0.017
nec class all_L1  =  0.591 +- 0.026, 0.575 +- 0.008, 0.549 +- 0.007, 0.516 +- 0.002
nec class all_KL  =  0.588 +- 0.038, 0.601 +- 0.015, 0.582 +- 0.021, 0.554 +- 0.010
nec_acc_int  =  0.310 +- 0.008, 0.402 +- 0.022, 0.515 +- 0.011, 0.547 +- 0.010

Eval split val
suff++ class all_L1  =  0.582 +- 0.018, 0.561 +- 0.012, 0.639 +- 0.015, 1.000 +- 0.000
suff++ class all_KL  =  0.652 +- 0.052, 0.669 +- 0.027, 0.750 +- 0.016, 1.000 +- 0.000
suff++_acc_int  =  0.579 +- 0.024, 0.595 +- 0.033, 0.693 +- 0.034
nec class all_L1  =  0.565 +- 0.035, 0.542 +- 0.018, 0.520 +- 0.013, 0.502 +- 0.018
nec class all_KL  =  0.520 +- 0.073, 0.467 +- 0.041, 0.471 +- 0.025, 0.482 +- 0.030
nec_acc_int  =  0.325 +- 0.013, 0.426 +- 0.008, 0.522 +- 0.015, 0.582 +- 0.012

Eval split test
suff++ class all_L1  =  0.585 +- 0.016, 0.613 +- 0.034, 0.759 +- 0.015, 1.000 +- 0.000
suff++ class all_KL  =  0.602 +- 0.035, 0.693 +- 0.024, 0.842 +- 0.029, 1.000 +- 0.000
suff++_acc_int  =  0.513 +- 0.024, 0.671 +- 0.023, 0.702 +- 0.030
nec class all_L1  =  0.580 +- 0.032, 0.546 +- 0.024, 0.464 +- 0.015, 0.407 +- 0.013
nec class all_KL  =  0.607 +- 0.051, 0.533 +- 0.062, 0.476 +- 0.048, 0.396 +- 0.026
nec_acc_int  =  0.413 +- 0.028, 0.453 +- 0.015, 0.579 +- 0.007, 0.602 +- 0.014


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.550 +- 0.005, 0.596 +- 0.007, 0.663 +- 0.005, 0.758 +- 0.001
Faith. Armon (L1)= 		  =  0.545 +- 0.007, 0.596 +- 0.007, 0.644 +- 0.004, 0.681 +- 0.002
Faith. GMean (L1)= 	  =  0.547 +- 0.006, 0.596 +- 0.007, 0.653 +- 0.004, 0.718 +- 0.001
Faith. Aritm (KL)= 		  =  0.559 +- 0.007, 0.621 +- 0.009, 0.712 +- 0.009, 0.777 +- 0.005
Faith. Armon (KL)= 		  =  0.555 +- 0.010, 0.620 +- 0.008, 0.688 +- 0.012, 0.713 +- 0.009
Faith. GMean (KL)= 	  =  0.557 +- 0.008, 0.620 +- 0.008, 0.700 +- 0.010, 0.745 +- 0.007

Eval split val
Faith. Aritm (L1)= 		  =  0.574 +- 0.011, 0.551 +- 0.008, 0.579 +- 0.009, 0.751 +- 0.009
Faith. Armon (L1)= 		  =  0.572 +- 0.011, 0.551 +- 0.008, 0.573 +- 0.009, 0.668 +- 0.016
Faith. GMean (L1)= 	  =  0.573 +- 0.011, 0.551 +- 0.008, 0.576 +- 0.009, 0.709 +- 0.013
Faith. Aritm (KL)= 		  =  0.586 +- 0.013, 0.568 +- 0.011, 0.610 +- 0.013, 0.741 +- 0.015
Faith. Armon (KL)= 		  =  0.572 +- 0.022, 0.548 +- 0.021, 0.578 +- 0.018, 0.650 +- 0.027
Faith. GMean (KL)= 	  =  0.579 +- 0.017, 0.558 +- 0.016, 0.594 +- 0.015, 0.694 +- 0.021

Eval split test
Faith. Aritm (L1)= 		  =  0.582 +- 0.009, 0.580 +- 0.024, 0.611 +- 0.007, 0.704 +- 0.007
Faith. Armon (L1)= 		  =  0.581 +- 0.010, 0.577 +- 0.023, 0.575 +- 0.010, 0.579 +- 0.014
Faith. GMean (L1)= 	  =  0.582 +- 0.009, 0.578 +- 0.023, 0.593 +- 0.008, 0.638 +- 0.011
Faith. Aritm (KL)= 		  =  0.605 +- 0.013, 0.613 +- 0.030, 0.659 +- 0.015, 0.698 +- 0.013
Faith. Armon (KL)= 		  =  0.602 +- 0.016, 0.600 +- 0.036, 0.606 +- 0.033, 0.567 +- 0.026
Faith. GMean (KL)= 	  =  0.603 +- 0.015, 0.607 +- 0.033, 0.632 +- 0.024, 0.629 +- 0.020
Computed for split load_split = id



Completed in  0:21:48.327562  for GSATGIN GOODMotif2/basis



DONE GSAT GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:27:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 12:27:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0025
ID Validation ACCURACY: 0.9106
ID Validation Loss: 0.5101
ID Test ACCURACY: 0.8987
ID Test Loss: 0.6337
OOD Validation ACCURACY: 0.8501
OOD Validation Loss: 1.2162
OOD Test ACCURACY: 0.7241
OOD Test Loss: 5.9794

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9918
Train Loss: 0.0210
ID Validation ACCURACY: 0.9013
ID Validation Loss: 0.3950
ID Test ACCURACY: 0.8921
ID Test Loss: 0.4835
OOD Validation ACCURACY: 0.8680
OOD Validation Loss: 0.6745
OOD Test ACCURACY: 0.7971
OOD Test Loss: 1.9556

[0m[1;37mINFO[0m: [1mChartInfo 0.8987 0.7241 0.8921 0.7971 0.9013 0.8680[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 04/22/2024 12:28:01 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.821
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.764
SUFF++ for r=0.6 class 0.0 = 0.703 +- 0.321 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 class 1.0 = 0.899 +- 0.321 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 all KL = 0.708 +- 0.321 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 all L1 = 0.817 +- 0.212 (in-sample avg dev_std = 0.461)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.85
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.855
SUFF++ for r=0.9 class 0.0 = 0.91 +- 0.174 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 class 1.0 = 0.954 +- 0.174 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 all KL = 0.937 +- 0.174 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 all L1 = 0.934 +- 0.158 (in-sample avg dev_std = 0.158)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.692
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.65
SUFF++ for r=0.3 class 0.0 = 0.7 +- 0.293 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 1.0 = 0.85 +- 0.293 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 all KL = 0.69 +- 0.293 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 all L1 = 0.778 +- 0.196 (in-sample avg dev_std = 0.456)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.769
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.729
SUFF++ for r=0.6 class 0.0 = 0.719 +- 0.297 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 class 1.0 = 0.897 +- 0.297 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 all KL = 0.706 +- 0.297 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 all L1 = 0.812 +- 0.196 (in-sample avg dev_std = 0.423)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.826
SUFF++ for r=0.9 class 0.0 = 0.857 +- 0.234 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.9 class 1.0 = 0.949 +- 0.234 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.9 all KL = 0.851 +- 0.234 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.9 all L1 = 0.905 +- 0.154 (in-sample avg dev_std = 0.316)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.665
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.615
SUFF++ for r=0.3 class 0.0 = 0.676 +- 0.304 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 1.0 = 0.879 +- 0.304 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 all KL = 0.691 +- 0.304 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 all L1 = 0.781 +- 0.217 (in-sample avg dev_std = 0.441)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.705
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.659
SUFF++ for r=0.6 class 0.0 = 0.701 +- 0.314 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 class 1.0 = 0.94 +- 0.314 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all KL = 0.751 +- 0.314 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all L1 = 0.824 +- 0.225 (in-sample avg dev_std = 0.410)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.74
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.717
SUFF++ for r=0.9 class 0.0 = 0.841 +- 0.243 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 class 1.0 = 0.982 +- 0.243 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 all KL = 0.874 +- 0.243 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 all L1 = 0.914 +- 0.167 (in-sample avg dev_std = 0.280)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.821
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.821
NEC for r=0.6 class 0.0 = 0.169 +- 0.227 (in-sample avg dev_std = 0.202)
NEC for r=0.6 class 1.0 = 0.044 +- 0.227 (in-sample avg dev_std = 0.202)
NEC for r=0.6 all KL = 0.099 +- 0.227 (in-sample avg dev_std = 0.202)
NEC for r=0.6 all L1 = 0.096 +- 0.193 (in-sample avg dev_std = 0.202)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.849
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.853
NEC for r=0.9 class 0.0 = 0.069 +- 0.138 (in-sample avg dev_std = 0.131)
NEC for r=0.9 class 1.0 = 0.031 +- 0.138 (in-sample avg dev_std = 0.131)
NEC for r=0.9 all KL = 0.044 +- 0.138 (in-sample avg dev_std = 0.131)
NEC for r=0.9 all L1 = 0.047 +- 0.127 (in-sample avg dev_std = 0.131)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.853
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.852
NEC for r=1.0 class 0.0 = 0.061 +- 0.127 (in-sample avg dev_std = 0.125)
NEC for r=1.0 class 1.0 = 0.028 +- 0.127 (in-sample avg dev_std = 0.125)
NEC for r=1.0 all KL = 0.037 +- 0.127 (in-sample avg dev_std = 0.125)
NEC for r=1.0 all L1 = 0.042 +- 0.116 (in-sample avg dev_std = 0.125)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.692
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.705
NEC for r=0.3 class 0.0 = 0.223 +- 0.231 (in-sample avg dev_std = 0.236)
NEC for r=0.3 class 1.0 = 0.094 +- 0.231 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all KL = 0.136 +- 0.231 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all L1 = 0.156 +- 0.216 (in-sample avg dev_std = 0.236)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.769
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.784
NEC for r=0.6 class 0.0 = 0.171 +- 0.197 (in-sample avg dev_std = 0.205)
NEC for r=0.6 class 1.0 = 0.054 +- 0.197 (in-sample avg dev_std = 0.205)
NEC for r=0.6 all KL = 0.096 +- 0.197 (in-sample avg dev_std = 0.205)
NEC for r=0.6 all L1 = 0.11 +- 0.186 (in-sample avg dev_std = 0.205)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.845
NEC for r=0.9 class 0.0 = 0.088 +- 0.142 (in-sample avg dev_std = 0.151)
NEC for r=0.9 class 1.0 = 0.025 +- 0.142 (in-sample avg dev_std = 0.151)
NEC for r=0.9 all KL = 0.049 +- 0.142 (in-sample avg dev_std = 0.151)
NEC for r=0.9 all L1 = 0.055 +- 0.133 (in-sample avg dev_std = 0.151)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.86
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.855
NEC for r=1.0 class 0.0 = 0.076 +- 0.125 (in-sample avg dev_std = 0.154)
NEC for r=1.0 class 1.0 = 0.026 +- 0.125 (in-sample avg dev_std = 0.154)
NEC for r=1.0 all KL = 0.04 +- 0.125 (in-sample avg dev_std = 0.154)
NEC for r=1.0 all L1 = 0.05 +- 0.125 (in-sample avg dev_std = 0.154)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.665
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.667
NEC for r=0.3 class 0.0 = 0.249 +- 0.228 (in-sample avg dev_std = 0.266)
NEC for r=0.3 class 1.0 = 0.074 +- 0.228 (in-sample avg dev_std = 0.266)
NEC for r=0.3 all KL = 0.149 +- 0.228 (in-sample avg dev_std = 0.266)
NEC for r=0.3 all L1 = 0.159 +- 0.217 (in-sample avg dev_std = 0.266)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.705
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.715
NEC for r=0.6 class 0.0 = 0.207 +- 0.223 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 1.0 = 0.041 +- 0.223 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all KL = 0.125 +- 0.223 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all L1 = 0.122 +- 0.203 (in-sample avg dev_std = 0.258)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.74
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.739
NEC for r=0.9 class 0.0 = 0.119 +- 0.188 (in-sample avg dev_std = 0.191)
NEC for r=0.9 class 1.0 = 0.019 +- 0.188 (in-sample avg dev_std = 0.191)
NEC for r=0.9 all KL = 0.075 +- 0.188 (in-sample avg dev_std = 0.191)
NEC for r=0.9 all L1 = 0.068 +- 0.158 (in-sample avg dev_std = 0.191)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.755
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.745
NEC for r=1.0 class 0.0 = 0.095 +- 0.174 (in-sample avg dev_std = 0.183)
NEC for r=1.0 class 1.0 = 0.023 +- 0.174 (in-sample avg dev_std = 0.183)
NEC for r=1.0 all KL = 0.061 +- 0.174 (in-sample avg dev_std = 0.183)
NEC for r=1.0 all L1 = 0.057 +- 0.145 (in-sample avg dev_std = 0.183)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:31:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 12:31:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.7707
ID Test ACCURACY: 0.9036
ID Test Loss: 0.8911
OOD Validation ACCURACY: 0.8742
OOD Validation Loss: 0.9645
OOD Test ACCURACY: 0.8288
OOD Test Loss: 1.5437

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9087
ID Validation Loss: 0.6769
ID Test ACCURACY: 0.9010
ID Test Loss: 0.7782
OOD Validation ACCURACY: 0.8751
OOD Validation Loss: 0.7905
OOD Test ACCURACY: 0.8313
OOD Test Loss: 1.1097

[0m[1;37mINFO[0m: [1mChartInfo 0.9036 0.8288 0.9010 0.8313 0.9087 0.8751[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 04/22/2024 12:31:09 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.881
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.814
SUFF++ for r=0.6 class 0.0 = 0.703 +- 0.398 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 1.0 = 0.878 +- 0.398 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 all KL = 0.598 +- 0.398 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 all L1 = 0.805 +- 0.225 (in-sample avg dev_std = 0.516)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.872
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.87
SUFF++ for r=0.9 class 0.0 = 0.967 +- 0.068 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.9 class 1.0 = 0.977 +- 0.068 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.9 all KL = 0.981 +- 0.068 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.9 all L1 = 0.972 +- 0.094 (in-sample avg dev_std = 0.088)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.728
SUFF++ for r=0.3 class 0.0 = 0.611 +- 0.393 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 class 1.0 = 0.865 +- 0.393 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 all KL = 0.507 +- 0.393 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 all L1 = 0.744 +- 0.232 (in-sample avg dev_std = 0.614)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.848
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.803
SUFF++ for r=0.6 class 0.0 = 0.747 +- 0.358 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 1.0 = 0.893 +- 0.358 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 all KL = 0.659 +- 0.358 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 all L1 = 0.823 +- 0.214 (in-sample avg dev_std = 0.479)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.87
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.865
SUFF++ for r=0.9 class 0.0 = 0.928 +- 0.209 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 1.0 = 0.94 +- 0.209 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 all KL = 0.9 +- 0.209 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 all L1 = 0.935 +- 0.140 (in-sample avg dev_std = 0.258)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.683
SUFF++ for r=0.3 class 0.0 = 0.639 +- 0.385 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 1.0 = 0.9 +- 0.385 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 all KL = 0.56 +- 0.385 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 all L1 = 0.774 +- 0.232 (in-sample avg dev_std = 0.558)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.836
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.779
SUFF++ for r=0.6 class 0.0 = 0.742 +- 0.349 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 1.0 = 0.884 +- 0.349 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 all KL = 0.647 +- 0.349 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 all L1 = 0.815 +- 0.212 (in-sample avg dev_std = 0.473)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.851
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.85
SUFF++ for r=0.9 class 0.0 = 0.93 +- 0.192 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 class 1.0 = 0.926 +- 0.192 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 all KL = 0.906 +- 0.192 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 all L1 = 0.928 +- 0.145 (in-sample avg dev_std = 0.238)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.881
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.861
NEC for r=0.6 class 0.0 = 0.149 +- 0.284 (in-sample avg dev_std = 0.244)
NEC for r=0.6 class 1.0 = 0.062 +- 0.284 (in-sample avg dev_std = 0.244)
NEC for r=0.6 all KL = 0.13 +- 0.284 (in-sample avg dev_std = 0.244)
NEC for r=0.6 all L1 = 0.098 +- 0.212 (in-sample avg dev_std = 0.244)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.877
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.879
NEC for r=0.9 class 0.0 = 0.028 +- 0.098 (in-sample avg dev_std = 0.094)
NEC for r=0.9 class 1.0 = 0.032 +- 0.098 (in-sample avg dev_std = 0.094)
NEC for r=0.9 all KL = 0.025 +- 0.098 (in-sample avg dev_std = 0.094)
NEC for r=0.9 all L1 = 0.03 +- 0.112 (in-sample avg dev_std = 0.094)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.881
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.876
NEC for r=1.0 class 0.0 = 0.025 +- 0.100 (in-sample avg dev_std = 0.092)
NEC for r=1.0 class 1.0 = 0.032 +- 0.100 (in-sample avg dev_std = 0.092)
NEC for r=1.0 all KL = 0.024 +- 0.100 (in-sample avg dev_std = 0.092)
NEC for r=1.0 all L1 = 0.029 +- 0.111 (in-sample avg dev_std = 0.092)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.795
NEC for r=0.3 class 0.0 = 0.214 +- 0.313 (in-sample avg dev_std = 0.288)
NEC for r=0.3 class 1.0 = 0.055 +- 0.313 (in-sample avg dev_std = 0.288)
NEC for r=0.3 all KL = 0.17 +- 0.313 (in-sample avg dev_std = 0.288)
NEC for r=0.3 all L1 = 0.131 +- 0.240 (in-sample avg dev_std = 0.288)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.848
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.845
NEC for r=0.6 class 0.0 = 0.143 +- 0.250 (in-sample avg dev_std = 0.252)
NEC for r=0.6 class 1.0 = 0.046 +- 0.250 (in-sample avg dev_std = 0.252)
NEC for r=0.6 all KL = 0.112 +- 0.250 (in-sample avg dev_std = 0.252)
NEC for r=0.6 all L1 = 0.093 +- 0.202 (in-sample avg dev_std = 0.252)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.87
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.863
NEC for r=0.9 class 0.0 = 0.051 +- 0.152 (in-sample avg dev_std = 0.157)
NEC for r=0.9 class 1.0 = 0.046 +- 0.152 (in-sample avg dev_std = 0.157)
NEC for r=0.9 all KL = 0.047 +- 0.152 (in-sample avg dev_std = 0.157)
NEC for r=0.9 all L1 = 0.048 +- 0.134 (in-sample avg dev_std = 0.157)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.87
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.866
NEC for r=1.0 class 0.0 = 0.043 +- 0.131 (in-sample avg dev_std = 0.141)
NEC for r=1.0 class 1.0 = 0.039 +- 0.131 (in-sample avg dev_std = 0.141)
NEC for r=1.0 all KL = 0.036 +- 0.131 (in-sample avg dev_std = 0.141)
NEC for r=1.0 all L1 = 0.041 +- 0.125 (in-sample avg dev_std = 0.141)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.752
NEC for r=0.3 class 0.0 = 0.216 +- 0.307 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 1.0 = 0.049 +- 0.307 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all KL = 0.177 +- 0.307 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all L1 = 0.13 +- 0.230 (in-sample avg dev_std = 0.309)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.836
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.823
NEC for r=0.6 class 0.0 = 0.167 +- 0.263 (in-sample avg dev_std = 0.271)
NEC for r=0.6 class 1.0 = 0.063 +- 0.263 (in-sample avg dev_std = 0.271)
NEC for r=0.6 all KL = 0.14 +- 0.263 (in-sample avg dev_std = 0.271)
NEC for r=0.6 all L1 = 0.113 +- 0.212 (in-sample avg dev_std = 0.271)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.851
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.848
NEC for r=0.9 class 0.0 = 0.072 +- 0.175 (in-sample avg dev_std = 0.195)
NEC for r=0.9 class 1.0 = 0.061 +- 0.175 (in-sample avg dev_std = 0.195)
NEC for r=0.9 all KL = 0.066 +- 0.175 (in-sample avg dev_std = 0.195)
NEC for r=0.9 all L1 = 0.067 +- 0.157 (in-sample avg dev_std = 0.195)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.863
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.851
NEC for r=1.0 class 0.0 = 0.055 +- 0.149 (in-sample avg dev_std = 0.159)
NEC for r=1.0 class 1.0 = 0.056 +- 0.149 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all KL = 0.048 +- 0.149 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all L1 = 0.055 +- 0.144 (in-sample avg dev_std = 0.159)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:34:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:34:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 12:34:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9070
ID Validation Loss: 0.6761
ID Test ACCURACY: 0.9085
ID Test Loss: 0.7858
OOD Validation ACCURACY: 0.8698
OOD Validation Loss: 0.7126
OOD Test ACCURACY: 0.8129
OOD Test Loss: 0.9194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9070
ID Validation Loss: 0.6761
ID Test ACCURACY: 0.9085
ID Test Loss: 0.7858
OOD Validation ACCURACY: 0.8698
OOD Validation Loss: 0.7126
OOD Test ACCURACY: 0.8129
OOD Test Loss: 0.9194

[0m[1;37mINFO[0m: [1mChartInfo 0.9085 0.8129 0.9085 0.8129 0.9070 0.8698[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 04/22/2024 12:34:29 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.817
SUFF++ for r=0.6 class 0.0 = 0.916 +- 0.360 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 class 1.0 = 0.83 +- 0.360 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 all KL = 0.716 +- 0.360 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 all L1 = 0.866 +- 0.192 (in-sample avg dev_std = 0.400)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.856
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.858
SUFF++ for r=0.9 class 0.0 = 0.966 +- 0.103 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.9 class 1.0 = 0.959 +- 0.103 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.9 all KL = 0.97 +- 0.103 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.9 all L1 = 0.962 +- 0.117 (in-sample avg dev_std = 0.107)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.791
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.723
SUFF++ for r=0.3 class 0.0 = 0.941 +- 0.381 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 class 1.0 = 0.694 +- 0.381 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 all KL = 0.673 +- 0.381 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 all L1 = 0.812 +- 0.219 (in-sample avg dev_std = 0.517)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.813
SUFF++ for r=0.6 class 0.0 = 0.932 +- 0.297 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 1.0 = 0.833 +- 0.297 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all KL = 0.782 +- 0.297 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all L1 = 0.88 +- 0.168 (in-sample avg dev_std = 0.377)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.864
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.859
SUFF++ for r=0.9 class 0.0 = 0.942 +- 0.120 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 class 1.0 = 0.943 +- 0.120 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all KL = 0.946 +- 0.120 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all L1 = 0.943 +- 0.122 (in-sample avg dev_std = 0.189)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.74
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.667
SUFF++ for r=0.3 class 0.0 = 0.947 +- 0.354 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.3 class 1.0 = 0.716 +- 0.354 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.3 all KL = 0.729 +- 0.354 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.3 all L1 = 0.828 +- 0.221 (in-sample avg dev_std = 0.452)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.783
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.751
SUFF++ for r=0.6 class 0.0 = 0.911 +- 0.278 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.6 class 1.0 = 0.809 +- 0.278 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.6 all KL = 0.785 +- 0.278 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.6 all L1 = 0.859 +- 0.175 (in-sample avg dev_std = 0.359)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.815
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.81
SUFF++ for r=0.9 class 0.0 = 0.922 +- 0.123 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 class 1.0 = 0.909 +- 0.123 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 all KL = 0.94 +- 0.123 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 all L1 = 0.915 +- 0.146 (in-sample avg dev_std = 0.183)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.843
NEC for r=0.6 class 0.0 = 0.075 +- 0.222 (in-sample avg dev_std = 0.171)
NEC for r=0.6 class 1.0 = 0.073 +- 0.222 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all KL = 0.085 +- 0.222 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all L1 = 0.074 +- 0.185 (in-sample avg dev_std = 0.171)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.849
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.86
NEC for r=0.9 class 0.0 = 0.041 +- 0.120 (in-sample avg dev_std = 0.109)
NEC for r=0.9 class 1.0 = 0.042 +- 0.120 (in-sample avg dev_std = 0.109)
NEC for r=0.9 all KL = 0.034 +- 0.120 (in-sample avg dev_std = 0.109)
NEC for r=0.9 all L1 = 0.042 +- 0.126 (in-sample avg dev_std = 0.109)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.86
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.861
NEC for r=1.0 class 0.0 = 0.047 +- 0.129 (in-sample avg dev_std = 0.104)
NEC for r=1.0 class 1.0 = 0.043 +- 0.129 (in-sample avg dev_std = 0.104)
NEC for r=1.0 all KL = 0.037 +- 0.129 (in-sample avg dev_std = 0.104)
NEC for r=1.0 all L1 = 0.045 +- 0.134 (in-sample avg dev_std = 0.104)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.791
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.805
NEC for r=0.3 class 0.0 = 0.046 +- 0.232 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 1.0 = 0.133 +- 0.232 (in-sample avg dev_std = 0.188)
NEC for r=0.3 all KL = 0.1 +- 0.232 (in-sample avg dev_std = 0.188)
NEC for r=0.3 all L1 = 0.092 +- 0.194 (in-sample avg dev_std = 0.188)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.845
NEC for r=0.6 class 0.0 = 0.044 +- 0.154 (in-sample avg dev_std = 0.156)
NEC for r=0.6 class 1.0 = 0.076 +- 0.154 (in-sample avg dev_std = 0.156)
NEC for r=0.6 all KL = 0.056 +- 0.154 (in-sample avg dev_std = 0.156)
NEC for r=0.6 all L1 = 0.061 +- 0.149 (in-sample avg dev_std = 0.156)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.864
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.861
NEC for r=0.9 class 0.0 = 0.05 +- 0.110 (in-sample avg dev_std = 0.130)
NEC for r=0.9 class 1.0 = 0.049 +- 0.110 (in-sample avg dev_std = 0.130)
NEC for r=0.9 all KL = 0.035 +- 0.110 (in-sample avg dev_std = 0.130)
NEC for r=0.9 all L1 = 0.049 +- 0.126 (in-sample avg dev_std = 0.130)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.865
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.865
NEC for r=1.0 class 0.0 = 0.043 +- 0.096 (in-sample avg dev_std = 0.116)
NEC for r=1.0 class 1.0 = 0.04 +- 0.096 (in-sample avg dev_std = 0.116)
NEC for r=1.0 all KL = 0.027 +- 0.096 (in-sample avg dev_std = 0.116)
NEC for r=1.0 all L1 = 0.042 +- 0.112 (in-sample avg dev_std = 0.116)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.74
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.73
NEC for r=0.3 class 0.0 = 0.05 +- 0.216 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 1.0 = 0.141 +- 0.216 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all KL = 0.105 +- 0.216 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all L1 = 0.097 +- 0.188 (in-sample avg dev_std = 0.209)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.783
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.781
NEC for r=0.6 class 0.0 = 0.057 +- 0.160 (in-sample avg dev_std = 0.186)
NEC for r=0.6 class 1.0 = 0.117 +- 0.160 (in-sample avg dev_std = 0.186)
NEC for r=0.6 all KL = 0.073 +- 0.160 (in-sample avg dev_std = 0.186)
NEC for r=0.6 all L1 = 0.088 +- 0.165 (in-sample avg dev_std = 0.186)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.815
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.817
NEC for r=0.9 class 0.0 = 0.072 +- 0.133 (in-sample avg dev_std = 0.163)
NEC for r=0.9 class 1.0 = 0.091 +- 0.133 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all KL = 0.056 +- 0.133 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all L1 = 0.082 +- 0.149 (in-sample avg dev_std = 0.163)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.83
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.826
NEC for r=1.0 class 0.0 = 0.07 +- 0.102 (in-sample avg dev_std = 0.141)
NEC for r=1.0 class 1.0 = 0.079 +- 0.102 (in-sample avg dev_std = 0.141)
NEC for r=1.0 all KL = 0.041 +- 0.102 (in-sample avg dev_std = 0.141)
NEC for r=1.0 all L1 = 0.075 +- 0.133 (in-sample avg dev_std = 0.141)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:37:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 12:37:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0001
ID Validation ACCURACY: 0.9147
ID Validation Loss: 0.6881
ID Test ACCURACY: 0.9072
ID Test Loss: 0.8292
OOD Validation ACCURACY: 0.8620
OOD Validation Loss: 1.4572
OOD Test ACCURACY: 0.8092
OOD Test Loss: 3.9476

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9128
ID Validation Loss: 0.7432
ID Test ACCURACY: 0.9068
ID Test Loss: 0.8946
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 1.4169
OOD Test ACCURACY: 0.8193
OOD Test Loss: 3.6034

[0m[1;37mINFO[0m: [1mChartInfo 0.9072 0.8092 0.9068 0.8193 0.9128 0.8693[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 04/22/2024 12:37:44 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.789
SUFF++ for r=0.6 class 0.0 = 0.697 +- 0.389 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 class 1.0 = 0.942 +- 0.389 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 all KL = 0.688 +- 0.389 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 all L1 = 0.84 +- 0.224 (in-sample avg dev_std = 0.464)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.867
SUFF++ for r=0.9 class 0.0 = 0.921 +- 0.179 (in-sample avg dev_std = 0.144)
SUFF++ for r=0.9 class 1.0 = 0.976 +- 0.179 (in-sample avg dev_std = 0.144)
SUFF++ for r=0.9 all KL = 0.949 +- 0.179 (in-sample avg dev_std = 0.144)
SUFF++ for r=0.9 all L1 = 0.952 +- 0.157 (in-sample avg dev_std = 0.144)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.734
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.672
SUFF++ for r=0.3 class 0.0 = 0.677 +- 0.375 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 1.0 = 0.906 +- 0.375 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 all KL = 0.66 +- 0.375 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 all L1 = 0.797 +- 0.244 (in-sample avg dev_std = 0.496)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.819
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.752
SUFF++ for r=0.6 class 0.0 = 0.703 +- 0.369 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 class 1.0 = 0.926 +- 0.369 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 all KL = 0.665 +- 0.369 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 all L1 = 0.819 +- 0.224 (in-sample avg dev_std = 0.485)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.849
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.845
SUFF++ for r=0.9 class 0.0 = 0.895 +- 0.231 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 class 1.0 = 0.941 +- 0.231 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 all KL = 0.869 +- 0.231 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 all L1 = 0.919 +- 0.153 (in-sample avg dev_std = 0.295)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.686
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.622
SUFF++ for r=0.3 class 0.0 = 0.674 +- 0.366 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 1.0 = 0.871 +- 0.366 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 all KL = 0.6 +- 0.366 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 all L1 = 0.776 +- 0.242 (in-sample avg dev_std = 0.523)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.754
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.698
SUFF++ for r=0.6 class 0.0 = 0.724 +- 0.378 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.6 class 1.0 = 0.936 +- 0.378 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.6 all KL = 0.665 +- 0.378 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.6 all L1 = 0.833 +- 0.209 (in-sample avg dev_std = 0.467)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.829
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.827
SUFF++ for r=0.9 class 0.0 = 0.9 +- 0.228 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.9 class 1.0 = 0.954 +- 0.228 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.9 all KL = 0.889 +- 0.228 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.9 all L1 = 0.928 +- 0.155 (in-sample avg dev_std = 0.249)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.839
NEC for r=0.6 class 0.0 = 0.171 +- 0.271 (in-sample avg dev_std = 0.250)
NEC for r=0.6 class 1.0 = 0.032 +- 0.271 (in-sample avg dev_std = 0.250)
NEC for r=0.6 all KL = 0.112 +- 0.271 (in-sample avg dev_std = 0.250)
NEC for r=0.6 all L1 = 0.09 +- 0.212 (in-sample avg dev_std = 0.250)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.888
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.867
NEC for r=0.9 class 0.0 = 0.076 +- 0.172 (in-sample avg dev_std = 0.137)
NEC for r=0.9 class 1.0 = 0.019 +- 0.172 (in-sample avg dev_std = 0.137)
NEC for r=0.9 all KL = 0.045 +- 0.172 (in-sample avg dev_std = 0.137)
NEC for r=0.9 all L1 = 0.043 +- 0.149 (in-sample avg dev_std = 0.137)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.888
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.874
NEC for r=1.0 class 0.0 = 0.06 +- 0.158 (in-sample avg dev_std = 0.132)
NEC for r=1.0 class 1.0 = 0.018 +- 0.158 (in-sample avg dev_std = 0.132)
NEC for r=1.0 all KL = 0.037 +- 0.158 (in-sample avg dev_std = 0.132)
NEC for r=1.0 all L1 = 0.036 +- 0.134 (in-sample avg dev_std = 0.132)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.734
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.745
NEC for r=0.3 class 0.0 = 0.198 +- 0.296 (in-sample avg dev_std = 0.268)
NEC for r=0.3 class 1.0 = 0.065 +- 0.296 (in-sample avg dev_std = 0.268)
NEC for r=0.3 all KL = 0.156 +- 0.296 (in-sample avg dev_std = 0.268)
NEC for r=0.3 all L1 = 0.129 +- 0.239 (in-sample avg dev_std = 0.268)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.819
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.821
NEC for r=0.6 class 0.0 = 0.132 +- 0.220 (in-sample avg dev_std = 0.216)
NEC for r=0.6 class 1.0 = 0.035 +- 0.220 (in-sample avg dev_std = 0.216)
NEC for r=0.6 all KL = 0.093 +- 0.220 (in-sample avg dev_std = 0.216)
NEC for r=0.6 all L1 = 0.082 +- 0.185 (in-sample avg dev_std = 0.216)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.849
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.856
NEC for r=0.9 class 0.0 = 0.066 +- 0.150 (in-sample avg dev_std = 0.171)
NEC for r=0.9 class 1.0 = 0.032 +- 0.150 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all KL = 0.047 +- 0.150 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all L1 = 0.048 +- 0.130 (in-sample avg dev_std = 0.171)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.856
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.862
NEC for r=1.0 class 0.0 = 0.058 +- 0.133 (in-sample avg dev_std = 0.151)
NEC for r=1.0 class 1.0 = 0.03 +- 0.133 (in-sample avg dev_std = 0.151)
NEC for r=1.0 all KL = 0.04 +- 0.133 (in-sample avg dev_std = 0.151)
NEC for r=1.0 all L1 = 0.044 +- 0.125 (in-sample avg dev_std = 0.151)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.686
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.688
NEC for r=0.3 class 0.0 = 0.21 +- 0.329 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 1.0 = 0.098 +- 0.329 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all KL = 0.211 +- 0.329 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all L1 = 0.152 +- 0.244 (in-sample avg dev_std = 0.344)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.754
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.764
NEC for r=0.6 class 0.0 = 0.15 +- 0.245 (in-sample avg dev_std = 0.232)
NEC for r=0.6 class 1.0 = 0.029 +- 0.245 (in-sample avg dev_std = 0.232)
NEC for r=0.6 all KL = 0.117 +- 0.245 (in-sample avg dev_std = 0.232)
NEC for r=0.6 all L1 = 0.088 +- 0.184 (in-sample avg dev_std = 0.232)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.829
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.824
NEC for r=0.9 class 0.0 = 0.086 +- 0.174 (in-sample avg dev_std = 0.165)
NEC for r=0.9 class 1.0 = 0.029 +- 0.174 (in-sample avg dev_std = 0.165)
NEC for r=0.9 all KL = 0.06 +- 0.174 (in-sample avg dev_std = 0.165)
NEC for r=0.9 all L1 = 0.057 +- 0.153 (in-sample avg dev_std = 0.165)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.83
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.83
NEC for r=1.0 class 0.0 = 0.068 +- 0.169 (in-sample avg dev_std = 0.161)
NEC for r=1.0 class 1.0 = 0.032 +- 0.169 (in-sample avg dev_std = 0.161)
NEC for r=1.0 all KL = 0.057 +- 0.169 (in-sample avg dev_std = 0.161)
NEC for r=1.0 all L1 = 0.05 +- 0.140 (in-sample avg dev_std = 0.161)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:40:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9085
ID Validation Loss: 0.7434
ID Test ACCURACY: 0.9083
ID Test Loss: 0.7942
OOD Validation ACCURACY: 0.8622
OOD Validation Loss: 1.0214
OOD Test ACCURACY: 0.7831
OOD Test Loss: 1.9072

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9062
ID Validation Loss: 0.7432
ID Test ACCURACY: 0.9059
ID Test Loss: 0.8164
OOD Validation ACCURACY: 0.8689
OOD Validation Loss: 0.9364
OOD Test ACCURACY: 0.8087
OOD Test Loss: 1.4925

[0m[1;37mINFO[0m: [1mChartInfo 0.9083 0.7831 0.9059 0.8087 0.9062 0.8689[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 04/22/2024 12:41:01 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.804
SUFF++ for r=0.6 class 0.0 = 0.784 +- 0.362 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 1.0 = 0.911 +- 0.362 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all KL = 0.716 +- 0.362 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all L1 = 0.858 +- 0.210 (in-sample avg dev_std = 0.437)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.861
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.856
SUFF++ for r=0.9 class 0.0 = 0.915 +- 0.171 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.9 class 1.0 = 0.961 +- 0.171 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.9 all KL = 0.946 +- 0.171 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.9 all L1 = 0.94 +- 0.162 (in-sample avg dev_std = 0.152)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.799
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.746
SUFF++ for r=0.3 class 0.0 = 0.672 +- 0.399 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.3 class 1.0 = 0.941 +- 0.399 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.3 all KL = 0.654 +- 0.399 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.3 all L1 = 0.812 +- 0.237 (in-sample avg dev_std = 0.524)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.815
SUFF++ for r=0.6 class 0.0 = 0.776 +- 0.319 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 1.0 = 0.939 +- 0.319 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all KL = 0.757 +- 0.319 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all L1 = 0.861 +- 0.197 (in-sample avg dev_std = 0.396)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.868
SUFF++ for r=0.9 class 0.0 = 0.929 +- 0.142 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.9 class 1.0 = 0.962 +- 0.142 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.9 all KL = 0.941 +- 0.142 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.9 all L1 = 0.946 +- 0.118 (in-sample avg dev_std = 0.205)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.719
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.667
SUFF++ for r=0.3 class 0.0 = 0.728 +- 0.371 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.3 class 1.0 = 0.971 +- 0.371 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.3 all KL = 0.744 +- 0.371 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.3 all L1 = 0.854 +- 0.230 (in-sample avg dev_std = 0.446)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.737
SUFF++ for r=0.6 class 0.0 = 0.772 +- 0.302 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 class 1.0 = 0.967 +- 0.302 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 all KL = 0.802 +- 0.302 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 all L1 = 0.873 +- 0.194 (in-sample avg dev_std = 0.360)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.794
SUFF++ for r=0.9 class 0.0 = 0.902 +- 0.123 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 class 1.0 = 0.976 +- 0.123 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 all KL = 0.951 +- 0.123 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 all L1 = 0.94 +- 0.129 (in-sample avg dev_std = 0.163)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.846
NEC for r=0.6 class 0.0 = 0.127 +- 0.260 (in-sample avg dev_std = 0.220)
NEC for r=0.6 class 1.0 = 0.051 +- 0.260 (in-sample avg dev_std = 0.220)
NEC for r=0.6 all KL = 0.1 +- 0.260 (in-sample avg dev_std = 0.220)
NEC for r=0.6 all L1 = 0.083 +- 0.210 (in-sample avg dev_std = 0.220)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.86
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.85
NEC for r=0.9 class 0.0 = 0.081 +- 0.180 (in-sample avg dev_std = 0.149)
NEC for r=0.9 class 1.0 = 0.036 +- 0.180 (in-sample avg dev_std = 0.149)
NEC for r=0.9 all KL = 0.054 +- 0.180 (in-sample avg dev_std = 0.149)
NEC for r=0.9 all L1 = 0.055 +- 0.164 (in-sample avg dev_std = 0.149)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.874
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.853
NEC for r=1.0 class 0.0 = 0.076 +- 0.186 (in-sample avg dev_std = 0.156)
NEC for r=1.0 class 1.0 = 0.04 +- 0.186 (in-sample avg dev_std = 0.156)
NEC for r=1.0 all KL = 0.057 +- 0.186 (in-sample avg dev_std = 0.156)
NEC for r=1.0 all L1 = 0.055 +- 0.167 (in-sample avg dev_std = 0.156)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.799
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.786
NEC for r=0.3 class 0.0 = 0.197 +- 0.298 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 1.0 = 0.029 +- 0.298 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all KL = 0.146 +- 0.298 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all L1 = 0.109 +- 0.222 (in-sample avg dev_std = 0.292)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.836
NEC for r=0.6 class 0.0 = 0.148 +- 0.234 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 1.0 = 0.041 +- 0.234 (in-sample avg dev_std = 0.248)
NEC for r=0.6 all KL = 0.107 +- 0.234 (in-sample avg dev_std = 0.248)
NEC for r=0.6 all L1 = 0.093 +- 0.190 (in-sample avg dev_std = 0.248)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.867
NEC for r=0.9 class 0.0 = 0.075 +- 0.139 (in-sample avg dev_std = 0.156)
NEC for r=0.9 class 1.0 = 0.033 +- 0.139 (in-sample avg dev_std = 0.156)
NEC for r=0.9 all KL = 0.047 +- 0.139 (in-sample avg dev_std = 0.156)
NEC for r=0.9 all L1 = 0.053 +- 0.135 (in-sample avg dev_std = 0.156)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.875
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.867
NEC for r=1.0 class 0.0 = 0.066 +- 0.136 (in-sample avg dev_std = 0.152)
NEC for r=1.0 class 1.0 = 0.031 +- 0.136 (in-sample avg dev_std = 0.152)
NEC for r=1.0 all KL = 0.042 +- 0.136 (in-sample avg dev_std = 0.152)
NEC for r=1.0 all L1 = 0.048 +- 0.133 (in-sample avg dev_std = 0.152)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.719
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.72
NEC for r=0.3 class 0.0 = 0.187 +- 0.294 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 1.0 = 0.019 +- 0.294 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all KL = 0.144 +- 0.294 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all L1 = 0.1 +- 0.214 (in-sample avg dev_std = 0.292)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.766
NEC for r=0.6 class 0.0 = 0.151 +- 0.198 (in-sample avg dev_std = 0.218)
NEC for r=0.6 class 1.0 = 0.025 +- 0.198 (in-sample avg dev_std = 0.218)
NEC for r=0.6 all KL = 0.09 +- 0.198 (in-sample avg dev_std = 0.218)
NEC for r=0.6 all L1 = 0.086 +- 0.178 (in-sample avg dev_std = 0.218)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.798
NEC for r=0.9 class 0.0 = 0.103 +- 0.130 (in-sample avg dev_std = 0.154)
NEC for r=0.9 class 1.0 = 0.024 +- 0.130 (in-sample avg dev_std = 0.154)
NEC for r=0.9 all KL = 0.05 +- 0.130 (in-sample avg dev_std = 0.154)
NEC for r=0.9 all L1 = 0.062 +- 0.139 (in-sample avg dev_std = 0.154)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.804
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.804
NEC for r=1.0 class 0.0 = 0.095 +- 0.125 (in-sample avg dev_std = 0.144)
NEC for r=1.0 class 1.0 = 0.022 +- 0.125 (in-sample avg dev_std = 0.144)
NEC for r=1.0 all KL = 0.044 +- 0.125 (in-sample avg dev_std = 0.144)
NEC for r=1.0 all L1 = 0.058 +- 0.137 (in-sample avg dev_std = 0.144)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.708, 0.937, 1.0], 'all_L1': [0.817, 0.934, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.598, 0.981, 1.0], 'all_L1': [0.805, 0.972, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.716, 0.97, 1.0], 'all_L1': [0.866, 0.962, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.688, 0.949, 1.0], 'all_L1': [0.84, 0.952, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.716, 0.946, 1.0], 'all_L1': [0.858, 0.94, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.099, 0.044, 0.037], 'all_L1': [0.096, 0.047, 0.042]}), defaultdict(<class 'list'>, {'all_KL': [0.13, 0.025, 0.024], 'all_L1': [0.098, 0.03, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.085, 0.034, 0.037], 'all_L1': [0.074, 0.042, 0.045]}), defaultdict(<class 'list'>, {'all_KL': [0.112, 0.045, 0.037], 'all_L1': [0.09, 0.043, 0.036]}), defaultdict(<class 'list'>, {'all_KL': [0.1, 0.054, 0.057], 'all_L1': [0.083, 0.055, 0.055]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.69, 0.706, 0.851, 1.0], 'all_L1': [0.778, 0.812, 0.905, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.507, 0.659, 0.9, 1.0], 'all_L1': [0.744, 0.823, 0.935, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.673, 0.782, 0.946, 1.0], 'all_L1': [0.812, 0.88, 0.943, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.66, 0.665, 0.869, 1.0], 'all_L1': [0.797, 0.819, 0.919, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.654, 0.757, 0.941, 1.0], 'all_L1': [0.812, 0.861, 0.946, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.136, 0.096, 0.049, 0.04], 'all_L1': [0.156, 0.11, 0.055, 0.05]}), defaultdict(<class 'list'>, {'all_KL': [0.17, 0.112, 0.047, 0.036], 'all_L1': [0.131, 0.093, 0.048, 0.041]}), defaultdict(<class 'list'>, {'all_KL': [0.1, 0.056, 0.035, 0.027], 'all_L1': [0.092, 0.061, 0.049, 0.042]}), defaultdict(<class 'list'>, {'all_KL': [0.156, 0.093, 0.047, 0.04], 'all_L1': [0.129, 0.082, 0.048, 0.044]}), defaultdict(<class 'list'>, {'all_KL': [0.146, 0.107, 0.047, 0.042], 'all_L1': [0.109, 0.093, 0.053, 0.048]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.691, 0.751, 0.874, 1.0], 'all_L1': [0.781, 0.824, 0.914, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.56, 0.647, 0.906, 1.0], 'all_L1': [0.774, 0.815, 0.928, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.729, 0.785, 0.94, 1.0], 'all_L1': [0.828, 0.859, 0.915, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.6, 0.665, 0.889, 1.0], 'all_L1': [0.776, 0.833, 0.928, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.744, 0.802, 0.951, 1.0], 'all_L1': [0.854, 0.873, 0.94, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.149, 0.125, 0.075, 0.061], 'all_L1': [0.159, 0.122, 0.068, 0.057]}), defaultdict(<class 'list'>, {'all_KL': [0.177, 0.14, 0.066, 0.048], 'all_L1': [0.13, 0.113, 0.067, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.105, 0.073, 0.056, 0.041], 'all_L1': [0.097, 0.088, 0.082, 0.075]}), defaultdict(<class 'list'>, {'all_KL': [0.211, 0.117, 0.06, 0.057], 'all_L1': [0.152, 0.088, 0.057, 0.05]}), defaultdict(<class 'list'>, {'all_KL': [0.144, 0.09, 0.05, 0.044], 'all_L1': [0.1, 0.086, 0.062, 0.058]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.837 +- 0.023, 0.952 +- 0.014, 1.000 +- 0.000
suff++ class all_KL  =  0.685 +- 0.045, 0.957 +- 0.016, 1.000 +- 0.000
suff++_acc_int  =  0.797 +- 0.019, 0.861 +- 0.006
nec class all_L1  =  0.088 +- 0.009, 0.043 +- 0.008, 0.041 +- 0.009
nec class all_KL  =  0.105 +- 0.015, 0.040 +- 0.010, 0.038 +- 0.011
nec_acc_int  =  0.842 +- 0.013, 0.862 +- 0.010, 0.863 +- 0.010

Eval split val
suff++ class all_L1  =  0.789 +- 0.026, 0.839 +- 0.027, 0.930 +- 0.015, 1.000 +- 0.000
suff++ class all_KL  =  0.637 +- 0.066, 0.714 +- 0.049, 0.901 +- 0.038, 1.000 +- 0.000
suff++_acc_int  =  0.704 +- 0.037, 0.782 +- 0.035, 0.852 +- 0.015
nec class all_L1  =  0.123 +- 0.022, 0.088 +- 0.016, 0.051 +- 0.003, 0.045 +- 0.003
nec class all_KL  =  0.142 +- 0.024, 0.093 +- 0.020, 0.045 +- 0.005, 0.037 +- 0.005
nec_acc_int  =  0.767 +- 0.037, 0.826 +- 0.023, 0.858 +- 0.008, 0.863 +- 0.005

Eval split test
suff++ class all_L1  =  0.803 +- 0.032, 0.841 +- 0.022, 0.925 +- 0.010, 1.000 +- 0.000
suff++ class all_KL  =  0.665 +- 0.072, 0.730 +- 0.063, 0.912 +- 0.029, 1.000 +- 0.000
suff++_acc_int  =  0.651 +- 0.027, 0.725 +- 0.042, 0.799 +- 0.045
nec class all_L1  =  0.128 +- 0.026, 0.099 +- 0.015, 0.067 +- 0.008, 0.059 +- 0.008
nec class all_KL  =  0.157 +- 0.035, 0.109 +- 0.024, 0.061 +- 0.009, 0.050 +- 0.008
nec_acc_int  =  0.712 +- 0.030, 0.770 +- 0.035, 0.805 +- 0.037, 0.811 +- 0.036


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.463 +- 0.008, 0.498 +- 0.004, 0.521 +- 0.004
Faith. Armon (L1)= 		  =  0.159 +- 0.014, 0.083 +- 0.015, 0.079 +- 0.016
Faith. GMean (L1)= 	  =  0.271 +- 0.010, 0.202 +- 0.018, 0.202 +- 0.022
Faith. Aritm (KL)= 		  =  0.395 +- 0.016, 0.499 +- 0.004, 0.519 +- 0.005
Faith. Armon (KL)= 		  =  0.181 +- 0.021, 0.077 +- 0.018, 0.074 +- 0.020
Faith. GMean (KL)= 	  =  0.267 +- 0.012, 0.195 +- 0.024, 0.194 +- 0.027

Eval split val
Faith. Aritm (L1)= 		  =  0.456 +- 0.010, 0.463 +- 0.009, 0.490 +- 0.007, 0.522 +- 0.002
Faith. Armon (L1)= 		  =  0.212 +- 0.032, 0.158 +- 0.026, 0.096 +- 0.005, 0.086 +- 0.006
Faith. GMean (L1)= 	  =  0.310 +- 0.025, 0.270 +- 0.023, 0.217 +- 0.006, 0.212 +- 0.008
Faith. Aritm (KL)= 		  =  0.389 +- 0.027, 0.403 +- 0.020, 0.473 +- 0.017, 0.518 +- 0.003
Faith. Armon (KL)= 		  =  0.229 +- 0.029, 0.163 +- 0.031, 0.086 +- 0.009, 0.071 +- 0.010
Faith. GMean (KL)= 	  =  0.298 +- 0.021, 0.255 +- 0.026, 0.201 +- 0.010, 0.192 +- 0.015

Eval split test
Faith. Aritm (L1)= 		  =  0.465 +- 0.008, 0.470 +- 0.007, 0.496 +- 0.004, 0.530 +- 0.004
Faith. Armon (L1)= 		  =  0.219 +- 0.037, 0.177 +- 0.023, 0.125 +- 0.014, 0.111 +- 0.015
Faith. GMean (L1)= 	  =  0.318 +- 0.027, 0.288 +- 0.019, 0.249 +- 0.014, 0.242 +- 0.017
Faith. Aritm (KL)= 		  =  0.411 +- 0.025, 0.419 +- 0.023, 0.487 +- 0.011, 0.525 +- 0.004
Faith. Armon (KL)= 		  =  0.250 +- 0.042, 0.188 +- 0.035, 0.115 +- 0.015, 0.096 +- 0.014
Faith. GMean (KL)= 	  =  0.319 +- 0.025, 0.279 +- 0.024, 0.236 +- 0.013, 0.223 +- 0.017
Computed for split load_split = id



Completed in  0:16:12.945635  for GSATvGIN GOODSST2/length



DONE GSAT GOODSST2/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:44:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:41 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:41 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:42 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:43 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 12:44:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9965
Train Loss: 0.0177
ID Validation ACCURACY: 0.6931
ID Validation Loss: 1.6171
ID Test ACCURACY: 0.6318
ID Test Loss: 1.8774
OOD Validation ACCURACY: 0.6011
OOD Validation Loss: 2.2998
OOD Test ACCURACY: 0.5319
OOD Test Loss: 3.2275

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0007
ID Validation ACCURACY: 0.6715
ID Validation Loss: 2.2483
ID Test ACCURACY: 0.6498
ID Test Loss: 2.4645
OOD Validation ACCURACY: 0.6353
OOD Validation Loss: 2.6045
OOD Test ACCURACY: 0.5765
OOD Test Loss: 3.1984

[0m[1;37mINFO[0m: [1mChartInfo 0.6318 0.5319 0.6498 0.5765 0.6715 0.6353[0mGOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.547
SUFF++ for r=0.3 class 0 = 0.662 +- 0.274 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 1 = 0.734 +- 0.274 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 2 = 0.589 +- 0.274 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all KL = 0.6 +- 0.274 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all L1 = 0.676 +- 0.205 (in-sample avg dev_std = 0.520)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.648
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.618
SUFF++ for r=0.6 class 0 = 0.791 +- 0.259 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 class 1 = 0.808 +- 0.259 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 class 2 = 0.713 +- 0.259 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 all KL = 0.74 +- 0.259 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 all L1 = 0.777 +- 0.204 (in-sample avg dev_std = 0.409)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.673
SUFF++ for r=0.9 class 0 = 0.897 +- 0.135 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 class 1 = 0.889 +- 0.135 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 class 2 = 0.883 +- 0.135 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 all KL = 0.917 +- 0.135 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 all L1 = 0.889 +- 0.141 (in-sample avg dev_std = 0.233)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.586
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.563
SUFF++ for r=0.3 class 0 = 0.677 +- 0.276 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 class 1 = 0.741 +- 0.276 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 class 2 = 0.674 +- 0.276 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 all KL = 0.646 +- 0.276 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 all L1 = 0.71 +- 0.212 (in-sample avg dev_std = 0.494)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.595
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.586
SUFF++ for r=0.6 class 0 = 0.783 +- 0.235 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 class 1 = 0.82 +- 0.235 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 class 2 = 0.735 +- 0.235 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 all KL = 0.782 +- 0.235 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 all L1 = 0.793 +- 0.195 (in-sample avg dev_std = 0.376)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.601
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.601
SUFF++ for r=0.9 class 0 = 0.863 +- 0.151 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 class 1 = 0.891 +- 0.151 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 class 2 = 0.845 +- 0.151 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 all KL = 0.917 +- 0.151 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 all L1 = 0.874 +- 0.165 (in-sample avg dev_std = 0.207)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.536
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.515
SUFF++ for r=0.3 class 0 = 0.668 +- 0.276 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.3 class 1 = 0.733 +- 0.276 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.3 class 2 = 0.654 +- 0.276 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.3 all KL = 0.629 +- 0.276 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.3 all L1 = 0.697 +- 0.216 (in-sample avg dev_std = 0.501)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.536
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.526
SUFF++ for r=0.6 class 0 = 0.784 +- 0.242 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 class 1 = 0.818 +- 0.242 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 class 2 = 0.741 +- 0.242 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 all KL = 0.775 +- 0.242 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 all L1 = 0.79 +- 0.198 (in-sample avg dev_std = 0.382)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.544
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.538
SUFF++ for r=0.9 class 0 = 0.89 +- 0.124 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 class 1 = 0.896 +- 0.124 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 class 2 = 0.862 +- 0.124 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 all KL = 0.928 +- 0.124 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 all L1 = 0.886 +- 0.155 (in-sample avg dev_std = 0.195)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.61
NEC for r=0.3 class 0 = 0.263 +- 0.248 (in-sample avg dev_std = 0.305)
NEC for r=0.3 class 1 = 0.192 +- 0.248 (in-sample avg dev_std = 0.305)
NEC for r=0.3 class 2 = 0.263 +- 0.248 (in-sample avg dev_std = 0.305)
NEC for r=0.3 all KL = 0.2 +- 0.248 (in-sample avg dev_std = 0.305)
NEC for r=0.3 all L1 = 0.229 +- 0.229 (in-sample avg dev_std = 0.305)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.648
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.638
NEC for r=0.6 class 0 = 0.187 +- 0.206 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 1 = 0.147 +- 0.206 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 2 = 0.18 +- 0.206 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all KL = 0.137 +- 0.206 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all L1 = 0.166 +- 0.201 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.672
NEC for r=0.9 class 0 = 0.12 +- 0.170 (in-sample avg dev_std = 0.229)
NEC for r=0.9 class 1 = 0.117 +- 0.170 (in-sample avg dev_std = 0.229)
NEC for r=0.9 class 2 = 0.137 +- 0.170 (in-sample avg dev_std = 0.229)
NEC for r=0.9 all KL = 0.093 +- 0.170 (in-sample avg dev_std = 0.229)
NEC for r=0.9 all L1 = 0.123 +- 0.170 (in-sample avg dev_std = 0.229)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.695
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.672
NEC for r=1.0 class 0 = 0.111 +- 0.156 (in-sample avg dev_std = 0.215)
NEC for r=1.0 class 1 = 0.117 +- 0.156 (in-sample avg dev_std = 0.215)
NEC for r=1.0 class 2 = 0.123 +- 0.156 (in-sample avg dev_std = 0.215)
NEC for r=1.0 all KL = 0.083 +- 0.156 (in-sample avg dev_std = 0.215)
NEC for r=1.0 all L1 = 0.117 +- 0.163 (in-sample avg dev_std = 0.215)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.586
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.59
NEC for r=0.3 class 0 = 0.291 +- 0.262 (in-sample avg dev_std = 0.338)
NEC for r=0.3 class 1 = 0.202 +- 0.262 (in-sample avg dev_std = 0.338)
NEC for r=0.3 class 2 = 0.225 +- 0.262 (in-sample avg dev_std = 0.338)
NEC for r=0.3 all KL = 0.22 +- 0.262 (in-sample avg dev_std = 0.338)
NEC for r=0.3 all L1 = 0.229 +- 0.234 (in-sample avg dev_std = 0.338)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.595
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.608
NEC for r=0.6 class 0 = 0.22 +- 0.222 (in-sample avg dev_std = 0.286)
NEC for r=0.6 class 1 = 0.156 +- 0.222 (in-sample avg dev_std = 0.286)
NEC for r=0.6 class 2 = 0.209 +- 0.222 (in-sample avg dev_std = 0.286)
NEC for r=0.6 all KL = 0.158 +- 0.222 (in-sample avg dev_std = 0.286)
NEC for r=0.6 all L1 = 0.183 +- 0.212 (in-sample avg dev_std = 0.286)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.601
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.614
NEC for r=0.9 class 0 = 0.161 +- 0.164 (in-sample avg dev_std = 0.212)
NEC for r=0.9 class 1 = 0.127 +- 0.164 (in-sample avg dev_std = 0.212)
NEC for r=0.9 class 2 = 0.174 +- 0.164 (in-sample avg dev_std = 0.212)
NEC for r=0.9 all KL = 0.104 +- 0.164 (in-sample avg dev_std = 0.212)
NEC for r=0.9 all L1 = 0.145 +- 0.182 (in-sample avg dev_std = 0.212)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.611
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.609
NEC for r=1.0 class 0 = 0.142 +- 0.157 (in-sample avg dev_std = 0.204)
NEC for r=1.0 class 1 = 0.133 +- 0.157 (in-sample avg dev_std = 0.204)
NEC for r=1.0 class 2 = 0.158 +- 0.157 (in-sample avg dev_std = 0.204)
NEC for r=1.0 all KL = 0.097 +- 0.157 (in-sample avg dev_std = 0.204)
NEC for r=1.0 all L1 = 0.14 +- 0.176 (in-sample avg dev_std = 0.204)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.536
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.531
NEC for r=0.3 class 0 = 0.261 +- 0.247 (in-sample avg dev_std = 0.330)
NEC for r=0.3 class 1 = 0.194 +- 0.247 (in-sample avg dev_std = 0.330)
NEC for r=0.3 class 2 = 0.242 +- 0.247 (in-sample avg dev_std = 0.330)
NEC for r=0.3 all KL = 0.211 +- 0.247 (in-sample avg dev_std = 0.330)
NEC for r=0.3 all L1 = 0.223 +- 0.221 (in-sample avg dev_std = 0.330)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.536
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.534
NEC for r=0.6 class 0 = 0.184 +- 0.214 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 1 = 0.155 +- 0.214 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 2 = 0.193 +- 0.214 (in-sample avg dev_std = 0.275)
NEC for r=0.6 all KL = 0.145 +- 0.214 (in-sample avg dev_std = 0.275)
NEC for r=0.6 all L1 = 0.172 +- 0.205 (in-sample avg dev_std = 0.275)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.544
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.541
NEC for r=0.9 class 0 = 0.137 +- 0.153 (in-sample avg dev_std = 0.203)
NEC for r=0.9 class 1 = 0.118 +- 0.153 (in-sample avg dev_std = 0.203)
NEC for r=0.9 class 2 = 0.157 +- 0.153 (in-sample avg dev_std = 0.203)
NEC for r=0.9 all KL = 0.093 +- 0.153 (in-sample avg dev_std = 0.203)
NEC for r=0.9 all L1 = 0.133 +- 0.173 (in-sample avg dev_std = 0.203)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.543
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.541
NEC for r=1.0 class 0 = 0.124 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=1.0 class 1 = 0.114 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=1.0 class 2 = 0.148 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=1.0 all KL = 0.087 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=1.0 all L1 = 0.125 +- 0.172 (in-sample avg dev_std = 0.204)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:49:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:36 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:38 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:38 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:39 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:41 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 12:49:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0007
ID Validation ACCURACY: 0.7004
ID Validation Loss: 2.0560
ID Test ACCURACY: 0.6715
ID Test Loss: 2.3868
OOD Validation ACCURACY: 0.6331
OOD Validation Loss: 2.6110
OOD Test ACCURACY: 0.5518
OOD Test Loss: 3.4085

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0007
ID Validation ACCURACY: 0.7004
ID Validation Loss: 2.0560
ID Test ACCURACY: 0.6715
ID Test Loss: 2.3868
OOD Validation ACCURACY: 0.6331
OOD Validation Loss: 2.6110
OOD Test ACCURACY: 0.5518
OOD Test Loss: 3.4085

[0m[1;37mINFO[0m: [1mChartInfo 0.6715 0.5518 0.6715 0.5518 0.7004 0.6331[0mGOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.661
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.573
SUFF++ for r=0.3 class 0 = 0.59 +- 0.307 (in-sample avg dev_std = 0.666)
SUFF++ for r=0.3 class 1 = 0.682 +- 0.307 (in-sample avg dev_std = 0.666)
SUFF++ for r=0.3 class 2 = 0.576 +- 0.307 (in-sample avg dev_std = 0.666)
SUFF++ for r=0.3 all KL = 0.377 +- 0.307 (in-sample avg dev_std = 0.666)
SUFF++ for r=0.3 all L1 = 0.63 +- 0.212 (in-sample avg dev_std = 0.666)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.646
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.636
SUFF++ for r=0.6 class 0 = 0.785 +- 0.335 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 class 1 = 0.805 +- 0.335 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 class 2 = 0.725 +- 0.335 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 all KL = 0.647 +- 0.335 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 all L1 = 0.778 +- 0.229 (in-sample avg dev_std = 0.483)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.682
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.67
SUFF++ for r=0.9 class 0 = 0.894 +- 0.176 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 1 = 0.906 +- 0.176 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 2 = 0.887 +- 0.176 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all KL = 0.906 +- 0.176 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all L1 = 0.898 +- 0.158 (in-sample avg dev_std = 0.239)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.585
SUFF++ for r=0.3 class 0 = 0.642 +- 0.339 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.3 class 1 = 0.727 +- 0.339 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.3 class 2 = 0.618 +- 0.339 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.3 all KL = 0.467 +- 0.339 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.3 all L1 = 0.682 +- 0.232 (in-sample avg dev_std = 0.600)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.634
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.62
SUFF++ for r=0.6 class 0 = 0.823 +- 0.290 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 1 = 0.847 +- 0.290 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 2 = 0.759 +- 0.290 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 all KL = 0.758 +- 0.290 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 all L1 = 0.822 +- 0.214 (in-sample avg dev_std = 0.389)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.641
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.635
SUFF++ for r=0.9 class 0 = 0.89 +- 0.187 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 class 1 = 0.903 +- 0.187 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 class 2 = 0.861 +- 0.187 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 all KL = 0.911 +- 0.187 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 all L1 = 0.891 +- 0.171 (in-sample avg dev_std = 0.233)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.545
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.519
SUFF++ for r=0.3 class 0 = 0.666 +- 0.320 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 class 1 = 0.689 +- 0.320 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 class 2 = 0.641 +- 0.320 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 all KL = 0.443 +- 0.320 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 all L1 = 0.671 +- 0.222 (in-sample avg dev_std = 0.614)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.551
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.543
SUFF++ for r=0.6 class 0 = 0.821 +- 0.279 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 class 1 = 0.839 +- 0.279 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 class 2 = 0.788 +- 0.279 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 all KL = 0.763 +- 0.279 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 all L1 = 0.822 +- 0.203 (in-sample avg dev_std = 0.383)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.541
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.545
SUFF++ for r=0.9 class 0 = 0.872 +- 0.168 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 class 1 = 0.906 +- 0.168 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 class 2 = 0.859 +- 0.168 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 all KL = 0.913 +- 0.168 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 all L1 = 0.886 +- 0.165 (in-sample avg dev_std = 0.222)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.661
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.649
NEC for r=0.3 class 0 = 0.253 +- 0.306 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 1 = 0.165 +- 0.306 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 2 = 0.22 +- 0.306 (in-sample avg dev_std = 0.337)
NEC for r=0.3 all KL = 0.235 +- 0.306 (in-sample avg dev_std = 0.337)
NEC for r=0.3 all L1 = 0.202 +- 0.245 (in-sample avg dev_std = 0.337)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.646
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.648
NEC for r=0.6 class 0 = 0.164 +- 0.285 (in-sample avg dev_std = 0.328)
NEC for r=0.6 class 1 = 0.133 +- 0.285 (in-sample avg dev_std = 0.328)
NEC for r=0.6 class 2 = 0.188 +- 0.285 (in-sample avg dev_std = 0.328)
NEC for r=0.6 all KL = 0.183 +- 0.285 (in-sample avg dev_std = 0.328)
NEC for r=0.6 all L1 = 0.156 +- 0.223 (in-sample avg dev_std = 0.328)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.682
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.67
NEC for r=0.9 class 0 = 0.129 +- 0.216 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 1 = 0.11 +- 0.216 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 2 = 0.139 +- 0.216 (in-sample avg dev_std = 0.252)
NEC for r=0.9 all KL = 0.116 +- 0.216 (in-sample avg dev_std = 0.252)
NEC for r=0.9 all L1 = 0.123 +- 0.185 (in-sample avg dev_std = 0.252)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.701
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.67
NEC for r=1.0 class 0 = 0.121 +- 0.197 (in-sample avg dev_std = 0.240)
NEC for r=1.0 class 1 = 0.096 +- 0.197 (in-sample avg dev_std = 0.240)
NEC for r=1.0 class 2 = 0.136 +- 0.197 (in-sample avg dev_std = 0.240)
NEC for r=1.0 all KL = 0.098 +- 0.197 (in-sample avg dev_std = 0.240)
NEC for r=1.0 all L1 = 0.113 +- 0.178 (in-sample avg dev_std = 0.240)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.631
NEC for r=0.3 class 0 = 0.228 +- 0.310 (in-sample avg dev_std = 0.349)
NEC for r=0.3 class 1 = 0.168 +- 0.310 (in-sample avg dev_std = 0.349)
NEC for r=0.3 class 2 = 0.249 +- 0.310 (in-sample avg dev_std = 0.349)
NEC for r=0.3 all KL = 0.251 +- 0.310 (in-sample avg dev_std = 0.349)
NEC for r=0.3 all L1 = 0.201 +- 0.246 (in-sample avg dev_std = 0.349)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.634
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.628
NEC for r=0.6 class 0 = 0.167 +- 0.269 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 1 = 0.138 +- 0.269 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 2 = 0.198 +- 0.269 (in-sample avg dev_std = 0.305)
NEC for r=0.6 all KL = 0.18 +- 0.269 (in-sample avg dev_std = 0.305)
NEC for r=0.6 all L1 = 0.158 +- 0.225 (in-sample avg dev_std = 0.305)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.641
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.632
NEC for r=0.9 class 0 = 0.14 +- 0.207 (in-sample avg dev_std = 0.243)
NEC for r=0.9 class 1 = 0.116 +- 0.207 (in-sample avg dev_std = 0.243)
NEC for r=0.9 class 2 = 0.172 +- 0.207 (in-sample avg dev_std = 0.243)
NEC for r=0.9 all KL = 0.119 +- 0.207 (in-sample avg dev_std = 0.243)
NEC for r=0.9 all L1 = 0.134 +- 0.194 (in-sample avg dev_std = 0.243)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.644
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.642
NEC for r=1.0 class 0 = 0.127 +- 0.159 (in-sample avg dev_std = 0.196)
NEC for r=1.0 class 1 = 0.098 +- 0.159 (in-sample avg dev_std = 0.196)
NEC for r=1.0 class 2 = 0.147 +- 0.159 (in-sample avg dev_std = 0.196)
NEC for r=1.0 all KL = 0.085 +- 0.159 (in-sample avg dev_std = 0.196)
NEC for r=1.0 all L1 = 0.115 +- 0.167 (in-sample avg dev_std = 0.196)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.545
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.554
NEC for r=0.3 class 0 = 0.24 +- 0.318 (in-sample avg dev_std = 0.375)
NEC for r=0.3 class 1 = 0.173 +- 0.318 (in-sample avg dev_std = 0.375)
NEC for r=0.3 class 2 = 0.228 +- 0.318 (in-sample avg dev_std = 0.375)
NEC for r=0.3 all KL = 0.263 +- 0.318 (in-sample avg dev_std = 0.375)
NEC for r=0.3 all L1 = 0.204 +- 0.242 (in-sample avg dev_std = 0.375)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.55
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.542
NEC for r=0.6 class 0 = 0.193 +- 0.291 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 1 = 0.147 +- 0.291 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 2 = 0.204 +- 0.291 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all KL = 0.205 +- 0.291 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all L1 = 0.173 +- 0.226 (in-sample avg dev_std = 0.330)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.541
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.539
NEC for r=0.9 class 0 = 0.161 +- 0.191 (in-sample avg dev_std = 0.240)
NEC for r=0.9 class 1 = 0.122 +- 0.191 (in-sample avg dev_std = 0.240)
NEC for r=0.9 class 2 = 0.164 +- 0.191 (in-sample avg dev_std = 0.240)
NEC for r=0.9 all KL = 0.119 +- 0.191 (in-sample avg dev_std = 0.240)
NEC for r=0.9 all L1 = 0.142 +- 0.193 (in-sample avg dev_std = 0.240)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.546
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.542
NEC for r=1.0 class 0 = 0.148 +- 0.167 (in-sample avg dev_std = 0.213)
NEC for r=1.0 class 1 = 0.112 +- 0.167 (in-sample avg dev_std = 0.213)
NEC for r=1.0 class 2 = 0.152 +- 0.167 (in-sample avg dev_std = 0.213)
NEC for r=1.0 all KL = 0.097 +- 0.167 (in-sample avg dev_std = 0.213)
NEC for r=1.0 all L1 = 0.131 +- 0.176 (in-sample avg dev_std = 0.213)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:54:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:45 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:47 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:48 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:50 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 12:54:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 25...
[0m[1;37mINFO[0m: [1mCheckpoint 25: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0031
ID Validation ACCURACY: 0.7058
ID Validation Loss: 1.5079
ID Test ACCURACY: 0.6426
ID Test Loss: 1.8561
OOD Validation ACCURACY: 0.6101
OOD Validation Loss: 2.2219
OOD Test ACCURACY: 0.5333
OOD Test Loss: 3.4476

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 36...
[0m[1;37mINFO[0m: [1mCheckpoint 36: 
-----------------------------------
Train ACCURACY: 0.9981
Train Loss: 0.0050
ID Validation ACCURACY: 0.6733
ID Validation Loss: 1.7091
ID Test ACCURACY: 0.6552
ID Test Loss: 1.9976
OOD Validation ACCURACY: 0.6403
OOD Validation Loss: 2.0926
OOD Test ACCURACY: 0.5690
OOD Test Loss: 2.7705

[0m[1;37mINFO[0m: [1mChartInfo 0.6426 0.5333 0.6552 0.5690 0.6733 0.6403[0mGOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.611
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.577
SUFF++ for r=0.3 class 0 = 0.709 +- 0.279 (in-sample avg dev_std = 0.560)
SUFF++ for r=0.3 class 1 = 0.688 +- 0.279 (in-sample avg dev_std = 0.560)
SUFF++ for r=0.3 class 2 = 0.584 +- 0.279 (in-sample avg dev_std = 0.560)
SUFF++ for r=0.3 all KL = 0.556 +- 0.279 (in-sample avg dev_std = 0.560)
SUFF++ for r=0.3 all L1 = 0.664 +- 0.206 (in-sample avg dev_std = 0.560)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.668
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.626
SUFF++ for r=0.6 class 0 = 0.818 +- 0.258 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 class 1 = 0.803 +- 0.258 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 class 2 = 0.713 +- 0.258 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 all KL = 0.739 +- 0.258 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 all L1 = 0.782 +- 0.206 (in-sample avg dev_std = 0.414)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.695
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.676
SUFF++ for r=0.9 class 0 = 0.886 +- 0.168 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 class 1 = 0.886 +- 0.168 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 class 2 = 0.858 +- 0.168 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 all KL = 0.905 +- 0.168 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 all L1 = 0.878 +- 0.171 (in-sample avg dev_std = 0.246)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.576
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.534
SUFF++ for r=0.3 class 0 = 0.759 +- 0.300 (in-sample avg dev_std = 0.559)
SUFF++ for r=0.3 class 1 = 0.666 +- 0.300 (in-sample avg dev_std = 0.559)
SUFF++ for r=0.3 class 2 = 0.612 +- 0.300 (in-sample avg dev_std = 0.559)
SUFF++ for r=0.3 all KL = 0.561 +- 0.300 (in-sample avg dev_std = 0.559)
SUFF++ for r=0.3 all L1 = 0.678 +- 0.218 (in-sample avg dev_std = 0.559)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.584
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.567
SUFF++ for r=0.6 class 0 = 0.841 +- 0.260 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 1 = 0.794 +- 0.260 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 2 = 0.762 +- 0.260 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 all KL = 0.766 +- 0.260 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 all L1 = 0.799 +- 0.205 (in-sample avg dev_std = 0.397)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.596
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.595
SUFF++ for r=0.9 class 0 = 0.859 +- 0.184 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 1 = 0.872 +- 0.184 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 2 = 0.841 +- 0.184 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all KL = 0.896 +- 0.184 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all L1 = 0.862 +- 0.186 (in-sample avg dev_std = 0.252)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.455
SUFF++ for r=0.3 class 0 = 0.777 +- 0.320 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 class 1 = 0.676 +- 0.320 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 class 2 = 0.598 +- 0.320 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 all KL = 0.574 +- 0.320 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 all L1 = 0.683 +- 0.232 (in-sample avg dev_std = 0.551)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.509
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.49
SUFF++ for r=0.6 class 0 = 0.83 +- 0.260 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 1 = 0.799 +- 0.260 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 2 = 0.742 +- 0.260 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all KL = 0.759 +- 0.260 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all L1 = 0.793 +- 0.211 (in-sample avg dev_std = 0.396)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.533
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.516
SUFF++ for r=0.9 class 0 = 0.879 +- 0.177 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 class 1 = 0.862 +- 0.177 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 class 2 = 0.848 +- 0.177 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 all KL = 0.893 +- 0.177 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 all L1 = 0.863 +- 0.182 (in-sample avg dev_std = 0.259)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.611
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.624
NEC for r=0.3 class 0 = 0.215 +- 0.263 (in-sample avg dev_std = 0.316)
NEC for r=0.3 class 1 = 0.187 +- 0.263 (in-sample avg dev_std = 0.316)
NEC for r=0.3 class 2 = 0.285 +- 0.263 (in-sample avg dev_std = 0.316)
NEC for r=0.3 all KL = 0.21 +- 0.263 (in-sample avg dev_std = 0.316)
NEC for r=0.3 all L1 = 0.221 +- 0.226 (in-sample avg dev_std = 0.316)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.668
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.643
NEC for r=0.6 class 0 = 0.159 +- 0.241 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 1 = 0.164 +- 0.241 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 2 = 0.219 +- 0.241 (in-sample avg dev_std = 0.298)
NEC for r=0.6 all KL = 0.171 +- 0.241 (in-sample avg dev_std = 0.298)
NEC for r=0.6 all L1 = 0.178 +- 0.213 (in-sample avg dev_std = 0.298)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.695
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.675
NEC for r=0.9 class 0 = 0.145 +- 0.184 (in-sample avg dev_std = 0.260)
NEC for r=0.9 class 1 = 0.129 +- 0.184 (in-sample avg dev_std = 0.260)
NEC for r=0.9 class 2 = 0.153 +- 0.184 (in-sample avg dev_std = 0.260)
NEC for r=0.9 all KL = 0.112 +- 0.184 (in-sample avg dev_std = 0.260)
NEC for r=0.9 all L1 = 0.14 +- 0.184 (in-sample avg dev_std = 0.260)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.704
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.683
NEC for r=1.0 class 0 = 0.154 +- 0.185 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 1 = 0.117 +- 0.185 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 2 = 0.15 +- 0.185 (in-sample avg dev_std = 0.246)
NEC for r=1.0 all KL = 0.104 +- 0.185 (in-sample avg dev_std = 0.246)
NEC for r=1.0 all L1 = 0.135 +- 0.181 (in-sample avg dev_std = 0.246)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.576
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.574
NEC for r=0.3 class 0 = 0.202 +- 0.293 (in-sample avg dev_std = 0.368)
NEC for r=0.3 class 1 = 0.244 +- 0.293 (in-sample avg dev_std = 0.368)
NEC for r=0.3 class 2 = 0.281 +- 0.293 (in-sample avg dev_std = 0.368)
NEC for r=0.3 all KL = 0.266 +- 0.293 (in-sample avg dev_std = 0.368)
NEC for r=0.3 all L1 = 0.241 +- 0.239 (in-sample avg dev_std = 0.368)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.584
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.576
NEC for r=0.6 class 0 = 0.159 +- 0.256 (in-sample avg dev_std = 0.317)
NEC for r=0.6 class 1 = 0.193 +- 0.256 (in-sample avg dev_std = 0.317)
NEC for r=0.6 class 2 = 0.213 +- 0.256 (in-sample avg dev_std = 0.317)
NEC for r=0.6 all KL = 0.195 +- 0.256 (in-sample avg dev_std = 0.317)
NEC for r=0.6 all L1 = 0.188 +- 0.221 (in-sample avg dev_std = 0.317)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.596
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.59
NEC for r=0.9 class 0 = 0.151 +- 0.207 (in-sample avg dev_std = 0.266)
NEC for r=0.9 class 1 = 0.168 +- 0.207 (in-sample avg dev_std = 0.266)
NEC for r=0.9 class 2 = 0.182 +- 0.207 (in-sample avg dev_std = 0.266)
NEC for r=0.9 all KL = 0.14 +- 0.207 (in-sample avg dev_std = 0.266)
NEC for r=0.9 all L1 = 0.167 +- 0.208 (in-sample avg dev_std = 0.266)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.604
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.595
NEC for r=1.0 class 0 = 0.157 +- 0.191 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 1 = 0.15 +- 0.191 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 2 = 0.174 +- 0.191 (in-sample avg dev_std = 0.246)
NEC for r=1.0 all KL = 0.122 +- 0.191 (in-sample avg dev_std = 0.246)
NEC for r=1.0 all L1 = 0.157 +- 0.200 (in-sample avg dev_std = 0.246)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.5
NEC for r=0.3 class 0 = 0.192 +- 0.284 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 1 = 0.219 +- 0.284 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 2 = 0.27 +- 0.284 (in-sample avg dev_std = 0.350)
NEC for r=0.3 all KL = 0.247 +- 0.284 (in-sample avg dev_std = 0.350)
NEC for r=0.3 all L1 = 0.225 +- 0.233 (in-sample avg dev_std = 0.350)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.509
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.507
NEC for r=0.6 class 0 = 0.144 +- 0.241 (in-sample avg dev_std = 0.307)
NEC for r=0.6 class 1 = 0.169 +- 0.241 (in-sample avg dev_std = 0.307)
NEC for r=0.6 class 2 = 0.216 +- 0.241 (in-sample avg dev_std = 0.307)
NEC for r=0.6 all KL = 0.173 +- 0.241 (in-sample avg dev_std = 0.307)
NEC for r=0.6 all L1 = 0.174 +- 0.214 (in-sample avg dev_std = 0.307)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.533
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.522
NEC for r=0.9 class 0 = 0.143 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 1 = 0.149 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 2 = 0.187 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all KL = 0.131 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all L1 = 0.157 +- 0.199 (in-sample avg dev_std = 0.259)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.531
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.523
NEC for r=1.0 class 0 = 0.136 +- 0.198 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 1 = 0.147 +- 0.198 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 2 = 0.178 +- 0.198 (in-sample avg dev_std = 0.246)
NEC for r=1.0 all KL = 0.124 +- 0.198 (in-sample avg dev_std = 0.246)
NEC for r=1.0 all L1 = 0.152 +- 0.197 (in-sample avg dev_std = 0.246)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:59:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/22/2024 12:59:54 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 12:59:56 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 12:59:56 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 12:59:57 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 12:59:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 01:00:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0013
ID Validation ACCURACY: 0.7004
ID Validation Loss: 1.8103
ID Test ACCURACY: 0.6444
ID Test Loss: 2.1469
OOD Validation ACCURACY: 0.6280
OOD Validation Loss: 2.2065
OOD Test ACCURACY: 0.5436
OOD Test Loss: 2.9759

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 0.6877
ID Validation Loss: 2.1026
ID Test ACCURACY: 0.6101
ID Test Loss: 2.4334
OOD Validation ACCURACY: 0.6336
OOD Validation Loss: 2.6554
OOD Test ACCURACY: 0.5642
OOD Test Loss: 3.4042

[0m[1;37mINFO[0m: [1mChartInfo 0.6444 0.5436 0.6101 0.5642 0.6877 0.6336[0mGOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.659
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.577
SUFF++ for r=0.3 class 0 = 0.57 +- 0.308 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 class 1 = 0.743 +- 0.308 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 class 2 = 0.622 +- 0.308 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 all KL = 0.503 +- 0.308 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 all L1 = 0.667 +- 0.224 (in-sample avg dev_std = 0.584)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.695
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.636
SUFF++ for r=0.6 class 0 = 0.704 +- 0.294 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 class 1 = 0.812 +- 0.294 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 class 2 = 0.774 +- 0.294 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 all KL = 0.675 +- 0.294 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 all L1 = 0.775 +- 0.211 (in-sample avg dev_std = 0.463)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.7
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.679
SUFF++ for r=0.9 class 0 = 0.861 +- 0.147 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 1 = 0.907 +- 0.147 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 2 = 0.897 +- 0.147 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 all KL = 0.915 +- 0.147 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 all L1 = 0.893 +- 0.156 (in-sample avg dev_std = 0.230)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.624
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.568
SUFF++ for r=0.3 class 0 = 0.587 +- 0.296 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 class 1 = 0.699 +- 0.296 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 class 2 = 0.622 +- 0.296 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 all KL = 0.49 +- 0.296 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 all L1 = 0.655 +- 0.219 (in-sample avg dev_std = 0.584)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.596
SUFF++ for r=0.6 class 0 = 0.782 +- 0.274 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 1 = 0.769 +- 0.274 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 2 = 0.753 +- 0.274 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 all KL = 0.705 +- 0.274 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 all L1 = 0.769 +- 0.211 (in-sample avg dev_std = 0.428)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.626
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.618
SUFF++ for r=0.9 class 0 = 0.873 +- 0.181 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.9 class 1 = 0.873 +- 0.181 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.9 class 2 = 0.853 +- 0.181 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.9 all KL = 0.901 +- 0.181 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.9 all L1 = 0.869 +- 0.177 (in-sample avg dev_std = 0.235)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.556
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.498
SUFF++ for r=0.3 class 0 = 0.604 +- 0.260 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.3 class 1 = 0.631 +- 0.260 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.3 class 2 = 0.58 +- 0.260 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.3 all KL = 0.432 +- 0.260 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.3 all L1 = 0.611 +- 0.197 (in-sample avg dev_std = 0.621)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.545
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.52
SUFF++ for r=0.6 class 0 = 0.765 +- 0.256 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 1 = 0.748 +- 0.256 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 2 = 0.727 +- 0.256 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all KL = 0.69 +- 0.256 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all L1 = 0.747 +- 0.204 (in-sample avg dev_std = 0.433)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.556
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.54
SUFF++ for r=0.9 class 0 = 0.867 +- 0.168 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 1 = 0.849 +- 0.168 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 2 = 0.844 +- 0.168 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 all KL = 0.892 +- 0.168 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 all L1 = 0.852 +- 0.180 (in-sample avg dev_std = 0.255)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.659
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.638
NEC for r=0.3 class 0 = 0.281 +- 0.261 (in-sample avg dev_std = 0.291)
NEC for r=0.3 class 1 = 0.134 +- 0.261 (in-sample avg dev_std = 0.291)
NEC for r=0.3 class 2 = 0.202 +- 0.261 (in-sample avg dev_std = 0.291)
NEC for r=0.3 all KL = 0.185 +- 0.261 (in-sample avg dev_std = 0.291)
NEC for r=0.3 all L1 = 0.189 +- 0.230 (in-sample avg dev_std = 0.291)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.695
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.664
NEC for r=0.6 class 0 = 0.23 +- 0.247 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 1 = 0.125 +- 0.247 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 2 = 0.164 +- 0.247 (in-sample avg dev_std = 0.295)
NEC for r=0.6 all KL = 0.164 +- 0.247 (in-sample avg dev_std = 0.295)
NEC for r=0.6 all L1 = 0.162 +- 0.217 (in-sample avg dev_std = 0.295)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.701
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.68
NEC for r=0.9 class 0 = 0.173 +- 0.200 (in-sample avg dev_std = 0.247)
NEC for r=0.9 class 1 = 0.109 +- 0.200 (in-sample avg dev_std = 0.247)
NEC for r=0.9 class 2 = 0.13 +- 0.200 (in-sample avg dev_std = 0.247)
NEC for r=0.9 all KL = 0.116 +- 0.200 (in-sample avg dev_std = 0.247)
NEC for r=0.9 all L1 = 0.13 +- 0.187 (in-sample avg dev_std = 0.247)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.697
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.679
NEC for r=1.0 class 0 = 0.14 +- 0.166 (in-sample avg dev_std = 0.209)
NEC for r=1.0 class 1 = 0.099 +- 0.166 (in-sample avg dev_std = 0.209)
NEC for r=1.0 class 2 = 0.118 +- 0.166 (in-sample avg dev_std = 0.209)
NEC for r=1.0 all KL = 0.088 +- 0.166 (in-sample avg dev_std = 0.209)
NEC for r=1.0 all L1 = 0.114 +- 0.168 (in-sample avg dev_std = 0.209)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.624
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.613
NEC for r=0.3 class 0 = 0.295 +- 0.293 (in-sample avg dev_std = 0.352)
NEC for r=0.3 class 1 = 0.198 +- 0.293 (in-sample avg dev_std = 0.352)
NEC for r=0.3 class 2 = 0.235 +- 0.293 (in-sample avg dev_std = 0.352)
NEC for r=0.3 all KL = 0.248 +- 0.293 (in-sample avg dev_std = 0.352)
NEC for r=0.3 all L1 = 0.23 +- 0.246 (in-sample avg dev_std = 0.352)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.616
NEC for r=0.6 class 0 = 0.205 +- 0.281 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 1 = 0.198 +- 0.281 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 2 = 0.213 +- 0.281 (in-sample avg dev_std = 0.331)
NEC for r=0.6 all KL = 0.213 +- 0.281 (in-sample avg dev_std = 0.331)
NEC for r=0.6 all L1 = 0.203 +- 0.238 (in-sample avg dev_std = 0.331)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.626
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.615
NEC for r=0.9 class 0 = 0.146 +- 0.217 (in-sample avg dev_std = 0.258)
NEC for r=0.9 class 1 = 0.163 +- 0.217 (in-sample avg dev_std = 0.258)
NEC for r=0.9 class 2 = 0.183 +- 0.217 (in-sample avg dev_std = 0.258)
NEC for r=0.9 all KL = 0.139 +- 0.217 (in-sample avg dev_std = 0.258)
NEC for r=0.9 all L1 = 0.163 +- 0.206 (in-sample avg dev_std = 0.258)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.626
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.614
NEC for r=1.0 class 0 = 0.136 +- 0.176 (in-sample avg dev_std = 0.224)
NEC for r=1.0 class 1 = 0.143 +- 0.176 (in-sample avg dev_std = 0.224)
NEC for r=1.0 class 2 = 0.165 +- 0.176 (in-sample avg dev_std = 0.224)
NEC for r=1.0 all KL = 0.106 +- 0.176 (in-sample avg dev_std = 0.224)
NEC for r=1.0 all L1 = 0.146 +- 0.186 (in-sample avg dev_std = 0.224)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.556
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.547
NEC for r=0.3 class 0 = 0.287 +- 0.278 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 1 = 0.218 +- 0.278 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 2 = 0.245 +- 0.278 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all KL = 0.252 +- 0.278 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all L1 = 0.243 +- 0.237 (in-sample avg dev_std = 0.364)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.545
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.537
NEC for r=0.6 class 0 = 0.207 +- 0.252 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 1 = 0.215 +- 0.252 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 2 = 0.21 +- 0.252 (in-sample avg dev_std = 0.331)
NEC for r=0.6 all KL = 0.213 +- 0.252 (in-sample avg dev_std = 0.331)
NEC for r=0.6 all L1 = 0.212 +- 0.218 (in-sample avg dev_std = 0.331)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.556
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.535
NEC for r=0.9 class 0 = 0.149 +- 0.211 (in-sample avg dev_std = 0.255)
NEC for r=0.9 class 1 = 0.19 +- 0.211 (in-sample avg dev_std = 0.255)
NEC for r=0.9 class 2 = 0.188 +- 0.211 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all KL = 0.148 +- 0.211 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all L1 = 0.179 +- 0.211 (in-sample avg dev_std = 0.255)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.538
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.54
NEC for r=1.0 class 0 = 0.132 +- 0.174 (in-sample avg dev_std = 0.229)
NEC for r=1.0 class 1 = 0.155 +- 0.174 (in-sample avg dev_std = 0.229)
NEC for r=1.0 class 2 = 0.177 +- 0.174 (in-sample avg dev_std = 0.229)
NEC for r=1.0 all KL = 0.109 +- 0.174 (in-sample avg dev_std = 0.229)
NEC for r=1.0 all L1 = 0.154 +- 0.188 (in-sample avg dev_std = 0.229)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 13:04:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:49 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:50 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:51 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:51 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:53 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 01:04:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 5...
[0m[1;37mINFO[0m: [1mCheckpoint 5: 
-----------------------------------
Train ACCURACY: 0.9208
Train Loss: 0.2372
ID Validation ACCURACY: 0.6949
ID Validation Loss: 0.8254
ID Test ACCURACY: 0.6480
ID Test Loss: 0.9897
OOD Validation ACCURACY: 0.6174
OOD Validation Loss: 1.2560
OOD Test ACCURACY: 0.5669
OOD Test Loss: 1.6424

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 0.6823
ID Validation Loss: 2.1377
ID Test ACCURACY: 0.6588
ID Test Loss: 2.5118
OOD Validation ACCURACY: 0.6336
OOD Validation Loss: 2.6032
OOD Test ACCURACY: 0.5745
OOD Test Loss: 3.2801

[0m[1;37mINFO[0m: [1mChartInfo 0.6480 0.5669 0.6588 0.5745 0.6823 0.6336[0mGOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.584
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.56
SUFF++ for r=0.3 class 0 = 0.7 +- 0.117 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 class 1 = 0.801 +- 0.117 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 class 2 = 0.722 +- 0.117 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 all KL = 0.884 +- 0.117 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 all L1 = 0.754 +- 0.128 (in-sample avg dev_std = 0.263)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.646
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.619
SUFF++ for r=0.6 class 0 = 0.697 +- 0.125 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 1 = 0.799 +- 0.125 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 2 = 0.738 +- 0.125 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 all KL = 0.873 +- 0.125 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 all L1 = 0.757 +- 0.127 (in-sample avg dev_std = 0.263)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.686
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.687
SUFF++ for r=0.9 class 0 = 0.837 +- 0.059 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 class 1 = 0.871 +- 0.059 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 class 2 = 0.862 +- 0.059 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 all KL = 0.95 +- 0.059 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 all L1 = 0.86 +- 0.103 (in-sample avg dev_std = 0.172)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.592
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.581
SUFF++ for r=0.3 class 0 = 0.688 +- 0.127 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 1 = 0.748 +- 0.127 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 2 = 0.708 +- 0.127 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 all KL = 0.854 +- 0.127 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 all L1 = 0.724 +- 0.127 (in-sample avg dev_std = 0.289)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.596
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.583
SUFF++ for r=0.6 class 0 = 0.704 +- 0.119 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 class 1 = 0.74 +- 0.119 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 class 2 = 0.728 +- 0.119 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 all KL = 0.847 +- 0.119 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 all L1 = 0.728 +- 0.133 (in-sample avg dev_std = 0.296)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.598
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.595
SUFF++ for r=0.9 class 0 = 0.809 +- 0.083 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.9 class 1 = 0.837 +- 0.083 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.9 class 2 = 0.833 +- 0.083 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.9 all KL = 0.936 +- 0.083 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.9 all L1 = 0.829 +- 0.128 (in-sample avg dev_std = 0.165)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.562
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.525
SUFF++ for r=0.3 class 0 = 0.666 +- 0.124 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 1 = 0.714 +- 0.124 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 2 = 0.673 +- 0.124 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 all KL = 0.826 +- 0.124 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 all L1 = 0.692 +- 0.118 (in-sample avg dev_std = 0.316)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.555
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.535
SUFF++ for r=0.6 class 0 = 0.699 +- 0.132 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.6 class 1 = 0.71 +- 0.132 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.6 class 2 = 0.69 +- 0.132 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.6 all KL = 0.819 +- 0.132 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.6 all L1 = 0.702 +- 0.142 (in-sample avg dev_std = 0.319)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.566
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.558
SUFF++ for r=0.9 class 0 = 0.82 +- 0.104 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 class 1 = 0.805 +- 0.104 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 class 2 = 0.812 +- 0.104 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all KL = 0.919 +- 0.104 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all L1 = 0.81 +- 0.146 (in-sample avg dev_std = 0.189)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.584
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.579
NEC for r=0.3 class 0 = 0.251 +- 0.084 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 1 = 0.153 +- 0.084 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 2 = 0.202 +- 0.084 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all KL = 0.064 +- 0.084 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all L1 = 0.19 +- 0.127 (in-sample avg dev_std = 0.157)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.646
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.638
NEC for r=0.6 class 0 = 0.238 +- 0.090 (in-sample avg dev_std = 0.167)
NEC for r=0.6 class 1 = 0.155 +- 0.090 (in-sample avg dev_std = 0.167)
NEC for r=0.6 class 2 = 0.192 +- 0.090 (in-sample avg dev_std = 0.167)
NEC for r=0.6 all KL = 0.069 +- 0.090 (in-sample avg dev_std = 0.167)
NEC for r=0.6 all L1 = 0.185 +- 0.127 (in-sample avg dev_std = 0.167)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.688
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.682
NEC for r=0.9 class 0 = 0.174 +- 0.077 (in-sample avg dev_std = 0.141)
NEC for r=0.9 class 1 = 0.13 +- 0.077 (in-sample avg dev_std = 0.141)
NEC for r=0.9 class 2 = 0.158 +- 0.077 (in-sample avg dev_std = 0.141)
NEC for r=0.9 all KL = 0.051 +- 0.077 (in-sample avg dev_std = 0.141)
NEC for r=0.9 all L1 = 0.148 +- 0.120 (in-sample avg dev_std = 0.141)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.692
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.684
NEC for r=1.0 class 0 = 0.144 +- 0.081 (in-sample avg dev_std = 0.142)
NEC for r=1.0 class 1 = 0.118 +- 0.081 (in-sample avg dev_std = 0.142)
NEC for r=1.0 class 2 = 0.135 +- 0.081 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all KL = 0.045 +- 0.081 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all L1 = 0.129 +- 0.115 (in-sample avg dev_std = 0.142)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.592
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.597
NEC for r=0.3 class 0 = 0.264 +- 0.104 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 1 = 0.196 +- 0.104 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 2 = 0.241 +- 0.104 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all KL = 0.09 +- 0.104 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all L1 = 0.223 +- 0.133 (in-sample avg dev_std = 0.181)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.596
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.605
NEC for r=0.6 class 0 = 0.241 +- 0.097 (in-sample avg dev_std = 0.182)
NEC for r=0.6 class 1 = 0.191 +- 0.097 (in-sample avg dev_std = 0.182)
NEC for r=0.6 class 2 = 0.212 +- 0.097 (in-sample avg dev_std = 0.182)
NEC for r=0.6 all KL = 0.086 +- 0.097 (in-sample avg dev_std = 0.182)
NEC for r=0.6 all L1 = 0.208 +- 0.136 (in-sample avg dev_std = 0.182)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.598
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.594
NEC for r=0.9 class 0 = 0.203 +- 0.090 (in-sample avg dev_std = 0.166)
NEC for r=0.9 class 1 = 0.172 +- 0.090 (in-sample avg dev_std = 0.166)
NEC for r=0.9 class 2 = 0.174 +- 0.090 (in-sample avg dev_std = 0.166)
NEC for r=0.9 all KL = 0.072 +- 0.090 (in-sample avg dev_std = 0.166)
NEC for r=0.9 all L1 = 0.181 +- 0.138 (in-sample avg dev_std = 0.166)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.613
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.592
NEC for r=1.0 class 0 = 0.19 +- 0.094 (in-sample avg dev_std = 0.168)
NEC for r=1.0 class 1 = 0.162 +- 0.094 (in-sample avg dev_std = 0.168)
NEC for r=1.0 class 2 = 0.155 +- 0.094 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all KL = 0.069 +- 0.094 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all L1 = 0.168 +- 0.140 (in-sample avg dev_std = 0.168)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.562
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.561
NEC for r=0.3 class 0 = 0.262 +- 0.106 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 1 = 0.222 +- 0.106 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 2 = 0.255 +- 0.106 (in-sample avg dev_std = 0.198)
NEC for r=0.3 all KL = 0.1 +- 0.106 (in-sample avg dev_std = 0.198)
NEC for r=0.3 all L1 = 0.241 +- 0.133 (in-sample avg dev_std = 0.198)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.555
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.562
NEC for r=0.6 class 0 = 0.23 +- 0.111 (in-sample avg dev_std = 0.204)
NEC for r=0.6 class 1 = 0.218 +- 0.111 (in-sample avg dev_std = 0.204)
NEC for r=0.6 class 2 = 0.239 +- 0.111 (in-sample avg dev_std = 0.204)
NEC for r=0.6 all KL = 0.101 +- 0.111 (in-sample avg dev_std = 0.204)
NEC for r=0.6 all L1 = 0.226 +- 0.148 (in-sample avg dev_std = 0.204)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.566
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.563
NEC for r=0.9 class 0 = 0.192 +- 0.108 (in-sample avg dev_std = 0.184)
NEC for r=0.9 class 1 = 0.196 +- 0.108 (in-sample avg dev_std = 0.184)
NEC for r=0.9 class 2 = 0.187 +- 0.108 (in-sample avg dev_std = 0.184)
NEC for r=0.9 all KL = 0.086 +- 0.108 (in-sample avg dev_std = 0.184)
NEC for r=0.9 all L1 = 0.193 +- 0.150 (in-sample avg dev_std = 0.184)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.574
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.57
NEC for r=1.0 class 0 = 0.172 +- 0.102 (in-sample avg dev_std = 0.173)
NEC for r=1.0 class 1 = 0.176 +- 0.102 (in-sample avg dev_std = 0.173)
NEC for r=1.0 class 2 = 0.173 +- 0.102 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all KL = 0.075 +- 0.102 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all L1 = 0.174 +- 0.146 (in-sample avg dev_std = 0.173)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.6, 0.74, 0.917, 1.0], 'all_L1': [0.676, 0.777, 0.889, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.377, 0.647, 0.906, 1.0], 'all_L1': [0.63, 0.778, 0.898, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.556, 0.739, 0.905, 1.0], 'all_L1': [0.664, 0.782, 0.878, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.503, 0.675, 0.915, 1.0], 'all_L1': [0.667, 0.775, 0.893, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.884, 0.873, 0.95, 1.0], 'all_L1': [0.754, 0.757, 0.86, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.2, 0.137, 0.093, 0.083], 'all_L1': [0.229, 0.166, 0.123, 0.117]}), defaultdict(<class 'list'>, {'all_KL': [0.235, 0.183, 0.116, 0.098], 'all_L1': [0.202, 0.156, 0.123, 0.113]}), defaultdict(<class 'list'>, {'all_KL': [0.21, 0.171, 0.112, 0.104], 'all_L1': [0.221, 0.178, 0.14, 0.135]}), defaultdict(<class 'list'>, {'all_KL': [0.185, 0.164, 0.116, 0.088], 'all_L1': [0.189, 0.162, 0.13, 0.114]}), defaultdict(<class 'list'>, {'all_KL': [0.064, 0.069, 0.051, 0.045], 'all_L1': [0.19, 0.185, 0.148, 0.129]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.646, 0.782, 0.917, 1.0], 'all_L1': [0.71, 0.793, 0.874, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.467, 0.758, 0.911, 1.0], 'all_L1': [0.682, 0.822, 0.891, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.561, 0.766, 0.896, 1.0], 'all_L1': [0.678, 0.799, 0.862, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.49, 0.705, 0.901, 1.0], 'all_L1': [0.655, 0.769, 0.869, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.854, 0.847, 0.936, 1.0], 'all_L1': [0.724, 0.728, 0.829, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.22, 0.158, 0.104, 0.097], 'all_L1': [0.229, 0.183, 0.145, 0.14]}), defaultdict(<class 'list'>, {'all_KL': [0.251, 0.18, 0.119, 0.085], 'all_L1': [0.201, 0.158, 0.134, 0.115]}), defaultdict(<class 'list'>, {'all_KL': [0.266, 0.195, 0.14, 0.122], 'all_L1': [0.241, 0.188, 0.167, 0.157]}), defaultdict(<class 'list'>, {'all_KL': [0.248, 0.213, 0.139, 0.106], 'all_L1': [0.23, 0.203, 0.163, 0.146]}), defaultdict(<class 'list'>, {'all_KL': [0.09, 0.086, 0.072, 0.069], 'all_L1': [0.223, 0.208, 0.181, 0.168]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.629, 0.775, 0.928, 1.0], 'all_L1': [0.697, 0.79, 0.886, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.443, 0.763, 0.913, 1.0], 'all_L1': [0.671, 0.822, 0.886, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.574, 0.759, 0.893, 1.0], 'all_L1': [0.683, 0.793, 0.863, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.432, 0.69, 0.892, 1.0], 'all_L1': [0.611, 0.747, 0.852, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.826, 0.819, 0.919, 1.0], 'all_L1': [0.692, 0.702, 0.81, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.211, 0.145, 0.093, 0.087], 'all_L1': [0.223, 0.172, 0.133, 0.125]}), defaultdict(<class 'list'>, {'all_KL': [0.263, 0.205, 0.119, 0.097], 'all_L1': [0.204, 0.173, 0.142, 0.131]}), defaultdict(<class 'list'>, {'all_KL': [0.247, 0.173, 0.131, 0.124], 'all_L1': [0.225, 0.174, 0.157, 0.152]}), defaultdict(<class 'list'>, {'all_KL': [0.252, 0.213, 0.148, 0.109], 'all_L1': [0.243, 0.212, 0.179, 0.154]}), defaultdict(<class 'list'>, {'all_KL': [0.1, 0.101, 0.086, 0.075], 'all_L1': [0.241, 0.226, 0.193, 0.174]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.678 +- 0.041, 0.774 +- 0.009, 0.884 +- 0.014, 1.000 +- 0.000
suff++ class all_KL  =  0.584 +- 0.168, 0.735 +- 0.078, 0.919 +- 0.016, 1.000 +- 0.000
suff++_acc_int  =  0.567 +- 0.012, 0.627 +- 0.008, 0.677 +- 0.006
nec class all_L1  =  0.206 +- 0.016, 0.169 +- 0.011, 0.133 +- 0.010, 0.122 +- 0.009
nec class all_KL  =  0.179 +- 0.060, 0.145 +- 0.041, 0.098 +- 0.025, 0.084 +- 0.021
nec_acc_int  =  0.620 +- 0.024, 0.646 +- 0.010, 0.676 +- 0.004, 0.678 +- 0.006

Eval split val
suff++ class all_L1  =  0.690 +- 0.024, 0.782 +- 0.032, 0.865 +- 0.020, 1.000 +- 0.000
suff++ class all_KL  =  0.604 +- 0.140, 0.772 +- 0.046, 0.912 +- 0.014, 1.000 +- 0.000
suff++_acc_int  =  0.566 +- 0.018, 0.590 +- 0.017, 0.609 +- 0.016
nec class all_L1  =  0.225 +- 0.013, 0.188 +- 0.018, 0.158 +- 0.017, 0.145 +- 0.018
nec class all_KL  =  0.215 +- 0.064, 0.166 +- 0.044, 0.115 +- 0.025, 0.096 +- 0.018
nec_acc_int  =  0.601 +- 0.020, 0.606 +- 0.017, 0.609 +- 0.015, 0.610 +- 0.018

Eval split test
suff++ class all_L1  =  0.671 +- 0.031, 0.771 +- 0.042, 0.859 +- 0.028, 1.000 +- 0.000
suff++ class all_KL  =  0.581 +- 0.144, 0.761 +- 0.041, 0.909 +- 0.014, 1.000 +- 0.000
suff++_acc_int  =  0.502 +- 0.026, 0.523 +- 0.018, 0.540 +- 0.013
nec class all_L1  =  0.227 +- 0.014, 0.191 +- 0.023, 0.161 +- 0.022, 0.147 +- 0.018
nec class all_KL  =  0.215 +- 0.060, 0.167 +- 0.041, 0.115 +- 0.023, 0.098 +- 0.017
nec_acc_int  =  0.538 +- 0.022, 0.536 +- 0.018, 0.540 +- 0.013, 0.543 +- 0.015


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.442 +- 0.019, 0.472 +- 0.005, 0.508 +- 0.003, 0.561 +- 0.004
Faith. Armon (L1)= 		  =  0.316 +- 0.018, 0.278 +- 0.014, 0.231 +- 0.014, 0.217 +- 0.014
Faith. GMean (L1)= 	  =  0.373 +- 0.015, 0.362 +- 0.010, 0.342 +- 0.010, 0.348 +- 0.013
Faith. Aritm (KL)= 		  =  0.381 +- 0.057, 0.440 +- 0.021, 0.508 +- 0.005, 0.542 +- 0.010
Faith. Armon (KL)= 		  =  0.257 +- 0.070, 0.237 +- 0.058, 0.175 +- 0.042, 0.154 +- 0.036
Faith. GMean (KL)= 	  =  0.306 +- 0.039, 0.319 +- 0.039, 0.296 +- 0.040, 0.286 +- 0.039

Eval split val
Faith. Aritm (L1)= 		  =  0.457 +- 0.013, 0.485 +- 0.009, 0.512 +- 0.004, 0.573 +- 0.009
Faith. Armon (L1)= 		  =  0.339 +- 0.015, 0.302 +- 0.021, 0.267 +- 0.023, 0.253 +- 0.027
Faith. GMean (L1)= 	  =  0.394 +- 0.013, 0.383 +- 0.012, 0.369 +- 0.016, 0.380 +- 0.024
Faith. Aritm (KL)= 		  =  0.409 +- 0.042, 0.469 +- 0.007, 0.513 +- 0.006, 0.548 +- 0.009
Faith. Armon (KL)= 		  =  0.302 +- 0.071, 0.270 +- 0.061, 0.203 +- 0.040, 0.174 +- 0.030
Faith. GMean (KL)= 	  =  0.346 +- 0.038, 0.353 +- 0.044, 0.321 +- 0.035, 0.308 +- 0.029

Eval split test
Faith. Aritm (L1)= 		  =  0.449 +- 0.015, 0.481 +- 0.011, 0.510 +- 0.005, 0.574 +- 0.009
Faith. Armon (L1)= 		  =  0.339 +- 0.015, 0.305 +- 0.026, 0.270 +- 0.030, 0.256 +- 0.027
Faith. GMean (L1)= 	  =  0.390 +- 0.013, 0.383 +- 0.013, 0.370 +- 0.020, 0.383 +- 0.023
Faith. Aritm (KL)= 		  =  0.398 +- 0.045, 0.464 +- 0.011, 0.512 +- 0.006, 0.549 +- 0.009
Faith. Armon (KL)= 		  =  0.298 +- 0.061, 0.271 +- 0.054, 0.204 +- 0.036, 0.179 +- 0.028
Faith. GMean (KL)= 	  =  0.340 +- 0.031, 0.353 +- 0.038, 0.322 +- 0.030, 0.313 +- 0.027
Computed for split load_split = id



Completed in  0:25:06.344392  for GSATvGIN GOODTwitter/length



DONE GSAT GOODTwitter/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 13:10:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:12 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:25 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:27 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:29 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:33 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:39 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:39 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:10:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:10:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.735
WIoU for r=0.3 = 0.622
F1 for r=0.6 = 0.650
WIoU for r=0.6 = 0.535
F1 for r=0.9 = 0.517
WIoU for r=0.9 = 0.399
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.377
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.572
WIoU for r=0.3 = 0.441
F1 for r=0.6 = 0.360
WIoU for r=0.6 = 0.245
F1 for r=0.9 = 0.259
WIoU for r=0.9 = 0.171
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.156
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.320
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.180
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.075
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.068


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.488
Model XAI F1 of binarized graphs for r=0.3 =  0.73516875
Model XAI WIoU of binarized graphs for r=0.3 =  0.6216275
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.425
SUFF++ for r=0.3 class 0 = 0.48 +- 0.287 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 1 = 0.57 +- 0.287 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 2 = 0.567 +- 0.287 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 all KL = 0.55 +- 0.287 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 all L1 = 0.538 +- 0.160 (in-sample avg dev_std = 0.518)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.804
Model XAI F1 of binarized graphs for r=0.6 =  0.64967
Model XAI WIoU of binarized graphs for r=0.6 =  0.535
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.724
SUFF++ for r=0.6 class 0 = 0.614 +- 0.267 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 class 1 = 0.642 +- 0.267 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 class 2 = 0.72 +- 0.267 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 all KL = 0.68 +- 0.267 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 all L1 = 0.659 +- 0.208 (in-sample avg dev_std = 0.419)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.51719875
Model XAI WIoU of binarized graphs for r=0.9 =  0.3986675
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.882
SUFF++ for r=0.9 class 0 = 0.813 +- 0.172 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 1 = 0.864 +- 0.172 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 2 = 0.879 +- 0.172 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all KL = 0.895 +- 0.172 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all L1 = 0.851 +- 0.157 (in-sample avg dev_std = 0.228)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.765
Model XAI F1 of binarized graphs for r=0.3 =  0.5717
Model XAI WIoU of binarized graphs for r=0.3 =  0.44084874999999996
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.667
SUFF++ for r=0.3 class 0 = 0.565 +- 0.248 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.3 class 1 = 0.556 +- 0.248 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.3 class 2 = 0.638 +- 0.248 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.3 all KL = 0.637 +- 0.248 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.3 all L1 = 0.585 +- 0.168 (in-sample avg dev_std = 0.434)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.707
Model XAI F1 of binarized graphs for r=0.6 =  0.36016
Model XAI WIoU of binarized graphs for r=0.6 =  0.24480875000000002
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.699
SUFF++ for r=0.6 class 0 = 0.558 +- 0.230 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 class 1 = 0.637 +- 0.230 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 class 2 = 0.647 +- 0.230 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 all KL = 0.679 +- 0.230 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 all L1 = 0.613 +- 0.166 (in-sample avg dev_std = 0.387)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.2593275
Model XAI WIoU of binarized graphs for r=0.9 =  0.17061374999999998
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.84
SUFF++ for r=0.9 class 0 = 0.751 +- 0.110 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.9 class 1 = 0.792 +- 0.110 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.9 class 2 = 0.791 +- 0.110 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.9 all KL = 0.9 +- 0.110 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.9 all L1 = 0.778 +- 0.136 (in-sample avg dev_std = 0.216)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.31953875
Model XAI WIoU of binarized graphs for r=0.3 =  0.20429250000000004
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.548
SUFF++ for r=0.3 class 0 = 0.587 +- 0.154 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.3 class 1 = 0.606 +- 0.154 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.3 class 2 = 0.643 +- 0.154 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.3 all KL = 0.758 +- 0.154 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.3 all L1 = 0.611 +- 0.126 (in-sample avg dev_std = 0.359)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.17980000000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.10896999999999998
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.597
SUFF++ for r=0.6 class 0 = 0.597 +- 0.226 (in-sample avg dev_std = 0.368)
SUFF++ for r=0.6 class 1 = 0.65 +- 0.226 (in-sample avg dev_std = 0.368)
SUFF++ for r=0.6 class 2 = 0.594 +- 0.226 (in-sample avg dev_std = 0.368)
SUFF++ for r=0.6 all KL = 0.712 +- 0.226 (in-sample avg dev_std = 0.368)
SUFF++ for r=0.6 all L1 = 0.615 +- 0.132 (in-sample avg dev_std = 0.368)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.585
Model XAI F1 of binarized graphs for r=0.9 =  0.12446125000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07521749999999999
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.543
SUFF++ for r=0.9 class 0 = 0.762 +- 0.207 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 1 = 0.693 +- 0.207 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 2 = 0.721 +- 0.207 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all KL = 0.819 +- 0.207 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all L1 = 0.725 +- 0.153 (in-sample avg dev_std = 0.225)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.486
Model XAI F1 of binarized graphs for r=0.3 =  0.73516875
Model XAI WIoU of binarized graphs for r=0.3 =  0.6216275
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.573 +- 0.347 (in-sample avg dev_std = 0.357)
NEC for r=0.3 class 1 = 0.482 +- 0.347 (in-sample avg dev_std = 0.357)
NEC for r=0.3 class 2 = 0.555 +- 0.347 (in-sample avg dev_std = 0.357)
NEC for r=0.3 all KL = 0.504 +- 0.347 (in-sample avg dev_std = 0.357)
NEC for r=0.3 all L1 = 0.537 +- 0.211 (in-sample avg dev_std = 0.357)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.806
Model XAI F1 of binarized graphs for r=0.6 =  0.64967
Model XAI WIoU of binarized graphs for r=0.6 =  0.535
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.388
NEC for r=0.6 class 0 = 0.604 +- 0.284 (in-sample avg dev_std = 0.498)
NEC for r=0.6 class 1 = 0.543 +- 0.284 (in-sample avg dev_std = 0.498)
NEC for r=0.6 class 2 = 0.667 +- 0.284 (in-sample avg dev_std = 0.498)
NEC for r=0.6 all KL = 0.648 +- 0.284 (in-sample avg dev_std = 0.498)
NEC for r=0.6 all L1 = 0.605 +- 0.166 (in-sample avg dev_std = 0.498)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.919
Model XAI F1 of binarized graphs for r=0.9 =  0.51719875
Model XAI WIoU of binarized graphs for r=0.9 =  0.3986675
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.487
NEC for r=0.9 class 0 = 0.592 +- 0.247 (in-sample avg dev_std = 0.587)
NEC for r=0.9 class 1 = 0.506 +- 0.247 (in-sample avg dev_std = 0.587)
NEC for r=0.9 class 2 = 0.6 +- 0.247 (in-sample avg dev_std = 0.587)
NEC for r=0.9 all KL = 0.62 +- 0.247 (in-sample avg dev_std = 0.587)
NEC for r=0.9 all L1 = 0.567 +- 0.163 (in-sample avg dev_std = 0.587)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.3773075
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.528
NEC for r=1.0 class 0 = 0.571 +- 0.248 (in-sample avg dev_std = 0.622)
NEC for r=1.0 class 1 = 0.472 +- 0.248 (in-sample avg dev_std = 0.622)
NEC for r=1.0 class 2 = 0.59 +- 0.248 (in-sample avg dev_std = 0.622)
NEC for r=1.0 all KL = 0.622 +- 0.248 (in-sample avg dev_std = 0.622)
NEC for r=1.0 all L1 = 0.546 +- 0.174 (in-sample avg dev_std = 0.622)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.765
Model XAI F1 of binarized graphs for r=0.3 =  0.5717
Model XAI WIoU of binarized graphs for r=0.3 =  0.44084874999999996
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.338
NEC for r=0.3 class 0 = 0.6 +- 0.281 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 1 = 0.491 +- 0.281 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 2 = 0.629 +- 0.281 (in-sample avg dev_std = 0.306)
NEC for r=0.3 all KL = 0.542 +- 0.281 (in-sample avg dev_std = 0.306)
NEC for r=0.3 all L1 = 0.573 +- 0.155 (in-sample avg dev_std = 0.306)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.36016
Model XAI WIoU of binarized graphs for r=0.6 =  0.24480875000000002
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.415
NEC for r=0.6 class 0 = 0.535 +- 0.238 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 1 = 0.413 +- 0.238 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 2 = 0.571 +- 0.238 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all KL = 0.447 +- 0.238 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all L1 = 0.506 +- 0.157 (in-sample avg dev_std = 0.383)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  0.2593275
Model XAI WIoU of binarized graphs for r=0.9 =  0.17061374999999998
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.502
NEC for r=0.9 class 0 = 0.5 +- 0.206 (in-sample avg dev_std = 0.382)
NEC for r=0.9 class 1 = 0.385 +- 0.206 (in-sample avg dev_std = 0.382)
NEC for r=0.9 class 2 = 0.526 +- 0.206 (in-sample avg dev_std = 0.382)
NEC for r=0.9 all KL = 0.35 +- 0.206 (in-sample avg dev_std = 0.382)
NEC for r=0.9 all L1 = 0.47 +- 0.150 (in-sample avg dev_std = 0.382)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.923
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.15606124999999998
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.564
NEC for r=1.0 class 0 = 0.485 +- 0.186 (in-sample avg dev_std = 0.410)
NEC for r=1.0 class 1 = 0.422 +- 0.186 (in-sample avg dev_std = 0.410)
NEC for r=1.0 class 2 = 0.519 +- 0.186 (in-sample avg dev_std = 0.410)
NEC for r=1.0 all KL = 0.371 +- 0.186 (in-sample avg dev_std = 0.410)
NEC for r=1.0 all L1 = 0.475 +- 0.128 (in-sample avg dev_std = 0.410)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.608
Model XAI F1 of binarized graphs for r=0.3 =  0.31953875
Model XAI WIoU of binarized graphs for r=0.3 =  0.20429250000000004
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.336
NEC for r=0.3 class 0 = 0.458 +- 0.199 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 1 = 0.476 +- 0.199 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 2 = 0.495 +- 0.199 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all KL = 0.319 +- 0.199 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all L1 = 0.476 +- 0.153 (in-sample avg dev_std = 0.209)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.17980000000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.10896999999999998
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.406
NEC for r=0.6 class 0 = 0.388 +- 0.146 (in-sample avg dev_std = 0.257)
NEC for r=0.6 class 1 = 0.326 +- 0.146 (in-sample avg dev_std = 0.257)
NEC for r=0.6 class 2 = 0.428 +- 0.146 (in-sample avg dev_std = 0.257)
NEC for r=0.6 all KL = 0.237 +- 0.146 (in-sample avg dev_std = 0.257)
NEC for r=0.6 all L1 = 0.38 +- 0.143 (in-sample avg dev_std = 0.257)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.581
Model XAI F1 of binarized graphs for r=0.9 =  0.12446125000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07521749999999999
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.405
NEC for r=0.9 class 0 = 0.288 +- 0.208 (in-sample avg dev_std = 0.247)
NEC for r=0.9 class 1 = 0.339 +- 0.208 (in-sample avg dev_std = 0.247)
NEC for r=0.9 class 2 = 0.331 +- 0.208 (in-sample avg dev_std = 0.247)
NEC for r=0.9 all KL = 0.198 +- 0.208 (in-sample avg dev_std = 0.247)
NEC for r=0.9 all L1 = 0.319 +- 0.168 (in-sample avg dev_std = 0.247)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.501
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.06840625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.41
NEC for r=1.0 class 0 = 0.21 +- 0.212 (in-sample avg dev_std = 0.170)
NEC for r=1.0 class 1 = 0.261 +- 0.212 (in-sample avg dev_std = 0.170)
NEC for r=1.0 class 2 = 0.224 +- 0.212 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all KL = 0.138 +- 0.212 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all L1 = 0.232 +- 0.208 (in-sample avg dev_std = 0.170)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 13:17:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:28 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:40 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:44 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:48 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:54 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:54 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:17:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:17:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.716
WIoU for r=0.3 = 0.598
F1 for r=0.6 = 0.638
WIoU for r=0.6 = 0.516
F1 for r=0.9 = 0.513
WIoU for r=0.9 = 0.387
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.369
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.561
WIoU for r=0.3 = 0.429
F1 for r=0.6 = 0.355
WIoU for r=0.6 = 0.238
F1 for r=0.9 = 0.258
WIoU for r=0.9 = 0.167
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.153
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.316
WIoU for r=0.3 = 0.202
F1 for r=0.6 = 0.179
WIoU for r=0.6 = 0.108
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.075
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.068


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.499
Model XAI F1 of binarized graphs for r=0.3 =  0.7159125000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5977175
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.424
SUFF++ for r=0.3 class 0 = 0.509 +- 0.274 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 class 1 = 0.61 +- 0.274 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 class 2 = 0.574 +- 0.274 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 all KL = 0.602 +- 0.274 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 all L1 = 0.564 +- 0.172 (in-sample avg dev_std = 0.487)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.78
Model XAI F1 of binarized graphs for r=0.6 =  0.638355
Model XAI WIoU of binarized graphs for r=0.6 =  0.5160575000000001
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.686
SUFF++ for r=0.6 class 0 = 0.581 +- 0.240 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.6 class 1 = 0.625 +- 0.240 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.6 class 2 = 0.728 +- 0.240 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.6 all KL = 0.7 +- 0.240 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.6 all L1 = 0.644 +- 0.194 (in-sample avg dev_std = 0.418)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.51302
Model XAI WIoU of binarized graphs for r=0.9 =  0.38695125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.832
SUFF++ for r=0.9 class 0 = 0.72 +- 0.184 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 1 = 0.802 +- 0.184 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 2 = 0.881 +- 0.184 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 all KL = 0.87 +- 0.184 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 all L1 = 0.801 +- 0.184 (in-sample avg dev_std = 0.245)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.721
Model XAI F1 of binarized graphs for r=0.3 =  0.56071375
Model XAI WIoU of binarized graphs for r=0.3 =  0.42914500000000005
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.67
SUFF++ for r=0.3 class 0 = 0.652 +- 0.221 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 1 = 0.625 +- 0.221 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 2 = 0.654 +- 0.221 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 all KL = 0.732 +- 0.221 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 all L1 = 0.644 +- 0.162 (in-sample avg dev_std = 0.395)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.739
Model XAI F1 of binarized graphs for r=0.6 =  0.35532874999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.2382025
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.728
SUFF++ for r=0.6 class 0 = 0.622 +- 0.217 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 class 1 = 0.631 +- 0.217 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 class 2 = 0.675 +- 0.217 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 all KL = 0.748 +- 0.217 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 all L1 = 0.642 +- 0.164 (in-sample avg dev_std = 0.348)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  0.25843499999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.16659500000000002
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.835
SUFF++ for r=0.9 class 0 = 0.755 +- 0.108 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 class 1 = 0.735 +- 0.108 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 class 2 = 0.793 +- 0.108 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 all KL = 0.893 +- 0.108 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 all L1 = 0.76 +- 0.149 (in-sample avg dev_std = 0.199)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.646
Model XAI F1 of binarized graphs for r=0.3 =  0.315925
Model XAI WIoU of binarized graphs for r=0.3 =  0.201755
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.605
SUFF++ for r=0.3 class 0 = 0.691 +- 0.117 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 class 1 = 0.674 +- 0.117 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 class 2 = 0.683 +- 0.117 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 all KL = 0.848 +- 0.117 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 all L1 = 0.683 +- 0.113 (in-sample avg dev_std = 0.266)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.647
Model XAI F1 of binarized graphs for r=0.6 =  0.17901249999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.10809875
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.596
SUFF++ for r=0.6 class 0 = 0.645 +- 0.207 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 1 = 0.648 +- 0.207 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 2 = 0.637 +- 0.207 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 all KL = 0.76 +- 0.207 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 all L1 = 0.643 +- 0.119 (in-sample avg dev_std = 0.385)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.554
Model XAI F1 of binarized graphs for r=0.9 =  0.12400375000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.0747075
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.515
SUFF++ for r=0.9 class 0 = 0.766 +- 0.088 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 class 1 = 0.739 +- 0.088 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 class 2 = 0.743 +- 0.088 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all KL = 0.896 +- 0.088 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all L1 = 0.749 +- 0.107 (in-sample avg dev_std = 0.197)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.498
Model XAI F1 of binarized graphs for r=0.3 =  0.7159125000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5977175
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.33
NEC for r=0.3 class 0 = 0.556 +- 0.338 (in-sample avg dev_std = 0.335)
NEC for r=0.3 class 1 = 0.42 +- 0.338 (in-sample avg dev_std = 0.335)
NEC for r=0.3 class 2 = 0.569 +- 0.338 (in-sample avg dev_std = 0.335)
NEC for r=0.3 all KL = 0.466 +- 0.338 (in-sample avg dev_std = 0.335)
NEC for r=0.3 all L1 = 0.517 +- 0.230 (in-sample avg dev_std = 0.335)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.777
Model XAI F1 of binarized graphs for r=0.6 =  0.638355
Model XAI WIoU of binarized graphs for r=0.6 =  0.5160575000000001
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.389
NEC for r=0.6 class 0 = 0.567 +- 0.279 (in-sample avg dev_std = 0.490)
NEC for r=0.6 class 1 = 0.502 +- 0.279 (in-sample avg dev_std = 0.490)
NEC for r=0.6 class 2 = 0.658 +- 0.279 (in-sample avg dev_std = 0.490)
NEC for r=0.6 all KL = 0.566 +- 0.279 (in-sample avg dev_std = 0.490)
NEC for r=0.6 all L1 = 0.577 +- 0.168 (in-sample avg dev_std = 0.490)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.51302
Model XAI WIoU of binarized graphs for r=0.9 =  0.38695125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.478
NEC for r=0.9 class 0 = 0.543 +- 0.257 (in-sample avg dev_std = 0.552)
NEC for r=0.9 class 1 = 0.517 +- 0.257 (in-sample avg dev_std = 0.552)
NEC for r=0.9 class 2 = 0.573 +- 0.257 (in-sample avg dev_std = 0.552)
NEC for r=0.9 all KL = 0.549 +- 0.257 (in-sample avg dev_std = 0.552)
NEC for r=0.9 all L1 = 0.545 +- 0.166 (in-sample avg dev_std = 0.552)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.933
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.36938125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.511
NEC for r=1.0 class 0 = 0.551 +- 0.260 (in-sample avg dev_std = 0.587)
NEC for r=1.0 class 1 = 0.487 +- 0.260 (in-sample avg dev_std = 0.587)
NEC for r=1.0 class 2 = 0.585 +- 0.260 (in-sample avg dev_std = 0.587)
NEC for r=1.0 all KL = 0.572 +- 0.260 (in-sample avg dev_std = 0.587)
NEC for r=1.0 all L1 = 0.542 +- 0.174 (in-sample avg dev_std = 0.587)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.56071375
Model XAI WIoU of binarized graphs for r=0.3 =  0.42914500000000005
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.351
NEC for r=0.3 class 0 = 0.47 +- 0.301 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 1 = 0.515 +- 0.301 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 2 = 0.649 +- 0.301 (in-sample avg dev_std = 0.289)
NEC for r=0.3 all KL = 0.472 +- 0.301 (in-sample avg dev_std = 0.289)
NEC for r=0.3 all L1 = 0.543 +- 0.184 (in-sample avg dev_std = 0.289)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.741
Model XAI F1 of binarized graphs for r=0.6 =  0.35532874999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.2382025
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.426
NEC for r=0.6 class 0 = 0.485 +- 0.226 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 1 = 0.45 +- 0.226 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 2 = 0.58 +- 0.226 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all KL = 0.407 +- 0.226 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all L1 = 0.504 +- 0.150 (in-sample avg dev_std = 0.390)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  0.25843499999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.16659500000000002
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.507
NEC for r=0.9 class 0 = 0.459 +- 0.179 (in-sample avg dev_std = 0.364)
NEC for r=0.9 class 1 = 0.439 +- 0.179 (in-sample avg dev_std = 0.364)
NEC for r=0.9 class 2 = 0.503 +- 0.179 (in-sample avg dev_std = 0.364)
NEC for r=0.9 all KL = 0.324 +- 0.179 (in-sample avg dev_std = 0.364)
NEC for r=0.9 all L1 = 0.466 +- 0.126 (in-sample avg dev_std = 0.364)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.887
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.15252625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.548
NEC for r=1.0 class 0 = 0.412 +- 0.178 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 1 = 0.415 +- 0.178 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 2 = 0.476 +- 0.178 (in-sample avg dev_std = 0.371)
NEC for r=1.0 all KL = 0.306 +- 0.178 (in-sample avg dev_std = 0.371)
NEC for r=1.0 all L1 = 0.434 +- 0.131 (in-sample avg dev_std = 0.371)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.647
Model XAI F1 of binarized graphs for r=0.3 =  0.315925
Model XAI WIoU of binarized graphs for r=0.3 =  0.201755
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.356
NEC for r=0.3 class 0 = 0.393 +- 0.191 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 1 = 0.442 +- 0.191 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 2 = 0.511 +- 0.191 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all KL = 0.268 +- 0.191 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all L1 = 0.447 +- 0.154 (in-sample avg dev_std = 0.200)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.651
Model XAI F1 of binarized graphs for r=0.6 =  0.17901249999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.10809875
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.397
NEC for r=0.6 class 0 = 0.387 +- 0.148 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 1 = 0.338 +- 0.148 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 2 = 0.422 +- 0.148 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all KL = 0.229 +- 0.148 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all L1 = 0.381 +- 0.134 (in-sample avg dev_std = 0.259)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.555
Model XAI F1 of binarized graphs for r=0.9 =  0.12400375000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.0747075
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.399
NEC for r=0.9 class 0 = 0.311 +- 0.120 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 1 = 0.327 +- 0.120 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 2 = 0.333 +- 0.120 (in-sample avg dev_std = 0.197)
NEC for r=0.9 all KL = 0.148 +- 0.120 (in-sample avg dev_std = 0.197)
NEC for r=0.9 all L1 = 0.323 +- 0.149 (in-sample avg dev_std = 0.197)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.56
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.06815125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.406
NEC for r=1.0 class 0 = 0.247 +- 0.114 (in-sample avg dev_std = 0.186)
NEC for r=1.0 class 1 = 0.282 +- 0.114 (in-sample avg dev_std = 0.186)
NEC for r=1.0 class 2 = 0.27 +- 0.114 (in-sample avg dev_std = 0.186)
NEC for r=1.0 all KL = 0.115 +- 0.114 (in-sample avg dev_std = 0.186)
NEC for r=1.0 all L1 = 0.267 +- 0.164 (in-sample avg dev_std = 0.186)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 13:24:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:32 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:45 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:47 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:49 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:52 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:59 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:59 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:24:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:24:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.732
WIoU for r=0.3 = 0.613
F1 for r=0.6 = 0.655
WIoU for r=0.6 = 0.536
F1 for r=0.9 = 0.521
WIoU for r=0.9 = 0.400
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.375
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.572
WIoU for r=0.3 = 0.441
F1 for r=0.6 = 0.360
WIoU for r=0.6 = 0.243
F1 for r=0.9 = 0.259
WIoU for r=0.9 = 0.169
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.154
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.319
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.180
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.075
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.068


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.482
Model XAI F1 of binarized graphs for r=0.3 =  0.7320099999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6126999999999999
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.432
SUFF++ for r=0.3 class 0 = 0.469 +- 0.265 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.3 class 1 = 0.617 +- 0.265 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.3 class 2 = 0.572 +- 0.265 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.3 all KL = 0.581 +- 0.265 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.3 all L1 = 0.551 +- 0.181 (in-sample avg dev_std = 0.483)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.786
Model XAI F1 of binarized graphs for r=0.6 =  0.6548400000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.5357525
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.711
SUFF++ for r=0.6 class 0 = 0.639 +- 0.229 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 1 = 0.596 +- 0.229 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 2 = 0.733 +- 0.229 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all KL = 0.714 +- 0.229 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all L1 = 0.657 +- 0.197 (in-sample avg dev_std = 0.396)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  0.52122
Model XAI WIoU of binarized graphs for r=0.9 =  0.39978499999999995
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.863
SUFF++ for r=0.9 class 0 = 0.804 +- 0.155 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 class 1 = 0.803 +- 0.155 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 class 2 = 0.868 +- 0.155 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 all KL = 0.896 +- 0.155 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 all L1 = 0.825 +- 0.161 (in-sample avg dev_std = 0.233)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.712
Model XAI F1 of binarized graphs for r=0.3 =  0.57205
Model XAI WIoU of binarized graphs for r=0.3 =  0.44131
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.651
SUFF++ for r=0.3 class 0 = 0.637 +- 0.219 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 1 = 0.583 +- 0.219 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 2 = 0.628 +- 0.219 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 all KL = 0.687 +- 0.219 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 all L1 = 0.616 +- 0.156 (in-sample avg dev_std = 0.400)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.769
Model XAI F1 of binarized graphs for r=0.6 =  0.35964625
Model XAI WIoU of binarized graphs for r=0.6 =  0.24312875
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.68
SUFF++ for r=0.6 class 0 = 0.669 +- 0.136 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 1 = 0.63 +- 0.136 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 2 = 0.692 +- 0.136 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 all KL = 0.81 +- 0.136 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 all L1 = 0.663 +- 0.129 (in-sample avg dev_std = 0.311)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.875
Model XAI F1 of binarized graphs for r=0.9 =  0.2593275
Model XAI WIoU of binarized graphs for r=0.9 =  0.16858249999999997
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.819
SUFF++ for r=0.9 class 0 = 0.771 +- 0.087 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 1 = 0.794 +- 0.087 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 2 = 0.801 +- 0.087 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all KL = 0.921 +- 0.087 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all L1 = 0.789 +- 0.125 (in-sample avg dev_std = 0.185)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  0.31872125
Model XAI WIoU of binarized graphs for r=0.3 =  0.20369500000000001
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.502
SUFF++ for r=0.3 class 0 = 0.689 +- 0.157 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 class 1 = 0.677 +- 0.157 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 class 2 = 0.683 +- 0.157 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 all KL = 0.811 +- 0.157 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 all L1 = 0.683 +- 0.118 (in-sample avg dev_std = 0.345)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.59
Model XAI F1 of binarized graphs for r=0.6 =  0.17981124999999998
Model XAI WIoU of binarized graphs for r=0.6 =  0.108675
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.559
SUFF++ for r=0.6 class 0 = 0.643 +- 0.185 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 1 = 0.62 +- 0.185 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 2 = 0.626 +- 0.185 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 all KL = 0.753 +- 0.185 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 all L1 = 0.63 +- 0.126 (in-sample avg dev_std = 0.384)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.499
Model XAI F1 of binarized graphs for r=0.9 =  0.12449875000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07502500000000001
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.474
SUFF++ for r=0.9 class 0 = 0.733 +- 0.194 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 class 1 = 0.709 +- 0.194 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 class 2 = 0.763 +- 0.194 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 all KL = 0.831 +- 0.194 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 all L1 = 0.734 +- 0.134 (in-sample avg dev_std = 0.223)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.482
Model XAI F1 of binarized graphs for r=0.3 =  0.7320099999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6126999999999999
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.543 +- 0.319 (in-sample avg dev_std = 0.362)
NEC for r=0.3 class 1 = 0.473 +- 0.319 (in-sample avg dev_std = 0.362)
NEC for r=0.3 class 2 = 0.595 +- 0.319 (in-sample avg dev_std = 0.362)
NEC for r=0.3 all KL = 0.5 +- 0.319 (in-sample avg dev_std = 0.362)
NEC for r=0.3 all L1 = 0.538 +- 0.214 (in-sample avg dev_std = 0.362)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.793
Model XAI F1 of binarized graphs for r=0.6 =  0.6548400000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.5357525
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.39
NEC for r=0.6 class 0 = 0.544 +- 0.263 (in-sample avg dev_std = 0.470)
NEC for r=0.6 class 1 = 0.548 +- 0.263 (in-sample avg dev_std = 0.470)
NEC for r=0.6 class 2 = 0.647 +- 0.263 (in-sample avg dev_std = 0.470)
NEC for r=0.6 all KL = 0.577 +- 0.263 (in-sample avg dev_std = 0.470)
NEC for r=0.6 all L1 = 0.58 +- 0.163 (in-sample avg dev_std = 0.470)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  0.52122
Model XAI WIoU of binarized graphs for r=0.9 =  0.39978499999999995
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.472
NEC for r=0.9 class 0 = 0.532 +- 0.238 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 1 = 0.532 +- 0.238 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 2 = 0.577 +- 0.238 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all KL = 0.536 +- 0.238 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all L1 = 0.547 +- 0.162 (in-sample avg dev_std = 0.533)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.934
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.37454499999999996
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.511
NEC for r=1.0 class 0 = 0.525 +- 0.247 (in-sample avg dev_std = 0.566)
NEC for r=1.0 class 1 = 0.521 +- 0.247 (in-sample avg dev_std = 0.566)
NEC for r=1.0 class 2 = 0.577 +- 0.247 (in-sample avg dev_std = 0.566)
NEC for r=1.0 all KL = 0.557 +- 0.247 (in-sample avg dev_std = 0.566)
NEC for r=1.0 all L1 = 0.541 +- 0.171 (in-sample avg dev_std = 0.566)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.711
Model XAI F1 of binarized graphs for r=0.3 =  0.57205
Model XAI WIoU of binarized graphs for r=0.3 =  0.44131
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.333
NEC for r=0.3 class 0 = 0.476 +- 0.283 (in-sample avg dev_std = 0.290)
NEC for r=0.3 class 1 = 0.523 +- 0.283 (in-sample avg dev_std = 0.290)
NEC for r=0.3 class 2 = 0.626 +- 0.283 (in-sample avg dev_std = 0.290)
NEC for r=0.3 all KL = 0.489 +- 0.283 (in-sample avg dev_std = 0.290)
NEC for r=0.3 all L1 = 0.54 +- 0.182 (in-sample avg dev_std = 0.290)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.35964625
Model XAI WIoU of binarized graphs for r=0.6 =  0.24312875
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.41
NEC for r=0.6 class 0 = 0.425 +- 0.208 (in-sample avg dev_std = 0.317)
NEC for r=0.6 class 1 = 0.458 +- 0.208 (in-sample avg dev_std = 0.317)
NEC for r=0.6 class 2 = 0.53 +- 0.208 (in-sample avg dev_std = 0.317)
NEC for r=0.6 all KL = 0.336 +- 0.208 (in-sample avg dev_std = 0.317)
NEC for r=0.6 all L1 = 0.47 +- 0.154 (in-sample avg dev_std = 0.317)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  0.2593275
Model XAI WIoU of binarized graphs for r=0.9 =  0.16858249999999997
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.474
NEC for r=0.9 class 0 = 0.443 +- 0.169 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 1 = 0.408 +- 0.169 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 2 = 0.481 +- 0.169 (in-sample avg dev_std = 0.325)
NEC for r=0.9 all KL = 0.284 +- 0.169 (in-sample avg dev_std = 0.325)
NEC for r=0.9 all L1 = 0.443 +- 0.142 (in-sample avg dev_std = 0.325)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.916
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.1539425
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.538
NEC for r=1.0 class 0 = 0.413 +- 0.201 (in-sample avg dev_std = 0.347)
NEC for r=1.0 class 1 = 0.43 +- 0.201 (in-sample avg dev_std = 0.347)
NEC for r=1.0 class 2 = 0.486 +- 0.201 (in-sample avg dev_std = 0.347)
NEC for r=1.0 all KL = 0.307 +- 0.201 (in-sample avg dev_std = 0.347)
NEC for r=1.0 all L1 = 0.442 +- 0.136 (in-sample avg dev_std = 0.347)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  0.31872125
Model XAI WIoU of binarized graphs for r=0.3 =  0.20369500000000001
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.342
NEC for r=0.3 class 0 = 0.302 +- 0.191 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 1 = 0.342 +- 0.191 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 2 = 0.397 +- 0.191 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all KL = 0.207 +- 0.191 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all L1 = 0.346 +- 0.187 (in-sample avg dev_std = 0.161)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.589
Model XAI F1 of binarized graphs for r=0.6 =  0.17981124999999998
Model XAI WIoU of binarized graphs for r=0.6 =  0.108675
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.368
NEC for r=0.6 class 0 = 0.286 +- 0.125 (in-sample avg dev_std = 0.196)
NEC for r=0.6 class 1 = 0.325 +- 0.125 (in-sample avg dev_std = 0.196)
NEC for r=0.6 class 2 = 0.361 +- 0.125 (in-sample avg dev_std = 0.196)
NEC for r=0.6 all KL = 0.156 +- 0.125 (in-sample avg dev_std = 0.196)
NEC for r=0.6 all L1 = 0.323 +- 0.152 (in-sample avg dev_std = 0.196)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.501
Model XAI F1 of binarized graphs for r=0.9 =  0.12449875000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07502500000000001
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.349
NEC for r=0.9 class 0 = 0.271 +- 0.126 (in-sample avg dev_std = 0.170)
NEC for r=0.9 class 1 = 0.331 +- 0.126 (in-sample avg dev_std = 0.170)
NEC for r=0.9 class 2 = 0.279 +- 0.126 (in-sample avg dev_std = 0.170)
NEC for r=0.9 all KL = 0.146 +- 0.126 (in-sample avg dev_std = 0.170)
NEC for r=0.9 all L1 = 0.294 +- 0.149 (in-sample avg dev_std = 0.170)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.48
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.06820999999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.365
NEC for r=1.0 class 0 = 0.236 +- 0.142 (in-sample avg dev_std = 0.154)
NEC for r=1.0 class 1 = 0.306 +- 0.142 (in-sample avg dev_std = 0.154)
NEC for r=1.0 class 2 = 0.268 +- 0.142 (in-sample avg dev_std = 0.154)
NEC for r=1.0 all KL = 0.143 +- 0.142 (in-sample avg dev_std = 0.154)
NEC for r=1.0 all L1 = 0.271 +- 0.172 (in-sample avg dev_std = 0.154)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 13:31:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:29 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:42 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:44 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:46 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:50 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:57 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:57 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:31:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:31:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.728
WIoU for r=0.3 = 0.610
F1 for r=0.6 = 0.638
WIoU for r=0.6 = 0.517
F1 for r=0.9 = 0.517
WIoU for r=0.9 = 0.394
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.373
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.574
WIoU for r=0.3 = 0.444
F1 for r=0.6 = 0.359
WIoU for r=0.6 = 0.244
F1 for r=0.9 = 0.259
WIoU for r=0.9 = 0.169
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.155
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.319
WIoU for r=0.3 = 0.206
F1 for r=0.6 = 0.180
WIoU for r=0.6 = 0.110
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.076
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.069


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  0.7275212500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6101287500000001
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.397
SUFF++ for r=0.3 class 0 = 0.493 +- 0.259 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 1 = 0.618 +- 0.259 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 2 = 0.563 +- 0.259 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 all KL = 0.602 +- 0.259 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 all L1 = 0.557 +- 0.152 (in-sample avg dev_std = 0.438)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.785
Model XAI F1 of binarized graphs for r=0.6 =  0.6379625
Model XAI WIoU of binarized graphs for r=0.6 =  0.51734875
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.68
SUFF++ for r=0.6 class 0 = 0.606 +- 0.223 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 1 = 0.606 +- 0.223 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 2 = 0.723 +- 0.223 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all KL = 0.712 +- 0.223 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all L1 = 0.645 +- 0.187 (in-sample avg dev_std = 0.377)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.51677125
Model XAI WIoU of binarized graphs for r=0.9 =  0.39374625
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.867
SUFF++ for r=0.9 class 0 = 0.783 +- 0.182 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 1 = 0.836 +- 0.182 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 2 = 0.866 +- 0.182 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 all KL = 0.888 +- 0.182 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 all L1 = 0.828 +- 0.170 (in-sample avg dev_std = 0.230)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.79
Model XAI F1 of binarized graphs for r=0.3 =  0.5735475
Model XAI WIoU of binarized graphs for r=0.3 =  0.44353625
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.682
SUFF++ for r=0.3 class 0 = 0.589 +- 0.207 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 class 1 = 0.629 +- 0.207 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 class 2 = 0.648 +- 0.207 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 all KL = 0.707 +- 0.207 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 all L1 = 0.622 +- 0.155 (in-sample avg dev_std = 0.381)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.764
Model XAI F1 of binarized graphs for r=0.6 =  0.35940124999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.24441499999999997
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.715
SUFF++ for r=0.6 class 0 = 0.602 +- 0.175 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 1 = 0.683 +- 0.175 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 2 = 0.687 +- 0.175 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 all KL = 0.781 +- 0.175 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 all L1 = 0.656 +- 0.146 (in-sample avg dev_std = 0.336)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.25910249999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.16903750000000003
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.878
SUFF++ for r=0.9 class 0 = 0.79 +- 0.106 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 class 1 = 0.818 +- 0.106 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 class 2 = 0.79 +- 0.106 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 all KL = 0.915 +- 0.106 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 all L1 = 0.799 +- 0.135 (in-sample avg dev_std = 0.186)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.585
Model XAI F1 of binarized graphs for r=0.3 =  0.3193525
Model XAI WIoU of binarized graphs for r=0.3 =  0.20642125
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.582
SUFF++ for r=0.3 class 0 = 0.609 +- 0.151 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 1 = 0.619 +- 0.151 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 2 = 0.647 +- 0.151 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 all KL = 0.764 +- 0.151 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 all L1 = 0.625 +- 0.120 (in-sample avg dev_std = 0.386)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.664
Model XAI F1 of binarized graphs for r=0.6 =  0.17954499999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.11019125
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.574
SUFF++ for r=0.6 class 0 = 0.627 +- 0.144 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 class 1 = 0.668 +- 0.144 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 class 2 = 0.664 +- 0.144 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 all KL = 0.8 +- 0.144 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 all L1 = 0.653 +- 0.116 (in-sample avg dev_std = 0.325)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.59
Model XAI F1 of binarized graphs for r=0.9 =  0.12430625000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.07582375
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.611
SUFF++ for r=0.9 class 0 = 0.729 +- 0.161 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 1 = 0.72 +- 0.161 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 2 = 0.727 +- 0.161 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all KL = 0.866 +- 0.161 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all L1 = 0.725 +- 0.159 (in-sample avg dev_std = 0.237)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.494
Model XAI F1 of binarized graphs for r=0.3 =  0.7275212500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6101287500000001
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.326
NEC for r=0.3 class 0 = 0.568 +- 0.315 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 1 = 0.433 +- 0.315 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 2 = 0.562 +- 0.315 (in-sample avg dev_std = 0.303)
NEC for r=0.3 all KL = 0.479 +- 0.315 (in-sample avg dev_std = 0.303)
NEC for r=0.3 all L1 = 0.522 +- 0.194 (in-sample avg dev_std = 0.303)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.784
Model XAI F1 of binarized graphs for r=0.6 =  0.6379625
Model XAI WIoU of binarized graphs for r=0.6 =  0.51734875
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.379
NEC for r=0.6 class 0 = 0.604 +- 0.264 (in-sample avg dev_std = 0.437)
NEC for r=0.6 class 1 = 0.514 +- 0.264 (in-sample avg dev_std = 0.437)
NEC for r=0.6 class 2 = 0.631 +- 0.264 (in-sample avg dev_std = 0.437)
NEC for r=0.6 all KL = 0.572 +- 0.264 (in-sample avg dev_std = 0.437)
NEC for r=0.6 all L1 = 0.584 +- 0.150 (in-sample avg dev_std = 0.437)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.51677125
Model XAI WIoU of binarized graphs for r=0.9 =  0.39374625
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.489
NEC for r=0.9 class 0 = 0.584 +- 0.237 (in-sample avg dev_std = 0.530)
NEC for r=0.9 class 1 = 0.511 +- 0.237 (in-sample avg dev_std = 0.530)
NEC for r=0.9 class 2 = 0.577 +- 0.237 (in-sample avg dev_std = 0.530)
NEC for r=0.9 all KL = 0.563 +- 0.237 (in-sample avg dev_std = 0.530)
NEC for r=0.9 all L1 = 0.558 +- 0.155 (in-sample avg dev_std = 0.530)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.934
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.3726525
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.501
NEC for r=1.0 class 0 = 0.577 +- 0.254 (in-sample avg dev_std = 0.584)
NEC for r=1.0 class 1 = 0.512 +- 0.254 (in-sample avg dev_std = 0.584)
NEC for r=1.0 class 2 = 0.595 +- 0.254 (in-sample avg dev_std = 0.584)
NEC for r=1.0 all KL = 0.609 +- 0.254 (in-sample avg dev_std = 0.584)
NEC for r=1.0 all L1 = 0.562 +- 0.167 (in-sample avg dev_std = 0.584)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.794
Model XAI F1 of binarized graphs for r=0.3 =  0.5735475
Model XAI WIoU of binarized graphs for r=0.3 =  0.44353625
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.333
NEC for r=0.3 class 0 = 0.597 +- 0.262 (in-sample avg dev_std = 0.269)
NEC for r=0.3 class 1 = 0.516 +- 0.262 (in-sample avg dev_std = 0.269)
NEC for r=0.3 class 2 = 0.592 +- 0.262 (in-sample avg dev_std = 0.269)
NEC for r=0.3 all KL = 0.515 +- 0.262 (in-sample avg dev_std = 0.269)
NEC for r=0.3 all L1 = 0.568 +- 0.147 (in-sample avg dev_std = 0.269)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.766
Model XAI F1 of binarized graphs for r=0.6 =  0.35940124999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.24441499999999997
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.4
NEC for r=0.6 class 0 = 0.497 +- 0.227 (in-sample avg dev_std = 0.312)
NEC for r=0.6 class 1 = 0.415 +- 0.227 (in-sample avg dev_std = 0.312)
NEC for r=0.6 class 2 = 0.542 +- 0.227 (in-sample avg dev_std = 0.312)
NEC for r=0.6 all KL = 0.355 +- 0.227 (in-sample avg dev_std = 0.312)
NEC for r=0.6 all L1 = 0.484 +- 0.156 (in-sample avg dev_std = 0.312)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.25910249999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.16903750000000003
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.509
NEC for r=0.9 class 0 = 0.546 +- 0.200 (in-sample avg dev_std = 0.359)
NEC for r=0.9 class 1 = 0.409 +- 0.200 (in-sample avg dev_std = 0.359)
NEC for r=0.9 class 2 = 0.491 +- 0.200 (in-sample avg dev_std = 0.359)
NEC for r=0.9 all KL = 0.348 +- 0.200 (in-sample avg dev_std = 0.359)
NEC for r=0.9 all L1 = 0.482 +- 0.141 (in-sample avg dev_std = 0.359)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.933
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.15456875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.549
NEC for r=1.0 class 0 = 0.479 +- 0.181 (in-sample avg dev_std = 0.386)
NEC for r=1.0 class 1 = 0.413 +- 0.181 (in-sample avg dev_std = 0.386)
NEC for r=1.0 class 2 = 0.488 +- 0.181 (in-sample avg dev_std = 0.386)
NEC for r=1.0 all KL = 0.338 +- 0.181 (in-sample avg dev_std = 0.386)
NEC for r=1.0 all L1 = 0.46 +- 0.130 (in-sample avg dev_std = 0.386)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.58
Model XAI F1 of binarized graphs for r=0.3 =  0.3193525
Model XAI WIoU of binarized graphs for r=0.3 =  0.20642125
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.452 +- 0.196 (in-sample avg dev_std = 0.215)
NEC for r=0.3 class 1 = 0.374 +- 0.196 (in-sample avg dev_std = 0.215)
NEC for r=0.3 class 2 = 0.433 +- 0.196 (in-sample avg dev_std = 0.215)
NEC for r=0.3 all KL = 0.261 +- 0.196 (in-sample avg dev_std = 0.215)
NEC for r=0.3 all L1 = 0.419 +- 0.157 (in-sample avg dev_std = 0.215)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.663
Model XAI F1 of binarized graphs for r=0.6 =  0.17954499999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.11019125
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.377
NEC for r=0.6 class 0 = 0.441 +- 0.155 (in-sample avg dev_std = 0.211)
NEC for r=0.6 class 1 = 0.307 +- 0.155 (in-sample avg dev_std = 0.211)
NEC for r=0.6 class 2 = 0.394 +- 0.155 (in-sample avg dev_std = 0.211)
NEC for r=0.6 all KL = 0.205 +- 0.155 (in-sample avg dev_std = 0.211)
NEC for r=0.6 all L1 = 0.38 +- 0.154 (in-sample avg dev_std = 0.211)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.592
Model XAI F1 of binarized graphs for r=0.9 =  0.12430625000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.07582375
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.406
NEC for r=0.9 class 0 = 0.43 +- 0.227 (in-sample avg dev_std = 0.270)
NEC for r=0.9 class 1 = 0.406 +- 0.227 (in-sample avg dev_std = 0.270)
NEC for r=0.9 class 2 = 0.39 +- 0.227 (in-sample avg dev_std = 0.270)
NEC for r=0.9 all KL = 0.249 +- 0.227 (in-sample avg dev_std = 0.270)
NEC for r=0.9 all L1 = 0.409 +- 0.175 (in-sample avg dev_std = 0.270)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.538
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.06909
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.435
NEC for r=1.0 class 0 = 0.327 +- 0.186 (in-sample avg dev_std = 0.231)
NEC for r=1.0 class 1 = 0.392 +- 0.186 (in-sample avg dev_std = 0.231)
NEC for r=1.0 class 2 = 0.348 +- 0.186 (in-sample avg dev_std = 0.231)
NEC for r=1.0 all KL = 0.209 +- 0.186 (in-sample avg dev_std = 0.231)
NEC for r=1.0 all L1 = 0.356 +- 0.162 (in-sample avg dev_std = 0.231)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 13:38:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 01:38:42 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 01:38:55 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 01:38:57 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 01:38:59 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 01:39:02 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 01:39:09 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:39:09 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:39:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:39:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.715
WIoU for r=0.3 = 0.597
F1 for r=0.6 = 0.645
WIoU for r=0.6 = 0.527
F1 for r=0.9 = 0.518
WIoU for r=0.9 = 0.394
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.372
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.566
WIoU for r=0.3 = 0.435
F1 for r=0.6 = 0.359
WIoU for r=0.6 = 0.242
F1 for r=0.9 = 0.259
WIoU for r=0.9 = 0.168
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.153
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.317
WIoU for r=0.3 = 0.201
F1 for r=0.6 = 0.180
WIoU for r=0.6 = 0.108
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.074
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.067


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.7145112499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5965125
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.42
SUFF++ for r=0.3 class 0 = 0.479 +- 0.272 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 class 1 = 0.548 +- 0.272 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 class 2 = 0.546 +- 0.272 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 all KL = 0.538 +- 0.272 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 all L1 = 0.524 +- 0.173 (in-sample avg dev_std = 0.517)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.6454274999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.5271837500000001
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.695
SUFF++ for r=0.6 class 0 = 0.591 +- 0.281 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 1 = 0.558 +- 0.281 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 2 = 0.771 +- 0.281 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all KL = 0.657 +- 0.281 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all L1 = 0.641 +- 0.228 (in-sample avg dev_std = 0.439)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.51755375
Model XAI WIoU of binarized graphs for r=0.9 =  0.39430750000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.864
SUFF++ for r=0.9 class 0 = 0.776 +- 0.182 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 class 1 = 0.813 +- 0.182 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 class 2 = 0.904 +- 0.182 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 all KL = 0.887 +- 0.182 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 all L1 = 0.831 +- 0.176 (in-sample avg dev_std = 0.215)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.69
Model XAI F1 of binarized graphs for r=0.3 =  0.565975
Model XAI WIoU of binarized graphs for r=0.3 =  0.434645
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.662
SUFF++ for r=0.3 class 0 = 0.56 +- 0.244 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 1 = 0.556 +- 0.244 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 2 = 0.693 +- 0.244 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 all KL = 0.659 +- 0.244 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 all L1 = 0.601 +- 0.183 (in-sample avg dev_std = 0.414)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.754
Model XAI F1 of binarized graphs for r=0.6 =  0.3592825
Model XAI WIoU of binarized graphs for r=0.6 =  0.241615
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.71
SUFF++ for r=0.6 class 0 = 0.575 +- 0.228 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.6 class 1 = 0.596 +- 0.228 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.6 class 2 = 0.735 +- 0.228 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.6 all KL = 0.726 +- 0.228 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.6 all L1 = 0.634 +- 0.178 (in-sample avg dev_std = 0.363)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  0.2592425
Model XAI WIoU of binarized graphs for r=0.9 =  0.16756124999999997
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.839
SUFF++ for r=0.9 class 0 = 0.743 +- 0.117 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 1 = 0.805 +- 0.117 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 2 = 0.84 +- 0.117 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 all KL = 0.91 +- 0.117 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 all L1 = 0.795 +- 0.145 (in-sample avg dev_std = 0.194)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.564
Model XAI F1 of binarized graphs for r=0.3 =  0.3172825
Model XAI WIoU of binarized graphs for r=0.3 =  0.20112000000000002
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.584
SUFF++ for r=0.3 class 0 = 0.627 +- 0.237 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 1 = 0.619 +- 0.237 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 2 = 0.676 +- 0.237 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 all KL = 0.745 +- 0.237 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 all L1 = 0.64 +- 0.118 (in-sample avg dev_std = 0.391)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.646
Model XAI F1 of binarized graphs for r=0.6 =  0.17977875
Model XAI WIoU of binarized graphs for r=0.6 =  0.10751874999999998
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.56
SUFF++ for r=0.6 class 0 = 0.589 +- 0.252 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 class 1 = 0.604 +- 0.252 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 class 2 = 0.627 +- 0.252 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all KL = 0.684 +- 0.252 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all L1 = 0.606 +- 0.125 (in-sample avg dev_std = 0.404)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.587
Model XAI F1 of binarized graphs for r=0.9 =  0.12446375
Model XAI WIoU of binarized graphs for r=0.9 =  0.07420875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.487
SUFF++ for r=0.9 class 0 = 0.717 +- 0.137 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 1 = 0.721 +- 0.137 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 2 = 0.757 +- 0.137 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all KL = 0.852 +- 0.137 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all L1 = 0.731 +- 0.135 (in-sample avg dev_std = 0.229)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.52
Model XAI F1 of binarized graphs for r=0.3 =  0.7145112499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5965125
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.317
NEC for r=0.3 class 0 = 0.586 +- 0.316 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 1 = 0.51 +- 0.316 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 2 = 0.631 +- 0.316 (in-sample avg dev_std = 0.378)
NEC for r=0.3 all KL = 0.548 +- 0.316 (in-sample avg dev_std = 0.378)
NEC for r=0.3 all L1 = 0.577 +- 0.195 (in-sample avg dev_std = 0.378)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.777
Model XAI F1 of binarized graphs for r=0.6 =  0.6454274999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.5271837500000001
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.382
NEC for r=0.6 class 0 = 0.592 +- 0.275 (in-sample avg dev_std = 0.506)
NEC for r=0.6 class 1 = 0.564 +- 0.275 (in-sample avg dev_std = 0.506)
NEC for r=0.6 class 2 = 0.628 +- 0.275 (in-sample avg dev_std = 0.506)
NEC for r=0.6 all KL = 0.641 +- 0.275 (in-sample avg dev_std = 0.506)
NEC for r=0.6 all L1 = 0.595 +- 0.168 (in-sample avg dev_std = 0.506)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.51755375
Model XAI WIoU of binarized graphs for r=0.9 =  0.39430750000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.472
NEC for r=0.9 class 0 = 0.576 +- 0.254 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 1 = 0.53 +- 0.254 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 2 = 0.572 +- 0.254 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all KL = 0.591 +- 0.254 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all L1 = 0.56 +- 0.167 (in-sample avg dev_std = 0.568)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.37213000000000007
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.518
NEC for r=1.0 class 0 = 0.565 +- 0.251 (in-sample avg dev_std = 0.612)
NEC for r=1.0 class 1 = 0.496 +- 0.251 (in-sample avg dev_std = 0.612)
NEC for r=1.0 class 2 = 0.587 +- 0.251 (in-sample avg dev_std = 0.612)
NEC for r=1.0 all KL = 0.608 +- 0.251 (in-sample avg dev_std = 0.612)
NEC for r=1.0 all L1 = 0.55 +- 0.170 (in-sample avg dev_std = 0.612)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.692
Model XAI F1 of binarized graphs for r=0.3 =  0.565975
Model XAI WIoU of binarized graphs for r=0.3 =  0.434645
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.347
NEC for r=0.3 class 0 = 0.511 +- 0.302 (in-sample avg dev_std = 0.331)
NEC for r=0.3 class 1 = 0.504 +- 0.302 (in-sample avg dev_std = 0.331)
NEC for r=0.3 class 2 = 0.566 +- 0.302 (in-sample avg dev_std = 0.331)
NEC for r=0.3 all KL = 0.496 +- 0.302 (in-sample avg dev_std = 0.331)
NEC for r=0.3 all L1 = 0.527 +- 0.193 (in-sample avg dev_std = 0.331)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.754
Model XAI F1 of binarized graphs for r=0.6 =  0.3592825
Model XAI WIoU of binarized graphs for r=0.6 =  0.241615
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.407
NEC for r=0.6 class 0 = 0.475 +- 0.239 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 1 = 0.435 +- 0.239 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 2 = 0.543 +- 0.239 (in-sample avg dev_std = 0.387)
NEC for r=0.6 all KL = 0.404 +- 0.239 (in-sample avg dev_std = 0.387)
NEC for r=0.6 all L1 = 0.483 +- 0.175 (in-sample avg dev_std = 0.387)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.892
Model XAI F1 of binarized graphs for r=0.9 =  0.2592425
Model XAI WIoU of binarized graphs for r=0.9 =  0.16756124999999997
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.5
NEC for r=0.9 class 0 = 0.482 +- 0.189 (in-sample avg dev_std = 0.392)
NEC for r=0.9 class 1 = 0.43 +- 0.189 (in-sample avg dev_std = 0.392)
NEC for r=0.9 class 2 = 0.482 +- 0.189 (in-sample avg dev_std = 0.392)
NEC for r=0.9 all KL = 0.337 +- 0.189 (in-sample avg dev_std = 0.392)
NEC for r=0.9 all L1 = 0.464 +- 0.136 (in-sample avg dev_std = 0.392)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.921
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.15301625000000002
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.557
NEC for r=1.0 class 0 = 0.464 +- 0.202 (in-sample avg dev_std = 0.419)
NEC for r=1.0 class 1 = 0.411 +- 0.202 (in-sample avg dev_std = 0.419)
NEC for r=1.0 class 2 = 0.488 +- 0.202 (in-sample avg dev_std = 0.419)
NEC for r=1.0 all KL = 0.357 +- 0.202 (in-sample avg dev_std = 0.419)
NEC for r=1.0 all L1 = 0.454 +- 0.133 (in-sample avg dev_std = 0.419)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.566
Model XAI F1 of binarized graphs for r=0.3 =  0.3172825
Model XAI WIoU of binarized graphs for r=0.3 =  0.20112000000000002
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.332
NEC for r=0.3 class 0 = 0.384 +- 0.230 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 1 = 0.423 +- 0.230 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 2 = 0.413 +- 0.230 (in-sample avg dev_std = 0.198)
NEC for r=0.3 all KL = 0.272 +- 0.230 (in-sample avg dev_std = 0.198)
NEC for r=0.3 all L1 = 0.406 +- 0.212 (in-sample avg dev_std = 0.198)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.17977875
Model XAI WIoU of binarized graphs for r=0.6 =  0.10751874999999998
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.401
NEC for r=0.6 class 0 = 0.381 +- 0.195 (in-sample avg dev_std = 0.269)
NEC for r=0.6 class 1 = 0.347 +- 0.195 (in-sample avg dev_std = 0.269)
NEC for r=0.6 class 2 = 0.434 +- 0.195 (in-sample avg dev_std = 0.269)
NEC for r=0.6 all KL = 0.264 +- 0.195 (in-sample avg dev_std = 0.269)
NEC for r=0.6 all L1 = 0.386 +- 0.135 (in-sample avg dev_std = 0.269)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.585
Model XAI F1 of binarized graphs for r=0.9 =  0.12446375
Model XAI WIoU of binarized graphs for r=0.9 =  0.07420875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.387
NEC for r=0.9 class 0 = 0.339 +- 0.135 (in-sample avg dev_std = 0.216)
NEC for r=0.9 class 1 = 0.325 +- 0.135 (in-sample avg dev_std = 0.216)
NEC for r=0.9 class 2 = 0.322 +- 0.135 (in-sample avg dev_std = 0.216)
NEC for r=0.9 all KL = 0.182 +- 0.135 (in-sample avg dev_std = 0.216)
NEC for r=0.9 all L1 = 0.329 +- 0.157 (in-sample avg dev_std = 0.216)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.519
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.067485
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.379
NEC for r=1.0 class 0 = 0.242 +- 0.146 (in-sample avg dev_std = 0.177)
NEC for r=1.0 class 1 = 0.269 +- 0.146 (in-sample avg dev_std = 0.177)
NEC for r=1.0 class 2 = 0.245 +- 0.146 (in-sample avg dev_std = 0.177)
NEC for r=1.0 all KL = 0.13 +- 0.146 (in-sample avg dev_std = 0.177)
NEC for r=1.0 all L1 = 0.252 +- 0.177 (in-sample avg dev_std = 0.177)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.55, 0.68, 0.895, 1.0], 'all_L1': [0.538, 0.659, 0.851, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.602, 0.7, 0.87, 1.0], 'all_L1': [0.564, 0.644, 0.801, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.581, 0.714, 0.896, 1.0], 'all_L1': [0.551, 0.657, 0.825, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.602, 0.712, 0.888, 1.0], 'all_L1': [0.557, 0.645, 0.828, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.538, 0.657, 0.887, 1.0], 'all_L1': [0.524, 0.641, 0.831, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.504, 0.648, 0.62, 0.622], 'all_L1': [0.537, 0.605, 0.567, 0.546]}), defaultdict(<class 'list'>, {'all_KL': [0.466, 0.566, 0.549, 0.572], 'all_L1': [0.517, 0.577, 0.545, 0.542]}), defaultdict(<class 'list'>, {'all_KL': [0.5, 0.577, 0.536, 0.557], 'all_L1': [0.538, 0.58, 0.547, 0.541]}), defaultdict(<class 'list'>, {'all_KL': [0.479, 0.572, 0.563, 0.609], 'all_L1': [0.522, 0.584, 0.558, 0.562]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.641, 0.591, 0.608], 'all_L1': [0.577, 0.595, 0.56, 0.55]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.637, 0.679, 0.9, 1.0], 'all_L1': [0.585, 0.613, 0.778, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.732, 0.748, 0.893, 1.0], 'all_L1': [0.644, 0.642, 0.76, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.687, 0.81, 0.921, 1.0], 'all_L1': [0.616, 0.663, 0.789, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.781, 0.915, 1.0], 'all_L1': [0.622, 0.656, 0.799, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.659, 0.726, 0.91, 1.0], 'all_L1': [0.601, 0.634, 0.795, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.542, 0.447, 0.35, 0.371], 'all_L1': [0.573, 0.506, 0.47, 0.475]}), defaultdict(<class 'list'>, {'all_KL': [0.472, 0.407, 0.324, 0.306], 'all_L1': [0.543, 0.504, 0.466, 0.434]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.336, 0.284, 0.307], 'all_L1': [0.54, 0.47, 0.443, 0.442]}), defaultdict(<class 'list'>, {'all_KL': [0.515, 0.355, 0.348, 0.338], 'all_L1': [0.568, 0.484, 0.482, 0.46]}), defaultdict(<class 'list'>, {'all_KL': [0.496, 0.404, 0.337, 0.357], 'all_L1': [0.527, 0.483, 0.464, 0.454]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.758, 0.712, 0.819, 1.0], 'all_L1': [0.611, 0.615, 0.725, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.848, 0.76, 0.896, 1.0], 'all_L1': [0.683, 0.643, 0.749, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.811, 0.753, 0.831, 1.0], 'all_L1': [0.683, 0.63, 0.734, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.764, 0.8, 0.866, 1.0], 'all_L1': [0.625, 0.653, 0.725, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.745, 0.684, 0.852, 1.0], 'all_L1': [0.64, 0.606, 0.731, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.319, 0.237, 0.198, 0.138], 'all_L1': [0.476, 0.38, 0.319, 0.232]}), defaultdict(<class 'list'>, {'all_KL': [0.268, 0.229, 0.148, 0.115], 'all_L1': [0.447, 0.381, 0.323, 0.267]}), defaultdict(<class 'list'>, {'all_KL': [0.207, 0.156, 0.146, 0.143], 'all_L1': [0.346, 0.323, 0.294, 0.271]}), defaultdict(<class 'list'>, {'all_KL': [0.261, 0.205, 0.249, 0.209], 'all_L1': [0.419, 0.38, 0.409, 0.356]}), defaultdict(<class 'list'>, {'all_KL': [0.272, 0.264, 0.182, 0.13], 'all_L1': [0.406, 0.386, 0.329, 0.252]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.547 +- 0.014, 0.649 +- 0.007, 0.827 +- 0.016, 1.000 +- 0.000
suff++ class all_KL  =  0.575 +- 0.026, 0.693 +- 0.022, 0.887 +- 0.009, 1.000 +- 0.000
suff++_acc_int  =  0.419 +- 0.012, 0.699 +- 0.016, 0.862 +- 0.016
nec class all_L1  =  0.538 +- 0.021, 0.588 +- 0.010, 0.555 +- 0.008, 0.548 +- 0.008
nec class all_KL  =  0.499 +- 0.028, 0.601 +- 0.036, 0.572 +- 0.030, 0.594 +- 0.025
nec_acc_int  =  0.328 +- 0.006, 0.386 +- 0.004, 0.480 +- 0.007, 0.514 +- 0.009

Eval split val
suff++ class all_L1  =  0.614 +- 0.020, 0.642 +- 0.018, 0.784 +- 0.014, 1.000 +- 0.000
suff++ class all_KL  =  0.684 +- 0.034, 0.749 +- 0.045, 0.908 +- 0.010, 1.000 +- 0.000
suff++_acc_int  =  0.666 +- 0.010, 0.706 +- 0.016, 0.842 +- 0.019
nec class all_L1  =  0.550 +- 0.017, 0.489 +- 0.014, 0.465 +- 0.013, 0.453 +- 0.014
nec class all_KL  =  0.503 +- 0.024, 0.390 +- 0.040, 0.329 +- 0.024, 0.336 +- 0.026
nec_acc_int  =  0.340 +- 0.008, 0.412 +- 0.009, 0.498 +- 0.013, 0.551 +- 0.009

Eval split test
suff++ class all_L1  =  0.648 +- 0.030, 0.629 +- 0.017, 0.733 +- 0.009, 1.000 +- 0.000
suff++ class all_KL  =  0.785 +- 0.039, 0.742 +- 0.040, 0.853 +- 0.027, 1.000 +- 0.000
suff++_acc_int  =  0.564 +- 0.036, 0.577 +- 0.017, 0.526 +- 0.049
nec class all_L1  =  0.419 +- 0.044, 0.370 +- 0.024, 0.335 +- 0.039, 0.276 +- 0.042
nec class all_KL  =  0.265 +- 0.036, 0.218 +- 0.036, 0.185 +- 0.038, 0.147 +- 0.032
nec_acc_int  =  0.342 +- 0.008, 0.390 +- 0.014, 0.389 +- 0.021, 0.399 +- 0.025


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.543 +- 0.005, 0.619 +- 0.007, 0.691 +- 0.012, 0.774 +- 0.004
Faith. Armon (L1)= 		  =  0.542 +- 0.004, 0.617 +- 0.007, 0.665 +- 0.011, 0.708 +- 0.006
Faith. GMean (L1)= 	  =  0.542 +- 0.004, 0.618 +- 0.007, 0.678 +- 0.011, 0.740 +- 0.005
Faith. Aritm (KL)= 		  =  0.537 +- 0.006, 0.647 +- 0.010, 0.730 +- 0.017, 0.797 +- 0.012
Faith. Armon (KL)= 		  =  0.533 +- 0.007, 0.642 +- 0.013, 0.695 +- 0.023, 0.745 +- 0.020
Faith. GMean (KL)= 	  =  0.535 +- 0.006, 0.644 +- 0.012, 0.712 +- 0.020, 0.770 +- 0.016

Eval split val
Faith. Aritm (L1)= 		  =  0.582 +- 0.011, 0.565 +- 0.006, 0.625 +- 0.010, 0.726 +- 0.007
Faith. Armon (L1)= 		  =  0.580 +- 0.011, 0.555 +- 0.006, 0.584 +- 0.011, 0.623 +- 0.013
Faith. GMean (L1)= 	  =  0.581 +- 0.011, 0.560 +- 0.005, 0.604 +- 0.010, 0.673 +- 0.011
Faith. Aritm (KL)= 		  =  0.594 +- 0.012, 0.569 +- 0.005, 0.618 +- 0.011, 0.668 +- 0.013
Faith. Armon (KL)= 		  =  0.579 +- 0.011, 0.510 +- 0.024, 0.482 +- 0.026, 0.502 +- 0.029
Faith. GMean (KL)= 	  =  0.586 +- 0.011, 0.538 +- 0.012, 0.546 +- 0.019, 0.579 +- 0.023

Eval split test
Faith. Aritm (L1)= 		  =  0.534 +- 0.018, 0.500 +- 0.014, 0.534 +- 0.018, 0.638 +- 0.021
Faith. Armon (L1)= 		  =  0.507 +- 0.029, 0.465 +- 0.020, 0.458 +- 0.035, 0.430 +- 0.050
Faith. GMean (L1)= 	  =  0.520 +- 0.023, 0.482 +- 0.017, 0.494 +- 0.027, 0.524 +- 0.039
Faith. Aritm (KL)= 		  =  0.525 +- 0.020, 0.480 +- 0.017, 0.519 +- 0.023, 0.574 +- 0.016
Faith. Armon (KL)= 		  =  0.395 +- 0.038, 0.335 +- 0.042, 0.302 +- 0.050, 0.255 +- 0.048
Faith. GMean (KL)= 	  =  0.455 +- 0.028, 0.400 +- 0.029, 0.395 +- 0.040, 0.381 +- 0.040
Computed for split load_split = id



Completed in  0:35:26.075773  for GSATGIN GOODMotif/size



DONE GSAT GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 13:46:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:05 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:08 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:11 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:14 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 01:46:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ROC-AUC: 0.9090
Train Loss: 0.0950
ID Validation ROC-AUC: 0.8455
ID Validation Loss: 0.1252
ID Test ROC-AUC: 0.8217
ID Test Loss: 0.1090
OOD Validation ROC-AUC: 0.7404
OOD Validation Loss: 0.1137
OOD Test ROC-AUC: 0.6988
OOD Test Loss: 0.0867

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.8446
Train Loss: 0.1135
ID Validation ROC-AUC: 0.8042
ID Validation Loss: 0.1337
ID Test ROC-AUC: 0.8042
ID Test Loss: 0.1156
OOD Validation ROC-AUC: 0.7833
OOD Validation Loss: 0.1126
OOD Test ROC-AUC: 0.6912
OOD Test Loss: 0.0970

[0m[1;37mINFO[0m: [1mChartInfo 0.8217 0.6988 0.8042 0.6912 0.8042 0.7833[0mGOODHIV(4112)
Data example from id_val: Data(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
Label distribution from id_val: (tensor([0., 1.]), tensor([3936,  176]))
[1;34mDEBUG[0m: 04/22/2024 01:46:18 PM : [1mUnbalanced warning for GOODHIV (id_val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([176, 176]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4113)
Data example from val: Data(x=[33, 9], edge_index=[2, 74], edge_attr=[74, 3], y=[1, 1], smiles='OC(c1ccccc1)c1c(-c2ccccc2)[nH]c(-c2ccccc2)c1C(O)c1ccccc1', idx=[1], scaffold='c1ccc(Cc2c(-c3ccccc3)[nH]c(-c3ccccc3)c2Cc2ccccc2)cc1', domain_id=[1], ori_edge_index=[2, 74], node_perm=[33])
Label distribution from val: (tensor([0., 1.]), tensor([3987,  126]))
[1;34mDEBUG[0m: 04/22/2024 01:46:21 PM : [1mUnbalanced warning for GOODHIV (val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([126, 126]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 04/22/2024 01:46:23 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.573
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.54
SUFF++ for r=0.3 class 0.0 = 0.988 +- 0.014 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.3 class 1.0 = 0.98 +- 0.014 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.3 all KL = 0.994 +- 0.014 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.3 all L1 = 0.984 +- 0.020 (in-sample avg dev_std = 0.032)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.652
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.624
SUFF++ for r=0.6 class 0.0 = 0.987 +- 0.025 (in-sample avg dev_std = 0.044)
SUFF++ for r=0.6 class 1.0 = 0.958 +- 0.025 (in-sample avg dev_std = 0.044)
SUFF++ for r=0.6 all KL = 0.99 +- 0.025 (in-sample avg dev_std = 0.044)
SUFF++ for r=0.6 all L1 = 0.973 +- 0.047 (in-sample avg dev_std = 0.044)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.736
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.719
SUFF++ for r=0.9 class 0.0 = 0.989 +- 0.023 (in-sample avg dev_std = 0.052)
SUFF++ for r=0.9 class 1.0 = 0.955 +- 0.023 (in-sample avg dev_std = 0.052)
SUFF++ for r=0.9 all KL = 0.992 +- 0.023 (in-sample avg dev_std = 0.052)
SUFF++ for r=0.9 all L1 = 0.972 +- 0.056 (in-sample avg dev_std = 0.052)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.643
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.569
SUFF++ for r=0.3 class 0.0 = 0.988 +- 0.011 (in-sample avg dev_std = 0.026)
SUFF++ for r=0.3 class 1.0 = 0.97 +- 0.011 (in-sample avg dev_std = 0.026)
SUFF++ for r=0.3 all KL = 0.994 +- 0.011 (in-sample avg dev_std = 0.026)
SUFF++ for r=0.3 all L1 = 0.979 +- 0.026 (in-sample avg dev_std = 0.026)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.657
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.615
SUFF++ for r=0.6 class 0.0 = 0.981 +- 0.013 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.6 class 1.0 = 0.966 +- 0.013 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.6 all KL = 0.992 +- 0.013 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.6 all L1 = 0.974 +- 0.028 (in-sample avg dev_std = 0.032)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.698
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.665
SUFF++ for r=0.9 class 0.0 = 0.985 +- 0.015 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.9 class 1.0 = 0.96 +- 0.015 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.9 all KL = 0.994 +- 0.015 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.9 all L1 = 0.972 +- 0.039 (in-sample avg dev_std = 0.032)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.582
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.559
SUFF++ for r=0.3 class 0.0 = 0.99 +- 0.011 (in-sample avg dev_std = 0.027)
SUFF++ for r=0.3 class 1.0 = 0.981 +- 0.011 (in-sample avg dev_std = 0.027)
SUFF++ for r=0.3 all KL = 0.996 +- 0.011 (in-sample avg dev_std = 0.027)
SUFF++ for r=0.3 all L1 = 0.986 +- 0.018 (in-sample avg dev_std = 0.027)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.62
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.569
SUFF++ for r=0.6 class 0.0 = 0.986 +- 0.014 (in-sample avg dev_std = 0.026)
SUFF++ for r=0.6 class 1.0 = 0.972 +- 0.014 (in-sample avg dev_std = 0.026)
SUFF++ for r=0.6 all KL = 0.994 +- 0.014 (in-sample avg dev_std = 0.026)
SUFF++ for r=0.6 all L1 = 0.979 +- 0.030 (in-sample avg dev_std = 0.026)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.667
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.64
SUFF++ for r=0.9 class 0.0 = 0.986 +- 0.011 (in-sample avg dev_std = 0.024)
SUFF++ for r=0.9 class 1.0 = 0.976 +- 0.011 (in-sample avg dev_std = 0.024)
SUFF++ for r=0.9 all KL = 0.996 +- 0.011 (in-sample avg dev_std = 0.024)
SUFF++ for r=0.9 all L1 = 0.981 +- 0.032 (in-sample avg dev_std = 0.024)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.574
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.562
NEC for r=0.3 class 0.0 = 0.009 +- 0.021 (in-sample avg dev_std = 0.025)
NEC for r=0.3 class 1.0 = 0.02 +- 0.021 (in-sample avg dev_std = 0.025)
NEC for r=0.3 all KL = 0.005 +- 0.021 (in-sample avg dev_std = 0.025)
NEC for r=0.3 all L1 = 0.014 +- 0.025 (in-sample avg dev_std = 0.025)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.653
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.658
NEC for r=0.6 class 0.0 = 0.009 +- 0.028 (in-sample avg dev_std = 0.041)
NEC for r=0.6 class 1.0 = 0.043 +- 0.028 (in-sample avg dev_std = 0.041)
NEC for r=0.6 all KL = 0.01 +- 0.028 (in-sample avg dev_std = 0.041)
NEC for r=0.6 all L1 = 0.026 +- 0.050 (in-sample avg dev_std = 0.041)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.736
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.724
NEC for r=0.9 class 0.0 = 0.01 +- 0.019 (in-sample avg dev_std = 0.050)
NEC for r=0.9 class 1.0 = 0.046 +- 0.019 (in-sample avg dev_std = 0.050)
NEC for r=0.9 all KL = 0.007 +- 0.019 (in-sample avg dev_std = 0.050)
NEC for r=0.9 all L1 = 0.028 +- 0.053 (in-sample avg dev_std = 0.050)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.744
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 352
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.738
NEC for r=1.0 class 0.0 = 0.012 +- 0.022 (in-sample avg dev_std = 0.055)
NEC for r=1.0 class 1.0 = 0.047 +- 0.022 (in-sample avg dev_std = 0.055)
NEC for r=1.0 all KL = 0.008 +- 0.022 (in-sample avg dev_std = 0.055)
NEC for r=1.0 all L1 = 0.029 +- 0.057 (in-sample avg dev_std = 0.055)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.639
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.556
NEC for r=0.3 class 0.0 = 0.01 +- 0.011 (in-sample avg dev_std = 0.017)
NEC for r=0.3 class 1.0 = 0.026 +- 0.011 (in-sample avg dev_std = 0.017)
NEC for r=0.3 all KL = 0.005 +- 0.011 (in-sample avg dev_std = 0.017)
NEC for r=0.3 all L1 = 0.018 +- 0.026 (in-sample avg dev_std = 0.017)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.593
NEC for r=0.6 class 0.0 = 0.015 +- 0.013 (in-sample avg dev_std = 0.029)
NEC for r=0.6 class 1.0 = 0.033 +- 0.013 (in-sample avg dev_std = 0.029)
NEC for r=0.6 all KL = 0.007 +- 0.013 (in-sample avg dev_std = 0.029)
NEC for r=0.6 all L1 = 0.024 +- 0.028 (in-sample avg dev_std = 0.029)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.698
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.683
NEC for r=0.9 class 0.0 = 0.019 +- 0.015 (in-sample avg dev_std = 0.037)
NEC for r=0.9 class 1.0 = 0.041 +- 0.015 (in-sample avg dev_std = 0.037)
NEC for r=0.9 all KL = 0.008 +- 0.015 (in-sample avg dev_std = 0.037)
NEC for r=0.9 all L1 = 0.03 +- 0.037 (in-sample avg dev_std = 0.037)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.688
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 252
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.689
NEC for r=1.0 class 0.0 = 0.019 +- 0.011 (in-sample avg dev_std = 0.034)
NEC for r=1.0 class 1.0 = 0.037 +- 0.011 (in-sample avg dev_std = 0.034)
NEC for r=1.0 all KL = 0.006 +- 0.011 (in-sample avg dev_std = 0.034)
NEC for r=1.0 all L1 = 0.028 +- 0.033 (in-sample avg dev_std = 0.034)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.582
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.557
NEC for r=0.3 class 0.0 = 0.008 +- 0.007 (in-sample avg dev_std = 0.014)
NEC for r=0.3 class 1.0 = 0.016 +- 0.007 (in-sample avg dev_std = 0.014)
NEC for r=0.3 all KL = 0.003 +- 0.007 (in-sample avg dev_std = 0.014)
NEC for r=0.3 all L1 = 0.012 +- 0.018 (in-sample avg dev_std = 0.014)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.62
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.622
NEC for r=0.6 class 0.0 = 0.011 +- 0.017 (in-sample avg dev_std = 0.022)
NEC for r=0.6 class 1.0 = 0.026 +- 0.017 (in-sample avg dev_std = 0.022)
NEC for r=0.6 all KL = 0.005 +- 0.017 (in-sample avg dev_std = 0.022)
NEC for r=0.6 all L1 = 0.019 +- 0.033 (in-sample avg dev_std = 0.022)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.667
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.644
NEC for r=0.9 class 0.0 = 0.015 +- 0.009 (in-sample avg dev_std = 0.026)
NEC for r=0.9 class 1.0 = 0.027 +- 0.009 (in-sample avg dev_std = 0.026)
NEC for r=0.9 all KL = 0.005 +- 0.009 (in-sample avg dev_std = 0.026)
NEC for r=0.9 all L1 = 0.021 +- 0.030 (in-sample avg dev_std = 0.026)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.648
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.631
NEC for r=1.0 class 0.0 = 0.016 +- 0.015 (in-sample avg dev_std = 0.027)
NEC for r=1.0 class 1.0 = 0.035 +- 0.015 (in-sample avg dev_std = 0.027)
NEC for r=1.0 all KL = 0.006 +- 0.015 (in-sample avg dev_std = 0.027)
NEC for r=1.0 all L1 = 0.026 +- 0.039 (in-sample avg dev_std = 0.027)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 13:47:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:37 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:40 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:43 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:47 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 01:47:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ROC-AUC: 0.9193
Train Loss: 0.0894
ID Validation ROC-AUC: 0.8354
ID Validation Loss: 0.1257
ID Test ROC-AUC: 0.8084
ID Test Loss: 0.1109
OOD Validation ROC-AUC: 0.7601
OOD Validation Loss: 0.1176
OOD Test ROC-AUC: 0.7290
OOD Test Loss: 0.0872

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ROC-AUC: 0.8677
Train Loss: 0.1098
ID Validation ROC-AUC: 0.8315
ID Validation Loss: 0.1337
ID Test ROC-AUC: 0.8039
ID Test Loss: 0.1138
OOD Validation ROC-AUC: 0.7858
OOD Validation Loss: 0.1065
OOD Test ROC-AUC: 0.7517
OOD Test Loss: 0.0875

[0m[1;37mINFO[0m: [1mChartInfo 0.8084 0.7290 0.8039 0.7517 0.8315 0.7858[0mGOODHIV(4112)
Data example from id_val: Data(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
Label distribution from id_val: (tensor([0., 1.]), tensor([3936,  176]))
[1;34mDEBUG[0m: 04/22/2024 01:47:50 PM : [1mUnbalanced warning for GOODHIV (id_val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([176, 176]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4113)
Data example from val: Data(x=[33, 9], edge_index=[2, 74], edge_attr=[74, 3], y=[1, 1], smiles='OC(c1ccccc1)c1c(-c2ccccc2)[nH]c(-c2ccccc2)c1C(O)c1ccccc1', idx=[1], scaffold='c1ccc(Cc2c(-c3ccccc3)[nH]c(-c3ccccc3)c2Cc2ccccc2)cc1', domain_id=[1], ori_edge_index=[2, 74], node_perm=[33])
Label distribution from val: (tensor([0., 1.]), tensor([3987,  126]))
[1;34mDEBUG[0m: 04/22/2024 01:47:52 PM : [1mUnbalanced warning for GOODHIV (val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([126, 126]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 04/22/2024 01:47:53 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.61
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.583
SUFF++ for r=0.3 class 0.0 = 0.935 +- 0.054 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.3 class 1.0 = 0.905 +- 0.054 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.3 all KL = 0.952 +- 0.054 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.3 all L1 = 0.92 +- 0.071 (in-sample avg dev_std = 0.116)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.725
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.684
SUFF++ for r=0.6 class 0.0 = 0.922 +- 0.088 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.6 class 1.0 = 0.83 +- 0.088 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.6 all KL = 0.927 +- 0.088 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.6 all L1 = 0.876 +- 0.113 (in-sample avg dev_std = 0.175)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.755
SUFF++ for r=0.9 class 0.0 = 0.953 +- 0.064 (in-sample avg dev_std = 0.127)
SUFF++ for r=0.9 class 1.0 = 0.865 +- 0.064 (in-sample avg dev_std = 0.127)
SUFF++ for r=0.9 all KL = 0.96 +- 0.064 (in-sample avg dev_std = 0.127)
SUFF++ for r=0.9 all L1 = 0.909 +- 0.104 (in-sample avg dev_std = 0.127)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.56
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.599
SUFF++ for r=0.3 class 0.0 = 0.907 +- 0.063 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.3 class 1.0 = 0.876 +- 0.063 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.3 all KL = 0.938 +- 0.063 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.3 all L1 = 0.892 +- 0.082 (in-sample avg dev_std = 0.141)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.619
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.656
SUFF++ for r=0.6 class 0.0 = 0.875 +- 0.113 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.6 class 1.0 = 0.788 +- 0.113 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.6 all KL = 0.902 +- 0.113 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.6 all L1 = 0.831 +- 0.123 (in-sample avg dev_std = 0.198)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.711
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.721
SUFF++ for r=0.9 class 0.0 = 0.921 +- 0.086 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.9 class 1.0 = 0.848 +- 0.086 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.9 all KL = 0.948 +- 0.086 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.9 all L1 = 0.885 +- 0.107 (in-sample avg dev_std = 0.151)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.527
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.529
SUFF++ for r=0.3 class 0.0 = 0.955 +- 0.056 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.3 class 1.0 = 0.941 +- 0.056 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.3 all KL = 0.965 +- 0.056 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.3 all L1 = 0.948 +- 0.064 (in-sample avg dev_std = 0.107)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.612
SUFF++ for r=0.6 class 0.0 = 0.927 +- 0.071 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.6 class 1.0 = 0.874 +- 0.071 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.6 all KL = 0.944 +- 0.071 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.6 all L1 = 0.9 +- 0.100 (in-sample avg dev_std = 0.139)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.695
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.677
SUFF++ for r=0.9 class 0.0 = 0.953 +- 0.054 (in-sample avg dev_std = 0.112)
SUFF++ for r=0.9 class 1.0 = 0.884 +- 0.054 (in-sample avg dev_std = 0.112)
SUFF++ for r=0.9 all KL = 0.968 +- 0.054 (in-sample avg dev_std = 0.112)
SUFF++ for r=0.9 all L1 = 0.919 +- 0.093 (in-sample avg dev_std = 0.112)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.608
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.585
NEC for r=0.3 class 0.0 = 0.045 +- 0.057 (in-sample avg dev_std = 0.088)
NEC for r=0.3 class 1.0 = 0.08 +- 0.057 (in-sample avg dev_std = 0.088)
NEC for r=0.3 all KL = 0.03 +- 0.057 (in-sample avg dev_std = 0.088)
NEC for r=0.3 all L1 = 0.062 +- 0.080 (in-sample avg dev_std = 0.088)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.726
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.725
NEC for r=0.6 class 0.0 = 0.052 +- 0.074 (in-sample avg dev_std = 0.128)
NEC for r=0.6 class 1.0 = 0.143 +- 0.074 (in-sample avg dev_std = 0.128)
NEC for r=0.6 all KL = 0.046 +- 0.074 (in-sample avg dev_std = 0.128)
NEC for r=0.6 all L1 = 0.097 +- 0.104 (in-sample avg dev_std = 0.128)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.789
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.779
NEC for r=0.9 class 0.0 = 0.047 +- 0.060 (in-sample avg dev_std = 0.106)
NEC for r=0.9 class 1.0 = 0.126 +- 0.060 (in-sample avg dev_std = 0.106)
NEC for r=0.9 all KL = 0.035 +- 0.060 (in-sample avg dev_std = 0.106)
NEC for r=0.9 all L1 = 0.087 +- 0.097 (in-sample avg dev_std = 0.106)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.796
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 352
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.786
NEC for r=1.0 class 0.0 = 0.037 +- 0.042 (in-sample avg dev_std = 0.094)
NEC for r=1.0 class 1.0 = 0.111 +- 0.042 (in-sample avg dev_std = 0.094)
NEC for r=1.0 all KL = 0.024 +- 0.042 (in-sample avg dev_std = 0.094)
NEC for r=1.0 all L1 = 0.074 +- 0.086 (in-sample avg dev_std = 0.094)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.561
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.591
NEC for r=0.3 class 0.0 = 0.074 +- 0.076 (in-sample avg dev_std = 0.101)
NEC for r=0.3 class 1.0 = 0.104 +- 0.076 (in-sample avg dev_std = 0.101)
NEC for r=0.3 all KL = 0.045 +- 0.076 (in-sample avg dev_std = 0.101)
NEC for r=0.3 all L1 = 0.089 +- 0.095 (in-sample avg dev_std = 0.101)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.618
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.683
NEC for r=0.6 class 0.0 = 0.092 +- 0.110 (in-sample avg dev_std = 0.131)
NEC for r=0.6 class 1.0 = 0.179 +- 0.110 (in-sample avg dev_std = 0.131)
NEC for r=0.6 all KL = 0.068 +- 0.110 (in-sample avg dev_std = 0.131)
NEC for r=0.6 all L1 = 0.136 +- 0.126 (in-sample avg dev_std = 0.131)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.71
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.734
NEC for r=0.9 class 0.0 = 0.08 +- 0.100 (in-sample avg dev_std = 0.120)
NEC for r=0.9 class 1.0 = 0.144 +- 0.100 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all KL = 0.05 +- 0.100 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all L1 = 0.112 +- 0.109 (in-sample avg dev_std = 0.120)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.739
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 252
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.748
NEC for r=1.0 class 0.0 = 0.065 +- 0.062 (in-sample avg dev_std = 0.103)
NEC for r=1.0 class 1.0 = 0.111 +- 0.062 (in-sample avg dev_std = 0.103)
NEC for r=1.0 all KL = 0.032 +- 0.062 (in-sample avg dev_std = 0.103)
NEC for r=1.0 all L1 = 0.088 +- 0.086 (in-sample avg dev_std = 0.103)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.527
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.525
NEC for r=0.3 class 0.0 = 0.037 +- 0.061 (in-sample avg dev_std = 0.055)
NEC for r=0.3 class 1.0 = 0.049 +- 0.061 (in-sample avg dev_std = 0.055)
NEC for r=0.3 all KL = 0.023 +- 0.061 (in-sample avg dev_std = 0.055)
NEC for r=0.3 all L1 = 0.043 +- 0.078 (in-sample avg dev_std = 0.055)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.622
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.626
NEC for r=0.6 class 0.0 = 0.048 +- 0.053 (in-sample avg dev_std = 0.082)
NEC for r=0.6 class 1.0 = 0.097 +- 0.053 (in-sample avg dev_std = 0.082)
NEC for r=0.6 all KL = 0.029 +- 0.053 (in-sample avg dev_std = 0.082)
NEC for r=0.6 all L1 = 0.073 +- 0.093 (in-sample avg dev_std = 0.082)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.696
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.696
NEC for r=0.9 class 0.0 = 0.041 +- 0.049 (in-sample avg dev_std = 0.083)
NEC for r=0.9 class 1.0 = 0.096 +- 0.049 (in-sample avg dev_std = 0.083)
NEC for r=0.9 all KL = 0.023 +- 0.049 (in-sample avg dev_std = 0.083)
NEC for r=0.9 all L1 = 0.069 +- 0.082 (in-sample avg dev_std = 0.083)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.725
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.709
NEC for r=1.0 class 0.0 = 0.039 +- 0.034 (in-sample avg dev_std = 0.080)
NEC for r=1.0 class 1.0 = 0.086 +- 0.034 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all KL = 0.018 +- 0.034 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all L1 = 0.063 +- 0.076 (in-sample avg dev_std = 0.080)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 13:49:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:07 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:11 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:14 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:17 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 01:49:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ROC-AUC: 0.9408
Train Loss: 0.0845
ID Validation ROC-AUC: 0.8353
ID Validation Loss: 0.1363
ID Test ROC-AUC: 0.8180
ID Test Loss: 0.1216
OOD Validation ROC-AUC: 0.7710
OOD Validation Loss: 0.1283
OOD Test ROC-AUC: 0.7279
OOD Test Loss: 0.0901

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9312
Train Loss: 0.0842
ID Validation ROC-AUC: 0.8199
ID Validation Loss: 0.1342
ID Test ROC-AUC: 0.7980
ID Test Loss: 0.1163
OOD Validation ROC-AUC: 0.7737
OOD Validation Loss: 0.1243
OOD Test ROC-AUC: 0.7203
OOD Test Loss: 0.0949

[0m[1;37mINFO[0m: [1mChartInfo 0.8180 0.7279 0.7980 0.7203 0.8199 0.7737[0mGOODHIV(4112)
Data example from id_val: Data(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
Label distribution from id_val: (tensor([0., 1.]), tensor([3936,  176]))
[1;34mDEBUG[0m: 04/22/2024 01:49:21 PM : [1mUnbalanced warning for GOODHIV (id_val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([176, 176]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4113)
Data example from val: Data(x=[33, 9], edge_index=[2, 74], edge_attr=[74, 3], y=[1, 1], smiles='OC(c1ccccc1)c1c(-c2ccccc2)[nH]c(-c2ccccc2)c1C(O)c1ccccc1', idx=[1], scaffold='c1ccc(Cc2c(-c3ccccc3)[nH]c(-c3ccccc3)c2Cc2ccccc2)cc1', domain_id=[1], ori_edge_index=[2, 74], node_perm=[33])
Label distribution from val: (tensor([0., 1.]), tensor([3987,  126]))
[1;34mDEBUG[0m: 04/22/2024 01:49:22 PM : [1mUnbalanced warning for GOODHIV (val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([126, 126]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 04/22/2024 01:49:24 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.736
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.658
SUFF++ for r=0.3 class 0.0 = 0.821 +- 0.112 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 1.0 = 0.755 +- 0.112 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 all KL = 0.862 +- 0.112 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 all L1 = 0.788 +- 0.112 (in-sample avg dev_std = 0.250)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.73
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.675
SUFF++ for r=0.6 class 0.0 = 0.823 +- 0.123 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 1.0 = 0.734 +- 0.123 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 all KL = 0.872 +- 0.123 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 all L1 = 0.778 +- 0.150 (in-sample avg dev_std = 0.256)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.709
SUFF++ for r=0.9 class 0.0 = 0.915 +- 0.071 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.9 class 1.0 = 0.839 +- 0.071 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.9 all KL = 0.953 +- 0.071 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.9 all L1 = 0.877 +- 0.121 (in-sample avg dev_std = 0.154)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.612
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.6
SUFF++ for r=0.3 class 0.0 = 0.807 +- 0.101 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.3 class 1.0 = 0.752 +- 0.101 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.3 all KL = 0.867 +- 0.101 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.3 all L1 = 0.779 +- 0.100 (in-sample avg dev_std = 0.239)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.607
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.598
SUFF++ for r=0.6 class 0.0 = 0.787 +- 0.108 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 class 1.0 = 0.732 +- 0.108 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 all KL = 0.873 +- 0.108 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 all L1 = 0.759 +- 0.126 (in-sample avg dev_std = 0.247)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.646
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 251
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.645
SUFF++ for r=0.9 class 0.0 = 0.896 +- 0.069 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 class 1.0 = 0.821 +- 0.069 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 all KL = 0.952 +- 0.069 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 all L1 = 0.859 +- 0.115 (in-sample avg dev_std = 0.148)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.573
SUFF++ for r=0.3 class 0.0 = 0.879 +- 0.106 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.3 class 1.0 = 0.805 +- 0.106 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.3 all KL = 0.891 +- 0.106 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.3 all L1 = 0.842 +- 0.119 (in-sample avg dev_std = 0.205)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.697
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.646
SUFF++ for r=0.6 class 0.0 = 0.872 +- 0.108 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 class 1.0 = 0.767 +- 0.108 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 all KL = 0.889 +- 0.108 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 all L1 = 0.819 +- 0.134 (in-sample avg dev_std = 0.228)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.693
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.665
SUFF++ for r=0.9 class 0.0 = 0.93 +- 0.078 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.9 class 1.0 = 0.854 +- 0.078 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.9 all KL = 0.954 +- 0.078 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.9 all L1 = 0.892 +- 0.119 (in-sample avg dev_std = 0.149)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.736
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.694
NEC for r=0.3 class 0.0 = 0.134 +- 0.113 (in-sample avg dev_std = 0.169)
NEC for r=0.3 class 1.0 = 0.212 +- 0.113 (in-sample avg dev_std = 0.169)
NEC for r=0.3 all KL = 0.088 +- 0.113 (in-sample avg dev_std = 0.169)
NEC for r=0.3 all L1 = 0.173 +- 0.139 (in-sample avg dev_std = 0.169)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.73
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.713
NEC for r=0.6 class 0.0 = 0.136 +- 0.119 (in-sample avg dev_std = 0.199)
NEC for r=0.6 class 1.0 = 0.232 +- 0.119 (in-sample avg dev_std = 0.199)
NEC for r=0.6 all KL = 0.089 +- 0.119 (in-sample avg dev_std = 0.199)
NEC for r=0.6 all L1 = 0.184 +- 0.156 (in-sample avg dev_std = 0.199)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.698
NEC for r=0.9 class 0.0 = 0.09 +- 0.094 (in-sample avg dev_std = 0.169)
NEC for r=0.9 class 1.0 = 0.162 +- 0.094 (in-sample avg dev_std = 0.169)
NEC for r=0.9 all KL = 0.055 +- 0.094 (in-sample avg dev_std = 0.169)
NEC for r=0.9 all L1 = 0.126 +- 0.128 (in-sample avg dev_std = 0.169)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.738
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 352
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.702
NEC for r=1.0 class 0.0 = 0.079 +- 0.095 (in-sample avg dev_std = 0.163)
NEC for r=1.0 class 1.0 = 0.147 +- 0.095 (in-sample avg dev_std = 0.163)
NEC for r=1.0 all KL = 0.051 +- 0.095 (in-sample avg dev_std = 0.163)
NEC for r=1.0 all L1 = 0.113 +- 0.125 (in-sample avg dev_std = 0.163)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.612
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.661
NEC for r=0.3 class 0.0 = 0.15 +- 0.114 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 1.0 = 0.255 +- 0.114 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all KL = 0.109 +- 0.114 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all L1 = 0.202 +- 0.135 (in-sample avg dev_std = 0.193)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.607
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.644
NEC for r=0.6 class 0.0 = 0.168 +- 0.111 (in-sample avg dev_std = 0.207)
NEC for r=0.6 class 1.0 = 0.257 +- 0.111 (in-sample avg dev_std = 0.207)
NEC for r=0.6 all KL = 0.1 +- 0.111 (in-sample avg dev_std = 0.207)
NEC for r=0.6 all L1 = 0.213 +- 0.136 (in-sample avg dev_std = 0.207)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.647
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.668
NEC for r=0.9 class 0.0 = 0.125 +- 0.084 (in-sample avg dev_std = 0.162)
NEC for r=0.9 class 1.0 = 0.194 +- 0.084 (in-sample avg dev_std = 0.162)
NEC for r=0.9 all KL = 0.061 +- 0.084 (in-sample avg dev_std = 0.162)
NEC for r=0.9 all L1 = 0.159 +- 0.120 (in-sample avg dev_std = 0.162)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.632
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 252
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.663
NEC for r=1.0 class 0.0 = 0.107 +- 0.080 (in-sample avg dev_std = 0.147)
NEC for r=1.0 class 1.0 = 0.169 +- 0.080 (in-sample avg dev_std = 0.147)
NEC for r=1.0 all KL = 0.049 +- 0.080 (in-sample avg dev_std = 0.147)
NEC for r=1.0 all L1 = 0.138 +- 0.114 (in-sample avg dev_std = 0.147)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.624
NEC for r=0.3 class 0.0 = 0.084 +- 0.107 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 1.0 = 0.161 +- 0.107 (in-sample avg dev_std = 0.144)
NEC for r=0.3 all KL = 0.07 +- 0.107 (in-sample avg dev_std = 0.144)
NEC for r=0.3 all L1 = 0.122 +- 0.133 (in-sample avg dev_std = 0.144)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.697
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.663
NEC for r=0.6 class 0.0 = 0.071 +- 0.104 (in-sample avg dev_std = 0.140)
NEC for r=0.6 class 1.0 = 0.192 +- 0.104 (in-sample avg dev_std = 0.140)
NEC for r=0.6 all KL = 0.065 +- 0.104 (in-sample avg dev_std = 0.140)
NEC for r=0.6 all L1 = 0.132 +- 0.132 (in-sample avg dev_std = 0.140)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.692
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.701
NEC for r=0.9 class 0.0 = 0.05 +- 0.076 (in-sample avg dev_std = 0.132)
NEC for r=0.9 class 1.0 = 0.152 +- 0.076 (in-sample avg dev_std = 0.132)
NEC for r=0.9 all KL = 0.042 +- 0.076 (in-sample avg dev_std = 0.132)
NEC for r=0.9 all L1 = 0.101 +- 0.122 (in-sample avg dev_std = 0.132)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.696
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.692
NEC for r=1.0 class 0.0 = 0.047 +- 0.069 (in-sample avg dev_std = 0.135)
NEC for r=1.0 class 1.0 = 0.133 +- 0.069 (in-sample avg dev_std = 0.135)
NEC for r=1.0 all KL = 0.039 +- 0.069 (in-sample avg dev_std = 0.135)
NEC for r=1.0 all L1 = 0.09 +- 0.107 (in-sample avg dev_std = 0.135)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 13:50:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/22/2024 01:50:49 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 01:50:53 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 01:50:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:00 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ROC-AUC: 0.9672
Train Loss: 0.0711
ID Validation ROC-AUC: 0.8273
ID Validation Loss: 0.1308
ID Test ROC-AUC: 0.8111
ID Test Loss: 0.1127
OOD Validation ROC-AUC: 0.7208
OOD Validation Loss: 0.1246
OOD Test ROC-AUC: 0.6528
OOD Test Loss: 0.0969

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 38...
[0m[1;37mINFO[0m: [1mCheckpoint 38: 
-----------------------------------
Train ROC-AUC: 0.8696
Train Loss: 0.1264
ID Validation ROC-AUC: 0.8184
ID Validation Loss: 0.1532
ID Test ROC-AUC: 0.8196
ID Test Loss: 0.1278
OOD Validation ROC-AUC: 0.7775
OOD Validation Loss: 0.1197
OOD Test ROC-AUC: 0.7122
OOD Test Loss: 0.1159

[0m[1;37mINFO[0m: [1mChartInfo 0.8111 0.6528 0.8196 0.7122 0.8184 0.7775[0mGOODHIV(4112)
Data example from id_val: Data(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
Label distribution from id_val: (tensor([0., 1.]), tensor([3936,  176]))
[1;34mDEBUG[0m: 04/22/2024 01:51:03 PM : [1mUnbalanced warning for GOODHIV (id_val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([176, 176]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4113)
Data example from val: Data(x=[33, 9], edge_index=[2, 74], edge_attr=[74, 3], y=[1, 1], smiles='OC(c1ccccc1)c1c(-c2ccccc2)[nH]c(-c2ccccc2)c1C(O)c1ccccc1', idx=[1], scaffold='c1ccc(Cc2c(-c3ccccc3)[nH]c(-c3ccccc3)c2Cc2ccccc2)cc1', domain_id=[1], ori_edge_index=[2, 74], node_perm=[33])
Label distribution from val: (tensor([0., 1.]), tensor([3987,  126]))
[1;34mDEBUG[0m: 04/22/2024 01:51:05 PM : [1mUnbalanced warning for GOODHIV (val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([126, 126]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 04/22/2024 01:51:07 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.722
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.659
SUFF++ for r=0.3 class 0.0 = 0.848 +- 0.131 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 class 1.0 = 0.762 +- 0.131 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 all KL = 0.849 +- 0.131 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 all L1 = 0.805 +- 0.133 (in-sample avg dev_std = 0.266)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.749
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.691
SUFF++ for r=0.6 class 0.0 = 0.831 +- 0.109 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.6 class 1.0 = 0.775 +- 0.109 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.6 all KL = 0.889 +- 0.109 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.6 all L1 = 0.803 +- 0.130 (in-sample avg dev_std = 0.237)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.765
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.751
SUFF++ for r=0.9 class 0.0 = 0.891 +- 0.064 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 class 1.0 = 0.864 +- 0.064 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 all KL = 0.958 +- 0.064 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 all L1 = 0.878 +- 0.104 (in-sample avg dev_std = 0.148)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.779
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.704
SUFF++ for r=0.3 class 0.0 = 0.827 +- 0.129 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 class 1.0 = 0.734 +- 0.129 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 all KL = 0.826 +- 0.129 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 all L1 = 0.78 +- 0.112 (in-sample avg dev_std = 0.284)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.77
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.737
SUFF++ for r=0.6 class 0.0 = 0.801 +- 0.108 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.6 class 1.0 = 0.785 +- 0.108 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.6 all KL = 0.895 +- 0.108 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.6 all L1 = 0.793 +- 0.102 (in-sample avg dev_std = 0.226)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.765
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.744
SUFF++ for r=0.9 class 0.0 = 0.868 +- 0.052 (in-sample avg dev_std = 0.143)
SUFF++ for r=0.9 class 1.0 = 0.851 +- 0.052 (in-sample avg dev_std = 0.143)
SUFF++ for r=0.9 all KL = 0.958 +- 0.052 (in-sample avg dev_std = 0.143)
SUFF++ for r=0.9 all L1 = 0.86 +- 0.092 (in-sample avg dev_std = 0.143)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.616
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.599
SUFF++ for r=0.3 class 0.0 = 0.932 +- 0.087 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 class 1.0 = 0.89 +- 0.087 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 all KL = 0.924 +- 0.087 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 all L1 = 0.911 +- 0.093 (in-sample avg dev_std = 0.170)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.588
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.596
SUFF++ for r=0.6 class 0.0 = 0.877 +- 0.111 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 class 1.0 = 0.828 +- 0.111 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all KL = 0.89 +- 0.111 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all L1 = 0.853 +- 0.118 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.631
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.623
SUFF++ for r=0.9 class 0.0 = 0.917 +- 0.050 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.9 class 1.0 = 0.88 +- 0.050 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.9 all KL = 0.96 +- 0.050 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.9 all L1 = 0.898 +- 0.090 (in-sample avg dev_std = 0.146)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.722
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.693
NEC for r=0.3 class 0.0 = 0.096 +- 0.108 (in-sample avg dev_std = 0.152)
NEC for r=0.3 class 1.0 = 0.192 +- 0.108 (in-sample avg dev_std = 0.152)
NEC for r=0.3 all KL = 0.077 +- 0.108 (in-sample avg dev_std = 0.152)
NEC for r=0.3 all L1 = 0.144 +- 0.149 (in-sample avg dev_std = 0.152)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.749
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.709
NEC for r=0.6 class 0.0 = 0.128 +- 0.093 (in-sample avg dev_std = 0.175)
NEC for r=0.6 class 1.0 = 0.202 +- 0.093 (in-sample avg dev_std = 0.175)
NEC for r=0.6 all KL = 0.072 +- 0.093 (in-sample avg dev_std = 0.175)
NEC for r=0.6 all L1 = 0.165 +- 0.142 (in-sample avg dev_std = 0.175)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.765
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.737
NEC for r=0.9 class 0.0 = 0.109 +- 0.072 (in-sample avg dev_std = 0.160)
NEC for r=0.9 class 1.0 = 0.17 +- 0.072 (in-sample avg dev_std = 0.160)
NEC for r=0.9 all KL = 0.049 +- 0.072 (in-sample avg dev_std = 0.160)
NEC for r=0.9 all L1 = 0.139 +- 0.122 (in-sample avg dev_std = 0.160)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.779
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 352
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.742
NEC for r=1.0 class 0.0 = 0.091 +- 0.073 (in-sample avg dev_std = 0.161)
NEC for r=1.0 class 1.0 = 0.156 +- 0.073 (in-sample avg dev_std = 0.161)
NEC for r=1.0 all KL = 0.043 +- 0.073 (in-sample avg dev_std = 0.161)
NEC for r=1.0 all L1 = 0.124 +- 0.119 (in-sample avg dev_std = 0.161)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.781
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.725
NEC for r=0.3 class 0.0 = 0.104 +- 0.116 (in-sample avg dev_std = 0.171)
NEC for r=0.3 class 1.0 = 0.219 +- 0.116 (in-sample avg dev_std = 0.171)
NEC for r=0.3 all KL = 0.087 +- 0.116 (in-sample avg dev_std = 0.171)
NEC for r=0.3 all L1 = 0.161 +- 0.155 (in-sample avg dev_std = 0.171)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.77
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.745
NEC for r=0.6 class 0.0 = 0.155 +- 0.075 (in-sample avg dev_std = 0.176)
NEC for r=0.6 class 1.0 = 0.199 +- 0.075 (in-sample avg dev_std = 0.176)
NEC for r=0.6 all KL = 0.071 +- 0.075 (in-sample avg dev_std = 0.176)
NEC for r=0.6 all L1 = 0.177 +- 0.113 (in-sample avg dev_std = 0.176)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.766
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.756
NEC for r=0.9 class 0.0 = 0.132 +- 0.059 (in-sample avg dev_std = 0.140)
NEC for r=0.9 class 1.0 = 0.161 +- 0.059 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all KL = 0.043 +- 0.059 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all L1 = 0.146 +- 0.106 (in-sample avg dev_std = 0.140)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.77
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 252
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.76
NEC for r=1.0 class 0.0 = 0.115 +- 0.057 (in-sample avg dev_std = 0.139)
NEC for r=1.0 class 1.0 = 0.165 +- 0.057 (in-sample avg dev_std = 0.139)
NEC for r=1.0 all KL = 0.04 +- 0.057 (in-sample avg dev_std = 0.139)
NEC for r=1.0 all L1 = 0.14 +- 0.104 (in-sample avg dev_std = 0.139)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.616
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.607
NEC for r=0.3 class 0.0 = 0.06 +- 0.082 (in-sample avg dev_std = 0.111)
NEC for r=0.3 class 1.0 = 0.08 +- 0.082 (in-sample avg dev_std = 0.111)
NEC for r=0.3 all KL = 0.041 +- 0.082 (in-sample avg dev_std = 0.111)
NEC for r=0.3 all L1 = 0.07 +- 0.107 (in-sample avg dev_std = 0.111)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.587
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.596
NEC for r=0.6 class 0.0 = 0.091 +- 0.089 (in-sample avg dev_std = 0.138)
NEC for r=0.6 class 1.0 = 0.119 +- 0.089 (in-sample avg dev_std = 0.138)
NEC for r=0.6 all KL = 0.059 +- 0.089 (in-sample avg dev_std = 0.138)
NEC for r=0.6 all L1 = 0.105 +- 0.111 (in-sample avg dev_std = 0.138)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.631
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.602
NEC for r=0.9 class 0.0 = 0.083 +- 0.048 (in-sample avg dev_std = 0.110)
NEC for r=0.9 class 1.0 = 0.108 +- 0.048 (in-sample avg dev_std = 0.110)
NEC for r=0.9 all KL = 0.033 +- 0.048 (in-sample avg dev_std = 0.110)
NEC for r=0.9 all L1 = 0.096 +- 0.095 (in-sample avg dev_std = 0.110)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.663
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.621
NEC for r=1.0 class 0.0 = 0.077 +- 0.048 (in-sample avg dev_std = 0.112)
NEC for r=1.0 class 1.0 = 0.11 +- 0.048 (in-sample avg dev_std = 0.112)
NEC for r=1.0 all KL = 0.032 +- 0.048 (in-sample avg dev_std = 0.112)
NEC for r=1.0 all L1 = 0.093 +- 0.093 (in-sample avg dev_std = 0.112)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 13:52:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:27 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:30 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:40 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:52:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 01:52:45 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 01:52:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 61...
[0m[1;37mINFO[0m: [1mCheckpoint 61: 
-----------------------------------
Train ROC-AUC: 0.9084
Train Loss: 0.0957
ID Validation ROC-AUC: 0.8316
ID Validation Loss: 0.1288
ID Test ROC-AUC: 0.8079
ID Test Loss: 0.1132
OOD Validation ROC-AUC: 0.7393
OOD Validation Loss: 0.1117
OOD Test ROC-AUC: 0.7327
OOD Test Loss: 0.0860

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 130...
[0m[1;37mINFO[0m: [1mCheckpoint 130: 
-----------------------------------
Train ROC-AUC: 0.9676
Train Loss: 0.0823
ID Validation ROC-AUC: 0.8098
ID Validation Loss: 0.1356
ID Test ROC-AUC: 0.8105
ID Test Loss: 0.1148
OOD Validation ROC-AUC: 0.7817
OOD Validation Loss: 0.1135
OOD Test ROC-AUC: 0.7377
OOD Test Loss: 0.0885

[0m[1;37mINFO[0m: [1mChartInfo 0.8079 0.7327 0.8105 0.7377 0.8098 0.7817[0mGOODHIV(4112)
Data example from id_val: Data(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
Label distribution from id_val: (tensor([0., 1.]), tensor([3936,  176]))
[1;34mDEBUG[0m: 04/22/2024 01:52:45 PM : [1mUnbalanced warning for GOODHIV (id_val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([176, 176]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4113)
Data example from val: Data(x=[33, 9], edge_index=[2, 74], edge_attr=[74, 3], y=[1, 1], smiles='OC(c1ccccc1)c1c(-c2ccccc2)[nH]c(-c2ccccc2)c1C(O)c1ccccc1', idx=[1], scaffold='c1ccc(Cc2c(-c3ccccc3)[nH]c(-c3ccccc3)c2Cc2ccccc2)cc1', domain_id=[1], ori_edge_index=[2, 74], node_perm=[33])
Label distribution from val: (tensor([0., 1.]), tensor([3987,  126]))
[1;34mDEBUG[0m: 04/22/2024 01:52:47 PM : [1mUnbalanced warning for GOODHIV (val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([126, 126]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 04/22/2024 01:52:48 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.734
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.663
SUFF++ for r=0.3 class 0.0 = 0.891 +- 0.081 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.3 class 1.0 = 0.808 +- 0.081 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.3 all KL = 0.906 +- 0.081 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.3 all L1 = 0.85 +- 0.105 (in-sample avg dev_std = 0.196)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.773
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.717
SUFF++ for r=0.6 class 0.0 = 0.826 +- 0.104 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.6 class 1.0 = 0.788 +- 0.104 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.6 all KL = 0.89 +- 0.104 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.6 all L1 = 0.807 +- 0.106 (in-sample avg dev_std = 0.239)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.8
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.763
SUFF++ for r=0.9 class 0.0 = 0.86 +- 0.072 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 class 1.0 = 0.854 +- 0.072 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 all KL = 0.944 +- 0.072 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 all L1 = 0.857 +- 0.100 (in-sample avg dev_std = 0.180)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.668
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.674
SUFF++ for r=0.3 class 0.0 = 0.864 +- 0.084 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.3 class 1.0 = 0.813 +- 0.084 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.3 all KL = 0.908 +- 0.084 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.3 all L1 = 0.839 +- 0.090 (in-sample avg dev_std = 0.203)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.711
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.69
SUFF++ for r=0.6 class 0.0 = 0.797 +- 0.089 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.6 class 1.0 = 0.791 +- 0.089 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.6 all KL = 0.9 +- 0.089 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.6 all L1 = 0.794 +- 0.090 (in-sample avg dev_std = 0.245)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.73
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 251
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.715
SUFF++ for r=0.9 class 0.0 = 0.858 +- 0.049 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 class 1.0 = 0.865 +- 0.049 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 all KL = 0.959 +- 0.049 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 all L1 = 0.862 +- 0.088 (in-sample avg dev_std = 0.163)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.622
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.597
SUFF++ for r=0.3 class 0.0 = 0.908 +- 0.068 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.3 class 1.0 = 0.884 +- 0.068 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.3 all KL = 0.935 +- 0.068 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.3 all L1 = 0.896 +- 0.075 (in-sample avg dev_std = 0.148)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.627
SUFF++ for r=0.6 class 0.0 = 0.889 +- 0.072 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.6 class 1.0 = 0.85 +- 0.072 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.6 all KL = 0.935 +- 0.072 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.6 all L1 = 0.87 +- 0.091 (in-sample avg dev_std = 0.172)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.651
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.645
SUFF++ for r=0.9 class 0.0 = 0.91 +- 0.037 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.9 class 1.0 = 0.893 +- 0.037 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.9 all KL = 0.971 +- 0.037 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.9 all L1 = 0.901 +- 0.069 (in-sample avg dev_std = 0.124)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.735
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.735
NEC for r=0.3 class 0.0 = 0.065 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 1.0 = 0.16 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all KL = 0.052 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all L1 = 0.113 +- 0.120 (in-sample avg dev_std = 0.114)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.773
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.762
NEC for r=0.6 class 0.0 = 0.09 +- 0.073 (in-sample avg dev_std = 0.130)
NEC for r=0.6 class 1.0 = 0.17 +- 0.073 (in-sample avg dev_std = 0.130)
NEC for r=0.6 all KL = 0.048 +- 0.073 (in-sample avg dev_std = 0.130)
NEC for r=0.6 all L1 = 0.13 +- 0.115 (in-sample avg dev_std = 0.130)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.8
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.765
NEC for r=0.9 class 0.0 = 0.114 +- 0.070 (in-sample avg dev_std = 0.145)
NEC for r=0.9 class 1.0 = 0.161 +- 0.070 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all KL = 0.047 +- 0.070 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all L1 = 0.137 +- 0.116 (in-sample avg dev_std = 0.145)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.808
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 352
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.777
NEC for r=1.0 class 0.0 = 0.109 +- 0.071 (in-sample avg dev_std = 0.148)
NEC for r=1.0 class 1.0 = 0.157 +- 0.071 (in-sample avg dev_std = 0.148)
NEC for r=1.0 all KL = 0.046 +- 0.071 (in-sample avg dev_std = 0.148)
NEC for r=1.0 all L1 = 0.133 +- 0.116 (in-sample avg dev_std = 0.148)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.668
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.706
NEC for r=0.3 class 0.0 = 0.085 +- 0.075 (in-sample avg dev_std = 0.125)
NEC for r=0.3 class 1.0 = 0.166 +- 0.075 (in-sample avg dev_std = 0.125)
NEC for r=0.3 all KL = 0.054 +- 0.075 (in-sample avg dev_std = 0.125)
NEC for r=0.3 all L1 = 0.126 +- 0.113 (in-sample avg dev_std = 0.125)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.71
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.724
NEC for r=0.6 class 0.0 = 0.114 +- 0.055 (in-sample avg dev_std = 0.124)
NEC for r=0.6 class 1.0 = 0.157 +- 0.055 (in-sample avg dev_std = 0.124)
NEC for r=0.6 all KL = 0.04 +- 0.055 (in-sample avg dev_std = 0.124)
NEC for r=0.6 all L1 = 0.136 +- 0.092 (in-sample avg dev_std = 0.124)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.732
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.73
NEC for r=0.9 class 0.0 = 0.122 +- 0.038 (in-sample avg dev_std = 0.119)
NEC for r=0.9 class 1.0 = 0.139 +- 0.038 (in-sample avg dev_std = 0.119)
NEC for r=0.9 all KL = 0.031 +- 0.038 (in-sample avg dev_std = 0.119)
NEC for r=0.9 all L1 = 0.13 +- 0.084 (in-sample avg dev_std = 0.119)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.737
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 252
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.74
NEC for r=1.0 class 0.0 = 0.114 +- 0.034 (in-sample avg dev_std = 0.118)
NEC for r=1.0 class 1.0 = 0.131 +- 0.034 (in-sample avg dev_std = 0.118)
NEC for r=1.0 all KL = 0.028 +- 0.034 (in-sample avg dev_std = 0.118)
NEC for r=1.0 all L1 = 0.122 +- 0.085 (in-sample avg dev_std = 0.118)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.622
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.603
NEC for r=0.3 class 0.0 = 0.064 +- 0.065 (in-sample avg dev_std = 0.097)
NEC for r=0.3 class 1.0 = 0.095 +- 0.065 (in-sample avg dev_std = 0.097)
NEC for r=0.3 all KL = 0.038 +- 0.065 (in-sample avg dev_std = 0.097)
NEC for r=0.3 all L1 = 0.08 +- 0.086 (in-sample avg dev_std = 0.097)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.648
NEC for r=0.6 class 0.0 = 0.067 +- 0.047 (in-sample avg dev_std = 0.091)
NEC for r=0.6 class 1.0 = 0.118 +- 0.047 (in-sample avg dev_std = 0.091)
NEC for r=0.6 all KL = 0.03 +- 0.047 (in-sample avg dev_std = 0.091)
NEC for r=0.6 all L1 = 0.093 +- 0.090 (in-sample avg dev_std = 0.091)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.651
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.63
NEC for r=0.9 class 0.0 = 0.086 +- 0.053 (in-sample avg dev_std = 0.120)
NEC for r=0.9 class 1.0 = 0.115 +- 0.053 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all KL = 0.03 +- 0.053 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all L1 = 0.101 +- 0.091 (in-sample avg dev_std = 0.120)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.655
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.637
NEC for r=1.0 class 0.0 = 0.082 +- 0.053 (in-sample avg dev_std = 0.129)
NEC for r=1.0 class 1.0 = 0.115 +- 0.053 (in-sample avg dev_std = 0.129)
NEC for r=1.0 all KL = 0.03 +- 0.053 (in-sample avg dev_std = 0.129)
NEC for r=1.0 all L1 = 0.099 +- 0.090 (in-sample avg dev_std = 0.129)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.994, 0.99, 0.992, 1.0], 'all_L1': [0.984, 0.973, 0.972, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.952, 0.927, 0.96, 1.0], 'all_L1': [0.92, 0.876, 0.909, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.862, 0.872, 0.953, 1.0], 'all_L1': [0.788, 0.778, 0.877, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.849, 0.889, 0.958, 1.0], 'all_L1': [0.805, 0.803, 0.878, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.906, 0.89, 0.944, 1.0], 'all_L1': [0.85, 0.807, 0.857, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.005, 0.01, 0.007, 0.008], 'all_L1': [0.014, 0.026, 0.028, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.03, 0.046, 0.035, 0.024], 'all_L1': [0.062, 0.097, 0.087, 0.074]}), defaultdict(<class 'list'>, {'all_KL': [0.088, 0.089, 0.055, 0.051], 'all_L1': [0.173, 0.184, 0.126, 0.113]}), defaultdict(<class 'list'>, {'all_KL': [0.077, 0.072, 0.049, 0.043], 'all_L1': [0.144, 0.165, 0.139, 0.124]}), defaultdict(<class 'list'>, {'all_KL': [0.052, 0.048, 0.047, 0.046], 'all_L1': [0.113, 0.13, 0.137, 0.133]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.994, 0.992, 0.994, 1.0], 'all_L1': [0.979, 0.974, 0.972, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.938, 0.902, 0.948, 1.0], 'all_L1': [0.892, 0.831, 0.885, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.867, 0.873, 0.952, 1.0], 'all_L1': [0.779, 0.759, 0.859, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.826, 0.895, 0.958, 1.0], 'all_L1': [0.78, 0.793, 0.86, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.908, 0.9, 0.959, 1.0], 'all_L1': [0.839, 0.794, 0.862, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.005, 0.007, 0.008, 0.006], 'all_L1': [0.018, 0.024, 0.03, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.045, 0.068, 0.05, 0.032], 'all_L1': [0.089, 0.136, 0.112, 0.088]}), defaultdict(<class 'list'>, {'all_KL': [0.109, 0.1, 0.061, 0.049], 'all_L1': [0.202, 0.213, 0.159, 0.138]}), defaultdict(<class 'list'>, {'all_KL': [0.087, 0.071, 0.043, 0.04], 'all_L1': [0.161, 0.177, 0.146, 0.14]}), defaultdict(<class 'list'>, {'all_KL': [0.054, 0.04, 0.031, 0.028], 'all_L1': [0.126, 0.136, 0.13, 0.122]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.996, 0.994, 0.996, 1.0], 'all_L1': [0.986, 0.979, 0.981, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.965, 0.944, 0.968, 1.0], 'all_L1': [0.948, 0.9, 0.919, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.891, 0.889, 0.954, 1.0], 'all_L1': [0.842, 0.819, 0.892, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.924, 0.89, 0.96, 1.0], 'all_L1': [0.911, 0.853, 0.898, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.935, 0.935, 0.971, 1.0], 'all_L1': [0.896, 0.87, 0.901, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.003, 0.005, 0.005, 0.006], 'all_L1': [0.012, 0.019, 0.021, 0.026]}), defaultdict(<class 'list'>, {'all_KL': [0.023, 0.029, 0.023, 0.018], 'all_L1': [0.043, 0.073, 0.069, 0.063]}), defaultdict(<class 'list'>, {'all_KL': [0.07, 0.065, 0.042, 0.039], 'all_L1': [0.122, 0.132, 0.101, 0.09]}), defaultdict(<class 'list'>, {'all_KL': [0.041, 0.059, 0.033, 0.032], 'all_L1': [0.07, 0.105, 0.096, 0.093]}), defaultdict(<class 'list'>, {'all_KL': [0.038, 0.03, 0.03, 0.03], 'all_L1': [0.08, 0.093, 0.101, 0.099]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.869 +- 0.073, 0.847 +- 0.071, 0.899 +- 0.040, 1.000 +- 0.000
suff++ class all_KL  =  0.913 +- 0.054, 0.914 +- 0.042, 0.961 +- 0.016, 1.000 +- 0.000
suff++_acc_int  =  0.620 +- 0.050, 0.678 +- 0.031, 0.740 +- 0.021
nec class all_L1  =  0.101 +- 0.057, 0.120 +- 0.056, 0.103 +- 0.042, 0.095 +- 0.038
nec class all_KL  =  0.050 +- 0.030, 0.053 +- 0.027, 0.039 +- 0.017, 0.034 +- 0.016
nec_acc_int  =  0.654 +- 0.068, 0.714 +- 0.034, 0.740 +- 0.029, 0.749 +- 0.030

Eval split val
suff++ class all_L1  =  0.854 +- 0.075, 0.830 +- 0.075, 0.888 +- 0.043, 1.000 +- 0.000
suff++ class all_KL  =  0.907 +- 0.058, 0.912 +- 0.041, 0.962 +- 0.016, 1.000 +- 0.000
suff++_acc_int  =  0.629 +- 0.051, 0.659 +- 0.050, 0.698 +- 0.037
nec class all_L1  =  0.119 +- 0.063, 0.137 +- 0.063, 0.115 +- 0.046, 0.103 +- 0.042
nec class all_KL  =  0.060 +- 0.036, 0.057 +- 0.031, 0.039 +- 0.018, 0.031 +- 0.014
nec_acc_int  =  0.648 +- 0.065, 0.678 +- 0.055, 0.714 +- 0.033, 0.720 +- 0.037

Eval split test
suff++ class all_L1  =  0.917 +- 0.049, 0.884 +- 0.054, 0.918 +- 0.033, 1.000 +- 0.000
suff++ class all_KL  =  0.942 +- 0.036, 0.930 +- 0.039, 0.970 +- 0.014, 1.000 +- 0.000
suff++_acc_int  =  0.571 +- 0.026, 0.610 +- 0.026, 0.650 +- 0.019
nec class all_L1  =  0.065 +- 0.037, 0.084 +- 0.038, 0.078 +- 0.031, 0.074 +- 0.027
nec class all_KL  =  0.035 +- 0.022, 0.038 +- 0.022, 0.027 +- 0.012, 0.025 +- 0.012
nec_acc_int  =  0.583 +- 0.037, 0.631 +- 0.023, 0.654 +- 0.038, 0.658 +- 0.035


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.485 +- 0.009, 0.484 +- 0.010, 0.501 +- 0.004, 0.547 +- 0.019
Faith. Armon (L1)= 		  =  0.174 +- 0.092, 0.204 +- 0.088, 0.182 +- 0.070, 0.171 +- 0.066
Faith. GMean (L1)= 	  =  0.275 +- 0.090, 0.303 +- 0.078, 0.294 +- 0.069, 0.299 +- 0.072
Faith. Aritm (KL)= 		  =  0.481 +- 0.013, 0.483 +- 0.010, 0.500 +- 0.003, 0.517 +- 0.008
Faith. Armon (KL)= 		  =  0.093 +- 0.055, 0.099 +- 0.048, 0.074 +- 0.032, 0.066 +- 0.030
Faith. GMean (KL)= 	  =  0.198 +- 0.073, 0.209 +- 0.061, 0.185 +- 0.053, 0.178 +- 0.051

Eval split val
Faith. Aritm (L1)= 		  =  0.486 +- 0.009, 0.484 +- 0.011, 0.502 +- 0.004, 0.552 +- 0.021
Faith. Armon (L1)= 		  =  0.201 +- 0.098, 0.227 +- 0.098, 0.200 +- 0.075, 0.184 +- 0.072
Faith. GMean (L1)= 	  =  0.298 +- 0.091, 0.319 +- 0.087, 0.309 +- 0.071, 0.312 +- 0.077
Faith. Aritm (KL)= 		  =  0.483 +- 0.015, 0.485 +- 0.009, 0.500 +- 0.004, 0.515 +- 0.007
Faith. Armon (KL)= 		  =  0.110 +- 0.063, 0.106 +- 0.056, 0.074 +- 0.034, 0.060 +- 0.027
Faith. GMean (KL)= 	  =  0.215 +- 0.080, 0.214 +- 0.073, 0.185 +- 0.053, 0.169 +- 0.049

Eval split test
Faith. Aritm (L1)= 		  =  0.491 +- 0.006, 0.484 +- 0.008, 0.498 +- 0.003, 0.537 +- 0.014
Faith. Armon (L1)= 		  =  0.119 +- 0.064, 0.151 +- 0.064, 0.141 +- 0.054, 0.137 +- 0.048
Faith. GMean (L1)= 	  =  0.230 +- 0.072, 0.261 +- 0.067, 0.258 +- 0.060, 0.266 +- 0.057
Faith. Aritm (KL)= 		  =  0.489 +- 0.007, 0.484 +- 0.009, 0.498 +- 0.002, 0.512 +- 0.006
Faith. Armon (KL)= 		  =  0.066 +- 0.041, 0.071 +- 0.040, 0.051 +- 0.024, 0.049 +- 0.022
Faith. GMean (KL)= 	  =  0.167 +- 0.065, 0.175 +- 0.060, 0.154 +- 0.045, 0.152 +- 0.043
Computed for split load_split = id



Completed in  0:08:08.154155  for GSATvGIN GOODHIV/scaffold



DONE GSAT GOODHIV/scaffold

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 13:54:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:41 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:41 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:41 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 01:54:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9513
Train Loss: 0.1416
ID Validation ACCURACY: 0.8979
ID Validation Loss: 0.3406
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3538
OOD Validation ACCURACY: 0.7780
OOD Validation Loss: 0.8665
OOD Test ACCURACY: 0.2856
OOD Test Loss: 5.0562

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.8921
Train Loss: 0.3223
ID Validation ACCURACY: 0.8611
ID Validation Loss: 0.4189
ID Test ACCURACY: 0.8610
ID Test Loss: 0.4250
OOD Validation ACCURACY: 0.8180
OOD Validation Loss: 0.5733
OOD Test ACCURACY: 0.3071
OOD Test Loss: 3.0050

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.2856 0.8610 0.3071 0.8611 0.8180[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.094
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
SUFF++ for r=0.3 class 0 = 0.801 +- 0.251 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 1 = 0.902 +- 0.251 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 2 = 0.748 +- 0.251 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 3 = 0.849 +- 0.251 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 4 = 0.657 +- 0.251 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 5 = 0.779 +- 0.251 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 6 = 0.805 +- 0.251 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 7 = 0.678 +- 0.251 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 8 = 0.815 +- 0.251 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 9 = 0.799 +- 0.251 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 all KL = 0.793 +- 0.251 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 all L1 = 0.785 +- 0.231 (in-sample avg dev_std = 0.279)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.132
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.125
SUFF++ for r=0.6 class 0 = 0.305 +- 0.210 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.6 class 1 = 0.539 +- 0.210 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.6 class 2 = 0.381 +- 0.210 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.6 class 3 = 0.372 +- 0.210 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.6 class 4 = 0.353 +- 0.210 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.6 class 5 = 0.352 +- 0.210 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.6 class 6 = 0.329 +- 0.210 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.6 class 7 = 0.364 +- 0.210 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.6 class 8 = 0.31 +- 0.210 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.6 class 9 = 0.341 +- 0.210 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.6 all KL = 0.274 +- 0.210 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.6 all L1 = 0.368 +- 0.144 (in-sample avg dev_std = 0.501)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.794
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.387
SUFF++ for r=0.9 class 0 = 0.272 +- 0.212 (in-sample avg dev_std = 0.662)
SUFF++ for r=0.9 class 1 = 0.303 +- 0.212 (in-sample avg dev_std = 0.662)
SUFF++ for r=0.9 class 2 = 0.348 +- 0.212 (in-sample avg dev_std = 0.662)
SUFF++ for r=0.9 class 3 = 0.327 +- 0.212 (in-sample avg dev_std = 0.662)
SUFF++ for r=0.9 class 4 = 0.347 +- 0.212 (in-sample avg dev_std = 0.662)
SUFF++ for r=0.9 class 5 = 0.336 +- 0.212 (in-sample avg dev_std = 0.662)
SUFF++ for r=0.9 class 6 = 0.343 +- 0.212 (in-sample avg dev_std = 0.662)
SUFF++ for r=0.9 class 7 = 0.681 +- 0.212 (in-sample avg dev_std = 0.662)
SUFF++ for r=0.9 class 8 = 0.343 +- 0.212 (in-sample avg dev_std = 0.662)
SUFF++ for r=0.9 class 9 = 0.34 +- 0.212 (in-sample avg dev_std = 0.662)
SUFF++ for r=0.9 all KL = 0.157 +- 0.212 (in-sample avg dev_std = 0.662)
SUFF++ for r=0.9 all L1 = 0.367 +- 0.165 (in-sample avg dev_std = 0.662)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.657 +- 0.292 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 1 = 0.765 +- 0.292 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 2 = 0.614 +- 0.292 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 3 = 0.634 +- 0.292 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 4 = 0.675 +- 0.292 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 5 = 0.61 +- 0.292 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 6 = 0.784 +- 0.292 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 7 = 0.686 +- 0.292 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 8 = 0.689 +- 0.292 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 9 = 0.731 +- 0.292 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 all KL = 0.683 +- 0.292 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 all L1 = 0.687 +- 0.250 (in-sample avg dev_std = 0.385)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.11
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.101
SUFF++ for r=0.6 class 0 = 0.345 +- 0.171 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.6 class 1 = 0.378 +- 0.171 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.6 class 2 = 0.419 +- 0.171 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.6 class 3 = 0.403 +- 0.171 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.6 class 4 = 0.396 +- 0.171 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.6 class 5 = 0.422 +- 0.171 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.6 class 6 = 0.401 +- 0.171 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.6 class 7 = 0.395 +- 0.171 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.6 class 8 = 0.364 +- 0.171 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.6 class 9 = 0.388 +- 0.171 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.6 all KL = 0.187 +- 0.171 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.6 all L1 = 0.391 +- 0.107 (in-sample avg dev_std = 0.611)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.565
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.266
SUFF++ for r=0.9 class 0 = 0.271 +- 0.188 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.9 class 1 = 0.364 +- 0.188 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.9 class 2 = 0.395 +- 0.188 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.9 class 3 = 0.329 +- 0.188 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.9 class 4 = 0.372 +- 0.188 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.9 class 5 = 0.338 +- 0.188 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.9 class 6 = 0.337 +- 0.188 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.9 class 7 = 0.473 +- 0.188 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.9 class 8 = 0.304 +- 0.188 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.9 class 9 = 0.334 +- 0.188 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.9 all KL = 0.189 +- 0.188 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.9 all L1 = 0.353 +- 0.138 (in-sample avg dev_std = 0.575)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.101
SUFF++ for r=0.3 class 0 = 0.501 +- 0.297 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 1 = 0.515 +- 0.297 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 2 = 0.577 +- 0.297 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 3 = 0.599 +- 0.297 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 4 = 0.704 +- 0.297 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 5 = 0.626 +- 0.297 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 6 = 0.649 +- 0.297 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 7 = 0.586 +- 0.297 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 8 = 0.665 +- 0.297 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 9 = 0.594 +- 0.297 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 all KL = 0.558 +- 0.297 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 all L1 = 0.599 +- 0.218 (in-sample avg dev_std = 0.441)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.119
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.109
SUFF++ for r=0.6 class 0 = 0.663 +- 0.258 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.6 class 1 = 0.769 +- 0.258 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.6 class 2 = 0.633 +- 0.258 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.6 class 3 = 0.637 +- 0.258 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.6 class 4 = 0.568 +- 0.258 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.6 class 5 = 0.623 +- 0.258 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.6 class 6 = 0.566 +- 0.258 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.6 class 7 = 0.587 +- 0.258 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.6 class 8 = 0.541 +- 0.258 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.6 class 9 = 0.475 +- 0.258 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.6 all KL = 0.465 +- 0.258 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.6 all L1 = 0.609 +- 0.211 (in-sample avg dev_std = 0.369)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.251
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.174
SUFF++ for r=0.9 class 0 = 0.404 +- 0.275 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 1 = 0.503 +- 0.275 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 2 = 0.625 +- 0.275 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 3 = 0.491 +- 0.275 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 4 = 0.562 +- 0.275 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 5 = 0.605 +- 0.275 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 6 = 0.527 +- 0.275 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 7 = 0.548 +- 0.275 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 8 = 0.445 +- 0.275 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 9 = 0.471 +- 0.275 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 all KL = 0.389 +- 0.275 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 all L1 = 0.517 +- 0.236 (in-sample avg dev_std = 0.411)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.094
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
NEC for r=0.3 class 0 = 0.233 +- 0.283 (in-sample avg dev_std = 0.268)
NEC for r=0.3 class 1 = 0.102 +- 0.283 (in-sample avg dev_std = 0.268)
NEC for r=0.3 class 2 = 0.233 +- 0.283 (in-sample avg dev_std = 0.268)
NEC for r=0.3 class 3 = 0.214 +- 0.283 (in-sample avg dev_std = 0.268)
NEC for r=0.3 class 4 = 0.345 +- 0.283 (in-sample avg dev_std = 0.268)
NEC for r=0.3 class 5 = 0.236 +- 0.283 (in-sample avg dev_std = 0.268)
NEC for r=0.3 class 6 = 0.194 +- 0.283 (in-sample avg dev_std = 0.268)
NEC for r=0.3 class 7 = 0.311 +- 0.283 (in-sample avg dev_std = 0.268)
NEC for r=0.3 class 8 = 0.208 +- 0.283 (in-sample avg dev_std = 0.268)
NEC for r=0.3 class 9 = 0.221 +- 0.283 (in-sample avg dev_std = 0.268)
NEC for r=0.3 all KL = 0.224 +- 0.283 (in-sample avg dev_std = 0.268)
NEC for r=0.3 all L1 = 0.228 +- 0.246 (in-sample avg dev_std = 0.268)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.132
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.132
NEC for r=0.6 class 0 = 0.623 +- 0.262 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 1 = 0.33 +- 0.262 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 2 = 0.552 +- 0.262 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 3 = 0.549 +- 0.262 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 4 = 0.587 +- 0.262 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 5 = 0.587 +- 0.262 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 6 = 0.582 +- 0.262 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 7 = 0.538 +- 0.262 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 8 = 0.629 +- 0.262 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 9 = 0.609 +- 0.262 (in-sample avg dev_std = 0.387)
NEC for r=0.6 all KL = 0.59 +- 0.262 (in-sample avg dev_std = 0.387)
NEC for r=0.6 all L1 = 0.554 +- 0.192 (in-sample avg dev_std = 0.387)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.794
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.64
NEC for r=0.9 class 0 = 0.54 +- 0.286 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 1 = 0.489 +- 0.286 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 2 = 0.449 +- 0.286 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 3 = 0.412 +- 0.286 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 4 = 0.421 +- 0.286 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 5 = 0.52 +- 0.286 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 6 = 0.533 +- 0.286 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 7 = 0.23 +- 0.286 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 8 = 0.328 +- 0.286 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 9 = 0.596 +- 0.286 (in-sample avg dev_std = 0.450)
NEC for r=0.9 all KL = 0.565 +- 0.286 (in-sample avg dev_std = 0.450)
NEC for r=0.9 all L1 = 0.448 +- 0.232 (in-sample avg dev_std = 0.450)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.915
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.834
NEC for r=1.0 class 0 = 0.129 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 1 = 0.032 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 2 = 0.34 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 3 = 0.286 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 4 = 0.17 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 5 = 0.356 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 6 = 0.311 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 7 = 0.132 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 8 = 0.239 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 9 = 0.379 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 all KL = 0.313 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 all L1 = 0.232 +- 0.239 (in-sample avg dev_std = 0.337)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.121
NEC for r=0.3 class 0 = 0.333 +- 0.296 (in-sample avg dev_std = 0.314)
NEC for r=0.3 class 1 = 0.187 +- 0.296 (in-sample avg dev_std = 0.314)
NEC for r=0.3 class 2 = 0.331 +- 0.296 (in-sample avg dev_std = 0.314)
NEC for r=0.3 class 3 = 0.361 +- 0.296 (in-sample avg dev_std = 0.314)
NEC for r=0.3 class 4 = 0.269 +- 0.296 (in-sample avg dev_std = 0.314)
NEC for r=0.3 class 5 = 0.377 +- 0.296 (in-sample avg dev_std = 0.314)
NEC for r=0.3 class 6 = 0.191 +- 0.296 (in-sample avg dev_std = 0.314)
NEC for r=0.3 class 7 = 0.241 +- 0.296 (in-sample avg dev_std = 0.314)
NEC for r=0.3 class 8 = 0.277 +- 0.296 (in-sample avg dev_std = 0.314)
NEC for r=0.3 class 9 = 0.197 +- 0.296 (in-sample avg dev_std = 0.314)
NEC for r=0.3 all KL = 0.254 +- 0.296 (in-sample avg dev_std = 0.314)
NEC for r=0.3 all L1 = 0.273 +- 0.260 (in-sample avg dev_std = 0.314)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.11
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.107
NEC for r=0.6 class 0 = 0.471 +- 0.281 (in-sample avg dev_std = 0.351)
NEC for r=0.6 class 1 = 0.506 +- 0.281 (in-sample avg dev_std = 0.351)
NEC for r=0.6 class 2 = 0.349 +- 0.281 (in-sample avg dev_std = 0.351)
NEC for r=0.6 class 3 = 0.326 +- 0.281 (in-sample avg dev_std = 0.351)
NEC for r=0.6 class 4 = 0.383 +- 0.281 (in-sample avg dev_std = 0.351)
NEC for r=0.6 class 5 = 0.289 +- 0.281 (in-sample avg dev_std = 0.351)
NEC for r=0.6 class 6 = 0.386 +- 0.281 (in-sample avg dev_std = 0.351)
NEC for r=0.6 class 7 = 0.38 +- 0.281 (in-sample avg dev_std = 0.351)
NEC for r=0.6 class 8 = 0.452 +- 0.281 (in-sample avg dev_std = 0.351)
NEC for r=0.6 class 9 = 0.411 +- 0.281 (in-sample avg dev_std = 0.351)
NEC for r=0.6 all KL = 0.445 +- 0.281 (in-sample avg dev_std = 0.351)
NEC for r=0.6 all L1 = 0.397 +- 0.241 (in-sample avg dev_std = 0.351)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.565
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.45
NEC for r=0.9 class 0 = 0.603 +- 0.264 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 1 = 0.559 +- 0.264 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 2 = 0.406 +- 0.264 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 3 = 0.432 +- 0.264 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 4 = 0.52 +- 0.264 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 5 = 0.541 +- 0.264 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 6 = 0.599 +- 0.264 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 7 = 0.413 +- 0.264 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 8 = 0.557 +- 0.264 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 9 = 0.627 +- 0.264 (in-sample avg dev_std = 0.441)
NEC for r=0.9 all KL = 0.606 +- 0.264 (in-sample avg dev_std = 0.441)
NEC for r=0.9 all L1 = 0.525 +- 0.206 (in-sample avg dev_std = 0.441)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.776
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.702
NEC for r=1.0 class 0 = 0.32 +- 0.292 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 1 = 0.062 +- 0.292 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 2 = 0.318 +- 0.292 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 3 = 0.289 +- 0.292 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 4 = 0.311 +- 0.292 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 5 = 0.384 +- 0.292 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 6 = 0.429 +- 0.292 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 7 = 0.189 +- 0.292 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 8 = 0.426 +- 0.292 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 9 = 0.44 +- 0.292 (in-sample avg dev_std = 0.382)
NEC for r=1.0 all KL = 0.362 +- 0.292 (in-sample avg dev_std = 0.382)
NEC for r=1.0 all L1 = 0.312 +- 0.244 (in-sample avg dev_std = 0.382)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.113
NEC for r=0.3 class 0 = 0.492 +- 0.311 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 1 = 0.37 +- 0.311 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 2 = 0.399 +- 0.311 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 3 = 0.384 +- 0.311 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 4 = 0.276 +- 0.311 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 5 = 0.387 +- 0.311 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 6 = 0.325 +- 0.311 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 7 = 0.335 +- 0.311 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 8 = 0.317 +- 0.311 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 9 = 0.373 +- 0.311 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all KL = 0.366 +- 0.311 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all L1 = 0.367 +- 0.237 (in-sample avg dev_std = 0.364)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.119
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.115
NEC for r=0.6 class 0 = 0.241 +- 0.271 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 1 = 0.157 +- 0.271 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 2 = 0.274 +- 0.271 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 3 = 0.243 +- 0.271 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 4 = 0.365 +- 0.271 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 5 = 0.259 +- 0.271 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 6 = 0.349 +- 0.271 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 7 = 0.335 +- 0.271 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 8 = 0.378 +- 0.271 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 9 = 0.438 +- 0.271 (in-sample avg dev_std = 0.248)
NEC for r=0.6 all KL = 0.306 +- 0.271 (in-sample avg dev_std = 0.248)
NEC for r=0.6 all L1 = 0.302 +- 0.241 (in-sample avg dev_std = 0.248)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.251
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.218
NEC for r=0.9 class 0 = 0.581 +- 0.298 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 1 = 0.394 +- 0.298 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 2 = 0.388 +- 0.298 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 3 = 0.495 +- 0.298 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 4 = 0.428 +- 0.298 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 5 = 0.432 +- 0.298 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 6 = 0.498 +- 0.298 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 7 = 0.436 +- 0.298 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 8 = 0.568 +- 0.298 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 9 = 0.546 +- 0.298 (in-sample avg dev_std = 0.405)
NEC for r=0.9 all KL = 0.578 +- 0.298 (in-sample avg dev_std = 0.405)
NEC for r=0.9 all L1 = 0.476 +- 0.235 (in-sample avg dev_std = 0.405)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.3
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.344
NEC for r=1.0 class 0 = 0.529 +- 0.307 (in-sample avg dev_std = 0.321)
NEC for r=1.0 class 1 = 0.289 +- 0.307 (in-sample avg dev_std = 0.321)
NEC for r=1.0 class 2 = 0.299 +- 0.307 (in-sample avg dev_std = 0.321)
NEC for r=1.0 class 3 = 0.481 +- 0.307 (in-sample avg dev_std = 0.321)
NEC for r=1.0 class 4 = 0.454 +- 0.307 (in-sample avg dev_std = 0.321)
NEC for r=1.0 class 5 = 0.435 +- 0.307 (in-sample avg dev_std = 0.321)
NEC for r=1.0 class 6 = 0.499 +- 0.307 (in-sample avg dev_std = 0.321)
NEC for r=1.0 class 7 = 0.365 +- 0.307 (in-sample avg dev_std = 0.321)
NEC for r=1.0 class 8 = 0.543 +- 0.307 (in-sample avg dev_std = 0.321)
NEC for r=1.0 class 9 = 0.51 +- 0.307 (in-sample avg dev_std = 0.321)
NEC for r=1.0 all KL = 0.454 +- 0.307 (in-sample avg dev_std = 0.321)
NEC for r=1.0 all L1 = 0.438 +- 0.254 (in-sample avg dev_std = 0.321)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 14:25:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 02:25:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 185...
[0m[1;37mINFO[0m: [1mCheckpoint 185: 
-----------------------------------
Train ACCURACY: 0.9519
Train Loss: 0.1382
ID Validation ACCURACY: 0.8961
ID Validation Loss: 0.3621
ID Test ACCURACY: 0.8871
ID Test Loss: 0.3798
OOD Validation ACCURACY: 0.7449
OOD Validation Loss: 1.1037
OOD Test ACCURACY: 0.3044
OOD Test Loss: 5.2755

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 0.9417
Train Loss: 0.1662
ID Validation ACCURACY: 0.8909
ID Validation Loss: 0.3620
ID Test ACCURACY: 0.8841
ID Test Loss: 0.3721
OOD Validation ACCURACY: 0.8134
OOD Validation Loss: 0.6389
OOD Test ACCURACY: 0.4137
OOD Test Loss: 2.6973

[0m[1;37mINFO[0m: [1mChartInfo 0.8871 0.3044 0.8841 0.4137 0.8909 0.8134[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.125
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
SUFF++ for r=0.3 class 0 = 0.38 +- 0.300 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 1 = 0.522 +- 0.300 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 2 = 0.43 +- 0.300 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 3 = 0.52 +- 0.300 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 4 = 0.547 +- 0.300 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 5 = 0.536 +- 0.300 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 6 = 0.496 +- 0.300 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 7 = 0.644 +- 0.300 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 8 = 0.464 +- 0.300 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 9 = 0.569 +- 0.300 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 all KL = 0.437 +- 0.300 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 all L1 = 0.511 +- 0.242 (in-sample avg dev_std = 0.420)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.127
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.121
SUFF++ for r=0.6 class 0 = 0.232 +- 0.184 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 class 1 = 0.388 +- 0.184 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 class 2 = 0.319 +- 0.184 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 class 3 = 0.312 +- 0.184 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 class 4 = 0.263 +- 0.184 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 class 5 = 0.306 +- 0.184 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 class 6 = 0.251 +- 0.184 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 class 7 = 0.31 +- 0.184 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 class 8 = 0.266 +- 0.184 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 class 9 = 0.276 +- 0.184 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 all KL = 0.175 +- 0.184 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 all L1 = 0.294 +- 0.136 (in-sample avg dev_std = 0.487)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.391
SUFF++ for r=0.9 class 0 = 0.274 +- 0.179 (in-sample avg dev_std = 0.697)
SUFF++ for r=0.9 class 1 = 0.351 +- 0.179 (in-sample avg dev_std = 0.697)
SUFF++ for r=0.9 class 2 = 0.31 +- 0.179 (in-sample avg dev_std = 0.697)
SUFF++ for r=0.9 class 3 = 0.376 +- 0.179 (in-sample avg dev_std = 0.697)
SUFF++ for r=0.9 class 4 = 0.317 +- 0.179 (in-sample avg dev_std = 0.697)
SUFF++ for r=0.9 class 5 = 0.331 +- 0.179 (in-sample avg dev_std = 0.697)
SUFF++ for r=0.9 class 6 = 0.304 +- 0.179 (in-sample avg dev_std = 0.697)
SUFF++ for r=0.9 class 7 = 0.509 +- 0.179 (in-sample avg dev_std = 0.697)
SUFF++ for r=0.9 class 8 = 0.34 +- 0.179 (in-sample avg dev_std = 0.697)
SUFF++ for r=0.9 class 9 = 0.286 +- 0.179 (in-sample avg dev_std = 0.697)
SUFF++ for r=0.9 all KL = 0.102 +- 0.179 (in-sample avg dev_std = 0.697)
SUFF++ for r=0.9 all L1 = 0.343 +- 0.137 (in-sample avg dev_std = 0.697)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
SUFF++ for r=0.3 class 0 = 0.512 +- 0.320 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.3 class 1 = 0.44 +- 0.320 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.3 class 2 = 0.566 +- 0.320 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.3 class 3 = 0.599 +- 0.320 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.3 class 4 = 0.438 +- 0.320 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.3 class 5 = 0.558 +- 0.320 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.3 class 6 = 0.58 +- 0.320 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.3 class 7 = 0.653 +- 0.320 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.3 class 8 = 0.533 +- 0.320 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.3 class 9 = 0.665 +- 0.320 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.3 all KL = 0.481 +- 0.320 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.3 all L1 = 0.554 +- 0.274 (in-sample avg dev_std = 0.342)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.11
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.112
SUFF++ for r=0.6 class 0 = 0.261 +- 0.161 (in-sample avg dev_std = 0.578)
SUFF++ for r=0.6 class 1 = 0.38 +- 0.161 (in-sample avg dev_std = 0.578)
SUFF++ for r=0.6 class 2 = 0.268 +- 0.161 (in-sample avg dev_std = 0.578)
SUFF++ for r=0.6 class 3 = 0.264 +- 0.161 (in-sample avg dev_std = 0.578)
SUFF++ for r=0.6 class 4 = 0.232 +- 0.161 (in-sample avg dev_std = 0.578)
SUFF++ for r=0.6 class 5 = 0.265 +- 0.161 (in-sample avg dev_std = 0.578)
SUFF++ for r=0.6 class 6 = 0.276 +- 0.161 (in-sample avg dev_std = 0.578)
SUFF++ for r=0.6 class 7 = 0.296 +- 0.161 (in-sample avg dev_std = 0.578)
SUFF++ for r=0.6 class 8 = 0.259 +- 0.161 (in-sample avg dev_std = 0.578)
SUFF++ for r=0.6 class 9 = 0.254 +- 0.161 (in-sample avg dev_std = 0.578)
SUFF++ for r=0.6 all KL = 0.119 +- 0.161 (in-sample avg dev_std = 0.578)
SUFF++ for r=0.6 all L1 = 0.277 +- 0.112 (in-sample avg dev_std = 0.578)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.509
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.298
SUFF++ for r=0.9 class 0 = 0.296 +- 0.196 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.9 class 1 = 0.597 +- 0.196 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.9 class 2 = 0.341 +- 0.196 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.9 class 3 = 0.456 +- 0.196 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.9 class 4 = 0.305 +- 0.196 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.9 class 5 = 0.322 +- 0.196 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.9 class 6 = 0.331 +- 0.196 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.9 class 7 = 0.383 +- 0.196 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.9 class 8 = 0.301 +- 0.196 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.9 class 9 = 0.322 +- 0.196 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.9 all KL = 0.169 +- 0.196 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.9 all L1 = 0.37 +- 0.185 (in-sample avg dev_std = 0.557)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.16
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.657 +- 0.343 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 class 1 = 0.245 +- 0.343 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 class 2 = 0.573 +- 0.343 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 class 3 = 0.525 +- 0.343 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 class 4 = 0.444 +- 0.343 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 class 5 = 0.569 +- 0.343 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 class 6 = 0.391 +- 0.343 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 class 7 = 0.526 +- 0.343 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 class 8 = 0.516 +- 0.343 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 class 9 = 0.353 +- 0.343 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 all KL = 0.421 +- 0.343 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 all L1 = 0.478 +- 0.287 (in-sample avg dev_std = 0.332)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.199
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.123
SUFF++ for r=0.6 class 0 = 0.353 +- 0.241 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 1 = 0.29 +- 0.241 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 2 = 0.303 +- 0.241 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 3 = 0.312 +- 0.241 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 4 = 0.302 +- 0.241 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 5 = 0.339 +- 0.241 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 6 = 0.34 +- 0.241 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 7 = 0.392 +- 0.241 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 8 = 0.388 +- 0.241 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 9 = 0.398 +- 0.241 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 all KL = 0.194 +- 0.241 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 all L1 = 0.341 +- 0.184 (in-sample avg dev_std = 0.531)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.256
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.216
SUFF++ for r=0.9 class 0 = 0.406 +- 0.322 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 class 1 = 0.78 +- 0.322 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 class 2 = 0.601 +- 0.322 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 class 3 = 0.602 +- 0.322 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 class 4 = 0.447 +- 0.322 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 class 5 = 0.514 +- 0.322 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 class 6 = 0.505 +- 0.322 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 class 7 = 0.466 +- 0.322 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 class 8 = 0.405 +- 0.322 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 class 9 = 0.399 +- 0.322 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 all KL = 0.373 +- 0.322 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 all L1 = 0.516 +- 0.276 (in-sample avg dev_std = 0.426)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.125
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.116
NEC for r=0.3 class 0 = 0.668 +- 0.302 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 1 = 0.454 +- 0.302 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 2 = 0.623 +- 0.302 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 3 = 0.587 +- 0.302 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 4 = 0.502 +- 0.302 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 5 = 0.551 +- 0.302 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 6 = 0.481 +- 0.302 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 7 = 0.433 +- 0.302 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 8 = 0.579 +- 0.302 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 9 = 0.472 +- 0.302 (in-sample avg dev_std = 0.433)
NEC for r=0.3 all KL = 0.635 +- 0.302 (in-sample avg dev_std = 0.433)
NEC for r=0.3 all L1 = 0.534 +- 0.236 (in-sample avg dev_std = 0.433)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.127
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.122
NEC for r=0.6 class 0 = 0.715 +- 0.211 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 1 = 0.636 +- 0.211 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 2 = 0.663 +- 0.211 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 3 = 0.615 +- 0.211 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 4 = 0.636 +- 0.211 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 5 = 0.665 +- 0.211 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 6 = 0.653 +- 0.211 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 7 = 0.627 +- 0.211 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 8 = 0.67 +- 0.211 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 9 = 0.645 +- 0.211 (in-sample avg dev_std = 0.414)
NEC for r=0.6 all KL = 0.762 +- 0.211 (in-sample avg dev_std = 0.414)
NEC for r=0.6 all L1 = 0.652 +- 0.154 (in-sample avg dev_std = 0.414)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.669
NEC for r=0.9 class 0 = 0.569 +- 0.304 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 1 = 0.163 +- 0.304 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 2 = 0.478 +- 0.304 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 3 = 0.409 +- 0.304 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 4 = 0.393 +- 0.304 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 5 = 0.397 +- 0.304 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 6 = 0.523 +- 0.304 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 7 = 0.449 +- 0.304 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 8 = 0.31 +- 0.304 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 9 = 0.617 +- 0.304 (in-sample avg dev_std = 0.442)
NEC for r=0.9 all KL = 0.562 +- 0.304 (in-sample avg dev_std = 0.442)
NEC for r=0.9 all L1 = 0.427 +- 0.252 (in-sample avg dev_std = 0.442)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.933
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.842
NEC for r=1.0 class 0 = 0.111 +- 0.311 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 1 = 0.007 +- 0.311 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 2 = 0.339 +- 0.311 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 3 = 0.314 +- 0.311 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 4 = 0.167 +- 0.311 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 5 = 0.301 +- 0.311 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 6 = 0.216 +- 0.311 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 7 = 0.277 +- 0.311 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 8 = 0.168 +- 0.311 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 9 = 0.357 +- 0.311 (in-sample avg dev_std = 0.345)
NEC for r=1.0 all KL = 0.309 +- 0.311 (in-sample avg dev_std = 0.345)
NEC for r=1.0 all L1 = 0.223 +- 0.237 (in-sample avg dev_std = 0.345)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
NEC for r=0.3 class 0 = 0.538 +- 0.314 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 1 = 0.442 +- 0.314 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 2 = 0.504 +- 0.314 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 3 = 0.461 +- 0.314 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 4 = 0.488 +- 0.314 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 5 = 0.474 +- 0.314 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 6 = 0.454 +- 0.314 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 7 = 0.38 +- 0.314 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 8 = 0.479 +- 0.314 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 9 = 0.304 +- 0.314 (in-sample avg dev_std = 0.410)
NEC for r=0.3 all KL = 0.526 +- 0.314 (in-sample avg dev_std = 0.410)
NEC for r=0.3 all L1 = 0.45 +- 0.249 (in-sample avg dev_std = 0.410)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.11
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.092
NEC for r=0.6 class 0 = 0.612 +- 0.269 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 1 = 0.539 +- 0.269 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 2 = 0.572 +- 0.269 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 3 = 0.607 +- 0.269 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 4 = 0.523 +- 0.269 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 5 = 0.53 +- 0.269 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 6 = 0.479 +- 0.269 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 7 = 0.44 +- 0.269 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 8 = 0.622 +- 0.269 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 9 = 0.505 +- 0.269 (in-sample avg dev_std = 0.460)
NEC for r=0.6 all KL = 0.651 +- 0.269 (in-sample avg dev_std = 0.460)
NEC for r=0.6 all L1 = 0.542 +- 0.211 (in-sample avg dev_std = 0.460)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.509
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.451
NEC for r=0.9 class 0 = 0.529 +- 0.282 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 1 = 0.201 +- 0.282 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 2 = 0.519 +- 0.282 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 3 = 0.443 +- 0.282 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 4 = 0.559 +- 0.282 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 5 = 0.561 +- 0.282 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 6 = 0.63 +- 0.282 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 7 = 0.599 +- 0.282 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 8 = 0.613 +- 0.282 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 9 = 0.621 +- 0.282 (in-sample avg dev_std = 0.442)
NEC for r=0.9 all KL = 0.634 +- 0.282 (in-sample avg dev_std = 0.442)
NEC for r=0.9 all L1 = 0.523 +- 0.237 (in-sample avg dev_std = 0.442)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.754
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.69
NEC for r=1.0 class 0 = 0.264 +- 0.313 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 1 = 0.024 +- 0.313 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 2 = 0.356 +- 0.313 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 3 = 0.309 +- 0.313 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 4 = 0.317 +- 0.313 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 5 = 0.377 +- 0.313 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 6 = 0.46 +- 0.313 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 7 = 0.301 +- 0.313 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 8 = 0.413 +- 0.313 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 9 = 0.479 +- 0.313 (in-sample avg dev_std = 0.388)
NEC for r=1.0 all KL = 0.391 +- 0.313 (in-sample avg dev_std = 0.388)
NEC for r=1.0 all L1 = 0.325 +- 0.259 (in-sample avg dev_std = 0.388)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.16
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
NEC for r=0.3 class 0 = 0.35 +- 0.318 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 1 = 0.695 +- 0.318 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 2 = 0.442 +- 0.318 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 3 = 0.453 +- 0.318 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 4 = 0.558 +- 0.318 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 5 = 0.424 +- 0.318 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 6 = 0.564 +- 0.318 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 7 = 0.484 +- 0.318 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 8 = 0.489 +- 0.318 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 9 = 0.584 +- 0.318 (in-sample avg dev_std = 0.378)
NEC for r=0.3 all KL = 0.562 +- 0.318 (in-sample avg dev_std = 0.378)
NEC for r=0.3 all L1 = 0.506 +- 0.253 (in-sample avg dev_std = 0.378)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.199
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.182
NEC for r=0.6 class 0 = 0.545 +- 0.292 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 1 = 0.408 +- 0.292 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 2 = 0.581 +- 0.292 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 3 = 0.589 +- 0.292 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 4 = 0.631 +- 0.292 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 5 = 0.552 +- 0.292 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 6 = 0.578 +- 0.292 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 7 = 0.551 +- 0.292 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 8 = 0.54 +- 0.292 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 9 = 0.581 +- 0.292 (in-sample avg dev_std = 0.422)
NEC for r=0.6 all KL = 0.632 +- 0.292 (in-sample avg dev_std = 0.422)
NEC for r=0.6 all L1 = 0.554 +- 0.230 (in-sample avg dev_std = 0.422)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.256
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.251
NEC for r=0.9 class 0 = 0.521 +- 0.327 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 1 = 0.182 +- 0.327 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 2 = 0.424 +- 0.327 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 3 = 0.441 +- 0.327 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 4 = 0.571 +- 0.327 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 5 = 0.468 +- 0.327 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 6 = 0.521 +- 0.327 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 7 = 0.524 +- 0.327 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 8 = 0.597 +- 0.327 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 9 = 0.571 +- 0.327 (in-sample avg dev_std = 0.435)
NEC for r=0.9 all KL = 0.587 +- 0.327 (in-sample avg dev_std = 0.435)
NEC for r=0.9 all L1 = 0.478 +- 0.264 (in-sample avg dev_std = 0.435)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.304
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.318
NEC for r=1.0 class 0 = 0.347 +- 0.356 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 1 = 0.29 +- 0.356 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 2 = 0.457 +- 0.356 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 3 = 0.368 +- 0.356 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 4 = 0.608 +- 0.356 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 5 = 0.512 +- 0.356 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 6 = 0.519 +- 0.356 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 7 = 0.475 +- 0.356 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 8 = 0.561 +- 0.356 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 9 = 0.546 +- 0.356 (in-sample avg dev_std = 0.343)
NEC for r=1.0 all KL = 0.512 +- 0.356 (in-sample avg dev_std = 0.343)
NEC for r=1.0 all L1 = 0.465 +- 0.292 (in-sample avg dev_std = 0.343)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 14:55:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 02:55:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 0.9534
Train Loss: 0.1343
ID Validation ACCURACY: 0.8954
ID Validation Loss: 0.3620
ID Test ACCURACY: 0.8914
ID Test Loss: 0.3791
OOD Validation ACCURACY: 0.7987
OOD Validation Loss: 0.7966
OOD Test ACCURACY: 0.2186
OOD Test Loss: 11.4348

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.9452
Train Loss: 0.1585
ID Validation ACCURACY: 0.8876
ID Validation Loss: 0.3718
ID Test ACCURACY: 0.8883
ID Test Loss: 0.3697
OOD Validation ACCURACY: 0.8087
OOD Validation Loss: 0.7290
OOD Test ACCURACY: 0.2657
OOD Test Loss: 10.3527

[0m[1;37mINFO[0m: [1mChartInfo 0.8914 0.2186 0.8883 0.2657 0.8876 0.8087[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.092
SUFF++ for r=0.3 class 0 = 0.556 +- 0.306 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.3 class 1 = 0.75 +- 0.306 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.3 class 2 = 0.473 +- 0.306 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.3 class 3 = 0.569 +- 0.306 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.3 class 4 = 0.658 +- 0.306 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.3 class 5 = 0.502 +- 0.306 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.3 class 6 = 0.61 +- 0.306 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.3 class 7 = 0.72 +- 0.306 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.3 class 8 = 0.543 +- 0.306 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.3 class 9 = 0.676 +- 0.306 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.3 all KL = 0.604 +- 0.306 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.3 all L1 = 0.609 +- 0.250 (in-sample avg dev_std = 0.338)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.134
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.121
SUFF++ for r=0.6 class 0 = 0.307 +- 0.164 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 1 = 0.32 +- 0.164 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 2 = 0.294 +- 0.164 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 3 = 0.293 +- 0.164 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 4 = 0.297 +- 0.164 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 5 = 0.281 +- 0.164 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 6 = 0.286 +- 0.164 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 7 = 0.338 +- 0.164 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 8 = 0.286 +- 0.164 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 9 = 0.292 +- 0.164 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all KL = 0.208 +- 0.164 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all L1 = 0.3 +- 0.101 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.378
SUFF++ for r=0.9 class 0 = 0.288 +- 0.129 (in-sample avg dev_std = 0.678)
SUFF++ for r=0.9 class 1 = 0.327 +- 0.129 (in-sample avg dev_std = 0.678)
SUFF++ for r=0.9 class 2 = 0.376 +- 0.129 (in-sample avg dev_std = 0.678)
SUFF++ for r=0.9 class 3 = 0.315 +- 0.129 (in-sample avg dev_std = 0.678)
SUFF++ for r=0.9 class 4 = 0.324 +- 0.129 (in-sample avg dev_std = 0.678)
SUFF++ for r=0.9 class 5 = 0.304 +- 0.129 (in-sample avg dev_std = 0.678)
SUFF++ for r=0.9 class 6 = 0.297 +- 0.129 (in-sample avg dev_std = 0.678)
SUFF++ for r=0.9 class 7 = 0.347 +- 0.129 (in-sample avg dev_std = 0.678)
SUFF++ for r=0.9 class 8 = 0.303 +- 0.129 (in-sample avg dev_std = 0.678)
SUFF++ for r=0.9 class 9 = 0.418 +- 0.129 (in-sample avg dev_std = 0.678)
SUFF++ for r=0.9 all KL = 0.092 +- 0.129 (in-sample avg dev_std = 0.678)
SUFF++ for r=0.9 all L1 = 0.33 +- 0.114 (in-sample avg dev_std = 0.678)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.119
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
SUFF++ for r=0.3 class 0 = 0.692 +- 0.232 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.3 class 1 = 0.785 +- 0.232 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.3 class 2 = 0.65 +- 0.232 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.3 class 3 = 0.701 +- 0.232 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.3 class 4 = 0.752 +- 0.232 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.3 class 5 = 0.777 +- 0.232 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.3 class 6 = 0.7 +- 0.232 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.3 class 7 = 0.774 +- 0.232 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.3 class 8 = 0.716 +- 0.232 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.3 class 9 = 0.824 +- 0.232 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.3 all KL = 0.757 +- 0.232 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.3 all L1 = 0.738 +- 0.217 (in-sample avg dev_std = 0.190)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.117
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.118
SUFF++ for r=0.6 class 0 = 0.307 +- 0.182 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 1 = 0.315 +- 0.182 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 2 = 0.308 +- 0.182 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 3 = 0.315 +- 0.182 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 4 = 0.291 +- 0.182 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 5 = 0.304 +- 0.182 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 6 = 0.311 +- 0.182 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 7 = 0.337 +- 0.182 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 8 = 0.305 +- 0.182 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 9 = 0.32 +- 0.182 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all KL = 0.239 +- 0.182 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all L1 = 0.312 +- 0.109 (in-sample avg dev_std = 0.432)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.26
SUFF++ for r=0.9 class 0 = 0.24 +- 0.124 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.9 class 1 = 0.296 +- 0.124 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.9 class 2 = 0.306 +- 0.124 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.9 class 3 = 0.264 +- 0.124 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.9 class 4 = 0.295 +- 0.124 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.9 class 5 = 0.286 +- 0.124 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.9 class 6 = 0.276 +- 0.124 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.9 class 7 = 0.298 +- 0.124 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.9 class 8 = 0.255 +- 0.124 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.9 class 9 = 0.358 +- 0.124 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.9 all KL = 0.094 +- 0.124 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.9 all L1 = 0.288 +- 0.102 (in-sample avg dev_std = 0.580)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.108
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
SUFF++ for r=0.3 class 0 = 0.645 +- 0.369 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 1 = 0.27 +- 0.369 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 2 = 0.591 +- 0.369 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 3 = 0.626 +- 0.369 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 4 = 0.444 +- 0.369 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 5 = 0.636 +- 0.369 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 6 = 0.503 +- 0.369 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 7 = 0.547 +- 0.369 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 8 = 0.61 +- 0.369 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 9 = 0.449 +- 0.369 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 all KL = 0.459 +- 0.369 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 all L1 = 0.529 +- 0.284 (in-sample avg dev_std = 0.361)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.131
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.109
SUFF++ for r=0.6 class 0 = 0.25 +- 0.199 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.6 class 1 = 0.459 +- 0.199 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.6 class 2 = 0.273 +- 0.199 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.6 class 3 = 0.255 +- 0.199 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.6 class 4 = 0.315 +- 0.199 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.6 class 5 = 0.262 +- 0.199 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.6 class 6 = 0.337 +- 0.199 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.6 class 7 = 0.274 +- 0.199 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.6 class 8 = 0.301 +- 0.199 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.6 class 9 = 0.339 +- 0.199 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.6 all KL = 0.121 +- 0.199 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.6 all L1 = 0.308 +- 0.167 (in-sample avg dev_std = 0.593)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.166
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.154
SUFF++ for r=0.9 class 0 = 0.308 +- 0.112 (in-sample avg dev_std = 0.579)
SUFF++ for r=0.9 class 1 = 0.264 +- 0.112 (in-sample avg dev_std = 0.579)
SUFF++ for r=0.9 class 2 = 0.333 +- 0.112 (in-sample avg dev_std = 0.579)
SUFF++ for r=0.9 class 3 = 0.315 +- 0.112 (in-sample avg dev_std = 0.579)
SUFF++ for r=0.9 class 4 = 0.312 +- 0.112 (in-sample avg dev_std = 0.579)
SUFF++ for r=0.9 class 5 = 0.303 +- 0.112 (in-sample avg dev_std = 0.579)
SUFF++ for r=0.9 class 6 = 0.307 +- 0.112 (in-sample avg dev_std = 0.579)
SUFF++ for r=0.9 class 7 = 0.331 +- 0.112 (in-sample avg dev_std = 0.579)
SUFF++ for r=0.9 class 8 = 0.315 +- 0.112 (in-sample avg dev_std = 0.579)
SUFF++ for r=0.9 class 9 = 0.299 +- 0.112 (in-sample avg dev_std = 0.579)
SUFF++ for r=0.9 all KL = 0.081 +- 0.112 (in-sample avg dev_std = 0.579)
SUFF++ for r=0.9 all L1 = 0.308 +- 0.108 (in-sample avg dev_std = 0.579)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
NEC for r=0.3 class 0 = 0.563 +- 0.328 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 1 = 0.219 +- 0.328 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 2 = 0.549 +- 0.328 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 3 = 0.497 +- 0.328 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 4 = 0.376 +- 0.328 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 5 = 0.538 +- 0.328 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 6 = 0.417 +- 0.328 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 7 = 0.331 +- 0.328 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 8 = 0.475 +- 0.328 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 9 = 0.332 +- 0.328 (in-sample avg dev_std = 0.372)
NEC for r=0.3 all KL = 0.463 +- 0.328 (in-sample avg dev_std = 0.372)
NEC for r=0.3 all L1 = 0.426 +- 0.248 (in-sample avg dev_std = 0.372)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.134
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.112
NEC for r=0.6 class 0 = 0.631 +- 0.222 (in-sample avg dev_std = 0.379)
NEC for r=0.6 class 1 = 0.675 +- 0.222 (in-sample avg dev_std = 0.379)
NEC for r=0.6 class 2 = 0.625 +- 0.222 (in-sample avg dev_std = 0.379)
NEC for r=0.6 class 3 = 0.625 +- 0.222 (in-sample avg dev_std = 0.379)
NEC for r=0.6 class 4 = 0.617 +- 0.222 (in-sample avg dev_std = 0.379)
NEC for r=0.6 class 5 = 0.629 +- 0.222 (in-sample avg dev_std = 0.379)
NEC for r=0.6 class 6 = 0.612 +- 0.222 (in-sample avg dev_std = 0.379)
NEC for r=0.6 class 7 = 0.607 +- 0.222 (in-sample avg dev_std = 0.379)
NEC for r=0.6 class 8 = 0.65 +- 0.222 (in-sample avg dev_std = 0.379)
NEC for r=0.6 class 9 = 0.632 +- 0.222 (in-sample avg dev_std = 0.379)
NEC for r=0.6 all KL = 0.689 +- 0.222 (in-sample avg dev_std = 0.379)
NEC for r=0.6 all L1 = 0.631 +- 0.142 (in-sample avg dev_std = 0.379)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.664
NEC for r=0.9 class 0 = 0.467 +- 0.291 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 1 = 0.33 +- 0.291 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 2 = 0.422 +- 0.291 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 3 = 0.484 +- 0.291 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 4 = 0.416 +- 0.291 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 5 = 0.511 +- 0.291 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 6 = 0.511 +- 0.291 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 7 = 0.338 +- 0.291 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 8 = 0.356 +- 0.291 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 9 = 0.549 +- 0.291 (in-sample avg dev_std = 0.450)
NEC for r=0.9 all KL = 0.564 +- 0.291 (in-sample avg dev_std = 0.450)
NEC for r=0.9 all L1 = 0.434 +- 0.240 (in-sample avg dev_std = 0.450)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.924
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.842
NEC for r=1.0 class 0 = 0.067 +- 0.300 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 1 = 0.04 +- 0.300 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 2 = 0.303 +- 0.300 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 3 = 0.333 +- 0.300 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 4 = 0.189 +- 0.300 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 5 = 0.342 +- 0.300 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 6 = 0.209 +- 0.300 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 7 = 0.146 +- 0.300 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 8 = 0.192 +- 0.300 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 9 = 0.348 +- 0.300 (in-sample avg dev_std = 0.343)
NEC for r=1.0 all KL = 0.305 +- 0.300 (in-sample avg dev_std = 0.343)
NEC for r=1.0 all L1 = 0.213 +- 0.227 (in-sample avg dev_std = 0.343)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.119
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
NEC for r=0.3 class 0 = 0.351 +- 0.261 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 1 = 0.209 +- 0.261 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 2 = 0.376 +- 0.261 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 3 = 0.335 +- 0.261 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 4 = 0.283 +- 0.261 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 5 = 0.266 +- 0.261 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 6 = 0.306 +- 0.261 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 7 = 0.221 +- 0.261 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 8 = 0.293 +- 0.261 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 9 = 0.205 +- 0.261 (in-sample avg dev_std = 0.240)
NEC for r=0.3 all KL = 0.273 +- 0.261 (in-sample avg dev_std = 0.240)
NEC for r=0.3 all L1 = 0.283 +- 0.213 (in-sample avg dev_std = 0.240)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.117
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.114
NEC for r=0.6 class 0 = 0.591 +- 0.227 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 1 = 0.56 +- 0.227 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 2 = 0.597 +- 0.227 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 3 = 0.545 +- 0.227 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 4 = 0.606 +- 0.227 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 5 = 0.584 +- 0.227 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 6 = 0.612 +- 0.227 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 7 = 0.6 +- 0.227 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 8 = 0.607 +- 0.227 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 9 = 0.588 +- 0.227 (in-sample avg dev_std = 0.378)
NEC for r=0.6 all KL = 0.62 +- 0.227 (in-sample avg dev_std = 0.378)
NEC for r=0.6 all L1 = 0.589 +- 0.142 (in-sample avg dev_std = 0.378)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.421
NEC for r=0.9 class 0 = 0.653 +- 0.256 (in-sample avg dev_std = 0.458)
NEC for r=0.9 class 1 = 0.528 +- 0.256 (in-sample avg dev_std = 0.458)
NEC for r=0.9 class 2 = 0.46 +- 0.256 (in-sample avg dev_std = 0.458)
NEC for r=0.9 class 3 = 0.552 +- 0.256 (in-sample avg dev_std = 0.458)
NEC for r=0.9 class 4 = 0.518 +- 0.256 (in-sample avg dev_std = 0.458)
NEC for r=0.9 class 5 = 0.565 +- 0.256 (in-sample avg dev_std = 0.458)
NEC for r=0.9 class 6 = 0.66 +- 0.256 (in-sample avg dev_std = 0.458)
NEC for r=0.9 class 7 = 0.503 +- 0.256 (in-sample avg dev_std = 0.458)
NEC for r=0.9 class 8 = 0.613 +- 0.256 (in-sample avg dev_std = 0.458)
NEC for r=0.9 class 9 = 0.577 +- 0.256 (in-sample avg dev_std = 0.458)
NEC for r=0.9 all KL = 0.668 +- 0.256 (in-sample avg dev_std = 0.458)
NEC for r=0.9 all L1 = 0.562 +- 0.201 (in-sample avg dev_std = 0.458)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.824
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.71
NEC for r=1.0 class 0 = 0.291 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 1 = 0.094 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 2 = 0.306 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 3 = 0.399 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 4 = 0.288 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 5 = 0.453 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 6 = 0.47 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 7 = 0.198 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 8 = 0.43 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 9 = 0.43 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=1.0 all KL = 0.414 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=1.0 all L1 = 0.331 +- 0.248 (in-sample avg dev_std = 0.399)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.108
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.117
NEC for r=0.3 class 0 = 0.418 +- 0.365 (in-sample avg dev_std = 0.219)
NEC for r=0.3 class 1 = 0.782 +- 0.365 (in-sample avg dev_std = 0.219)
NEC for r=0.3 class 2 = 0.485 +- 0.365 (in-sample avg dev_std = 0.219)
NEC for r=0.3 class 3 = 0.412 +- 0.365 (in-sample avg dev_std = 0.219)
NEC for r=0.3 class 4 = 0.606 +- 0.365 (in-sample avg dev_std = 0.219)
NEC for r=0.3 class 5 = 0.394 +- 0.365 (in-sample avg dev_std = 0.219)
NEC for r=0.3 class 6 = 0.524 +- 0.365 (in-sample avg dev_std = 0.219)
NEC for r=0.3 class 7 = 0.448 +- 0.365 (in-sample avg dev_std = 0.219)
NEC for r=0.3 class 8 = 0.438 +- 0.365 (in-sample avg dev_std = 0.219)
NEC for r=0.3 class 9 = 0.591 +- 0.365 (in-sample avg dev_std = 0.219)
NEC for r=0.3 all KL = 0.571 +- 0.365 (in-sample avg dev_std = 0.219)
NEC for r=0.3 all L1 = 0.513 +- 0.296 (in-sample avg dev_std = 0.219)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.131
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.157
NEC for r=0.6 class 0 = 0.679 +- 0.213 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 1 = 0.732 +- 0.213 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 2 = 0.663 +- 0.213 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 3 = 0.697 +- 0.213 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 4 = 0.716 +- 0.213 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 5 = 0.704 +- 0.213 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 6 = 0.732 +- 0.213 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 7 = 0.695 +- 0.213 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 8 = 0.706 +- 0.213 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 9 = 0.77 +- 0.213 (in-sample avg dev_std = 0.363)
NEC for r=0.6 all KL = 0.841 +- 0.213 (in-sample avg dev_std = 0.363)
NEC for r=0.6 all L1 = 0.709 +- 0.160 (in-sample avg dev_std = 0.363)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.166
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.204
NEC for r=0.9 class 0 = 0.7 +- 0.240 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 1 = 0.678 +- 0.240 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 2 = 0.613 +- 0.240 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 3 = 0.665 +- 0.240 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 4 = 0.695 +- 0.240 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 5 = 0.664 +- 0.240 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 6 = 0.686 +- 0.240 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 7 = 0.668 +- 0.240 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 8 = 0.723 +- 0.240 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 9 = 0.709 +- 0.240 (in-sample avg dev_std = 0.383)
NEC for r=0.9 all KL = 0.818 +- 0.240 (in-sample avg dev_std = 0.383)
NEC for r=0.9 all L1 = 0.68 +- 0.188 (in-sample avg dev_std = 0.383)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.243
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.283
NEC for r=1.0 class 0 = 0.626 +- 0.305 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 1 = 0.626 +- 0.305 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 2 = 0.491 +- 0.305 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 3 = 0.615 +- 0.305 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 4 = 0.644 +- 0.305 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 5 = 0.651 +- 0.305 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 6 = 0.665 +- 0.305 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 7 = 0.597 +- 0.305 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 8 = 0.666 +- 0.305 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 9 = 0.683 +- 0.305 (in-sample avg dev_std = 0.365)
NEC for r=1.0 all KL = 0.75 +- 0.305 (in-sample avg dev_std = 0.365)
NEC for r=1.0 all L1 = 0.625 +- 0.242 (in-sample avg dev_std = 0.365)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 15:26:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:26:07 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 03:26:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9613
Train Loss: 0.1134
ID Validation ACCURACY: 0.8956
ID Validation Loss: 0.3556
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3603
OOD Validation ACCURACY: 0.7163
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.1731
OOD Test Loss: 12.4917

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 134...
[0m[1;37mINFO[0m: [1mCheckpoint 134: 
-----------------------------------
Train ACCURACY: 0.9177
Train Loss: 0.2366
ID Validation ACCURACY: 0.8739
ID Validation Loss: 0.3990
ID Test ACCURACY: 0.8733
ID Test Loss: 0.3982
OOD Validation ACCURACY: 0.7943
OOD Validation Loss: 0.6922
OOD Test ACCURACY: 0.3307
OOD Test Loss: 3.3639

[0m[1;37mINFO[0m: [1mChartInfo 0.8920 0.1731 0.8733 0.3307 0.8739 0.7943[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.119
SUFF++ for r=0.3 class 0 = 0.476 +- 0.207 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 class 1 = 0.326 +- 0.207 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 class 2 = 0.45 +- 0.207 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 class 3 = 0.419 +- 0.207 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 class 4 = 0.386 +- 0.207 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 class 5 = 0.426 +- 0.207 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 class 6 = 0.446 +- 0.207 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 class 7 = 0.459 +- 0.207 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 class 8 = 0.434 +- 0.207 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 class 9 = 0.429 +- 0.207 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 all KL = 0.323 +- 0.207 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 all L1 = 0.424 +- 0.133 (in-sample avg dev_std = 0.485)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.145
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.109
SUFF++ for r=0.6 class 0 = 0.462 +- 0.230 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 1 = 0.292 +- 0.230 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 2 = 0.508 +- 0.230 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 3 = 0.548 +- 0.230 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 4 = 0.411 +- 0.230 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 5 = 0.434 +- 0.230 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 6 = 0.417 +- 0.230 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 7 = 0.443 +- 0.230 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 8 = 0.56 +- 0.230 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 9 = 0.452 +- 0.230 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all KL = 0.361 +- 0.230 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all L1 = 0.452 +- 0.180 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.372
SUFF++ for r=0.9 class 0 = 0.25 +- 0.172 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 1 = 0.287 +- 0.172 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 2 = 0.499 +- 0.172 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 3 = 0.331 +- 0.172 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 4 = 0.299 +- 0.172 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 5 = 0.326 +- 0.172 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 6 = 0.404 +- 0.172 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 7 = 0.531 +- 0.172 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 8 = 0.337 +- 0.172 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 9 = 0.368 +- 0.172 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 all KL = 0.148 +- 0.172 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 all L1 = 0.365 +- 0.153 (in-sample avg dev_std = 0.614)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
SUFF++ for r=0.3 class 0 = 0.438 +- 0.203 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 1 = 0.38 +- 0.203 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 2 = 0.431 +- 0.203 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 3 = 0.43 +- 0.203 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 4 = 0.416 +- 0.203 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 5 = 0.437 +- 0.203 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 6 = 0.435 +- 0.203 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 7 = 0.43 +- 0.203 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 8 = 0.404 +- 0.203 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 9 = 0.392 +- 0.203 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 all KL = 0.355 +- 0.203 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 all L1 = 0.419 +- 0.116 (in-sample avg dev_std = 0.419)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.11
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.101
SUFF++ for r=0.6 class 0 = 0.567 +- 0.262 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 class 1 = 0.416 +- 0.262 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 class 2 = 0.627 +- 0.262 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 class 3 = 0.614 +- 0.262 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 class 4 = 0.611 +- 0.262 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 class 5 = 0.637 +- 0.262 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 class 6 = 0.597 +- 0.262 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 class 7 = 0.579 +- 0.262 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 class 8 = 0.605 +- 0.262 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 class 9 = 0.595 +- 0.262 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 all KL = 0.511 +- 0.262 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 all L1 = 0.582 +- 0.229 (in-sample avg dev_std = 0.350)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.53
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.259
SUFF++ for r=0.9 class 0 = 0.267 +- 0.219 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 1 = 0.327 +- 0.219 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 2 = 0.527 +- 0.219 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 3 = 0.36 +- 0.219 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 4 = 0.369 +- 0.219 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 5 = 0.378 +- 0.219 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 6 = 0.38 +- 0.219 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 7 = 0.435 +- 0.219 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 8 = 0.339 +- 0.219 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 9 = 0.348 +- 0.219 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 all KL = 0.236 +- 0.219 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 all L1 = 0.373 +- 0.158 (in-sample avg dev_std = 0.506)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.119
SUFF++ for r=0.3 class 0 = 0.544 +- 0.224 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.3 class 1 = 0.431 +- 0.224 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.3 class 2 = 0.536 +- 0.224 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.3 class 3 = 0.535 +- 0.224 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.3 class 4 = 0.525 +- 0.224 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.3 class 5 = 0.544 +- 0.224 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.3 class 6 = 0.518 +- 0.224 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.3 class 7 = 0.467 +- 0.224 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.3 class 8 = 0.466 +- 0.224 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.3 class 9 = 0.473 +- 0.224 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.3 all KL = 0.416 +- 0.224 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.3 all L1 = 0.503 +- 0.138 (in-sample avg dev_std = 0.424)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.117
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.109
SUFF++ for r=0.6 class 0 = 0.792 +- 0.266 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 class 1 = 0.412 +- 0.266 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 class 2 = 0.811 +- 0.266 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 class 3 = 0.766 +- 0.266 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 class 4 = 0.811 +- 0.266 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 class 5 = 0.817 +- 0.266 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 class 6 = 0.776 +- 0.266 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 class 7 = 0.722 +- 0.266 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 class 8 = 0.716 +- 0.266 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 class 9 = 0.63 +- 0.266 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 all KL = 0.701 +- 0.266 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 all L1 = 0.721 +- 0.252 (in-sample avg dev_std = 0.230)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.146
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.138
SUFF++ for r=0.9 class 0 = 0.462 +- 0.325 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 1 = 0.327 +- 0.325 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 2 = 0.716 +- 0.325 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 3 = 0.631 +- 0.325 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 4 = 0.61 +- 0.325 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 5 = 0.616 +- 0.325 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 6 = 0.605 +- 0.325 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 7 = 0.549 +- 0.325 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 8 = 0.579 +- 0.325 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 9 = 0.521 +- 0.325 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 all KL = 0.439 +- 0.325 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 all L1 = 0.559 +- 0.257 (in-sample avg dev_std = 0.346)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
NEC for r=0.3 class 0 = 0.516 +- 0.254 (in-sample avg dev_std = 0.456)
NEC for r=0.3 class 1 = 0.594 +- 0.254 (in-sample avg dev_std = 0.456)
NEC for r=0.3 class 2 = 0.58 +- 0.254 (in-sample avg dev_std = 0.456)
NEC for r=0.3 class 3 = 0.621 +- 0.254 (in-sample avg dev_std = 0.456)
NEC for r=0.3 class 4 = 0.647 +- 0.254 (in-sample avg dev_std = 0.456)
NEC for r=0.3 class 5 = 0.587 +- 0.254 (in-sample avg dev_std = 0.456)
NEC for r=0.3 class 6 = 0.558 +- 0.254 (in-sample avg dev_std = 0.456)
NEC for r=0.3 class 7 = 0.574 +- 0.254 (in-sample avg dev_std = 0.456)
NEC for r=0.3 class 8 = 0.614 +- 0.254 (in-sample avg dev_std = 0.456)
NEC for r=0.3 class 9 = 0.547 +- 0.254 (in-sample avg dev_std = 0.456)
NEC for r=0.3 all KL = 0.667 +- 0.254 (in-sample avg dev_std = 0.456)
NEC for r=0.3 all L1 = 0.584 +- 0.182 (in-sample avg dev_std = 0.456)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.145
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.13
NEC for r=0.6 class 0 = 0.486 +- 0.265 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 1 = 0.668 +- 0.265 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 2 = 0.45 +- 0.265 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 3 = 0.466 +- 0.265 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 4 = 0.549 +- 0.265 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 5 = 0.503 +- 0.265 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 6 = 0.532 +- 0.265 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 7 = 0.525 +- 0.265 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 8 = 0.389 +- 0.265 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 9 = 0.529 +- 0.265 (in-sample avg dev_std = 0.422)
NEC for r=0.6 all KL = 0.559 +- 0.265 (in-sample avg dev_std = 0.422)
NEC for r=0.6 all L1 = 0.511 +- 0.206 (in-sample avg dev_std = 0.422)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.599
NEC for r=0.9 class 0 = 0.506 +- 0.294 (in-sample avg dev_std = 0.461)
NEC for r=0.9 class 1 = 0.548 +- 0.294 (in-sample avg dev_std = 0.461)
NEC for r=0.9 class 2 = 0.285 +- 0.294 (in-sample avg dev_std = 0.461)
NEC for r=0.9 class 3 = 0.491 +- 0.294 (in-sample avg dev_std = 0.461)
NEC for r=0.9 class 4 = 0.563 +- 0.294 (in-sample avg dev_std = 0.461)
NEC for r=0.9 class 5 = 0.589 +- 0.294 (in-sample avg dev_std = 0.461)
NEC for r=0.9 class 6 = 0.44 +- 0.294 (in-sample avg dev_std = 0.461)
NEC for r=0.9 class 7 = 0.386 +- 0.294 (in-sample avg dev_std = 0.461)
NEC for r=0.9 class 8 = 0.298 +- 0.294 (in-sample avg dev_std = 0.461)
NEC for r=0.9 class 9 = 0.582 +- 0.294 (in-sample avg dev_std = 0.461)
NEC for r=0.9 all KL = 0.592 +- 0.294 (in-sample avg dev_std = 0.461)
NEC for r=0.9 all L1 = 0.466 +- 0.242 (in-sample avg dev_std = 0.461)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.838
NEC for r=1.0 class 0 = 0.081 +- 0.306 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 1 = 0.05 +- 0.306 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 2 = 0.242 +- 0.306 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 3 = 0.321 +- 0.306 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 4 = 0.241 +- 0.306 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 5 = 0.429 +- 0.306 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 6 = 0.233 +- 0.306 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 7 = 0.242 +- 0.306 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 8 = 0.188 +- 0.306 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 9 = 0.322 +- 0.306 (in-sample avg dev_std = 0.348)
NEC for r=1.0 all KL = 0.325 +- 0.306 (in-sample avg dev_std = 0.348)
NEC for r=1.0 all L1 = 0.23 +- 0.237 (in-sample avg dev_std = 0.348)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
NEC for r=0.3 class 0 = 0.565 +- 0.253 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 1 = 0.576 +- 0.253 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 2 = 0.569 +- 0.253 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 3 = 0.533 +- 0.253 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 4 = 0.538 +- 0.253 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 5 = 0.522 +- 0.253 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 6 = 0.526 +- 0.253 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 7 = 0.539 +- 0.253 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 8 = 0.599 +- 0.253 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 9 = 0.535 +- 0.253 (in-sample avg dev_std = 0.407)
NEC for r=0.3 all KL = 0.573 +- 0.253 (in-sample avg dev_std = 0.407)
NEC for r=0.3 all L1 = 0.55 +- 0.164 (in-sample avg dev_std = 0.407)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.11
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.105
NEC for r=0.6 class 0 = 0.414 +- 0.276 (in-sample avg dev_std = 0.360)
NEC for r=0.6 class 1 = 0.543 +- 0.276 (in-sample avg dev_std = 0.360)
NEC for r=0.6 class 2 = 0.378 +- 0.276 (in-sample avg dev_std = 0.360)
NEC for r=0.6 class 3 = 0.391 +- 0.276 (in-sample avg dev_std = 0.360)
NEC for r=0.6 class 4 = 0.396 +- 0.276 (in-sample avg dev_std = 0.360)
NEC for r=0.6 class 5 = 0.349 +- 0.276 (in-sample avg dev_std = 0.360)
NEC for r=0.6 class 6 = 0.368 +- 0.276 (in-sample avg dev_std = 0.360)
NEC for r=0.6 class 7 = 0.388 +- 0.276 (in-sample avg dev_std = 0.360)
NEC for r=0.6 class 8 = 0.407 +- 0.276 (in-sample avg dev_std = 0.360)
NEC for r=0.6 class 9 = 0.396 +- 0.276 (in-sample avg dev_std = 0.360)
NEC for r=0.6 all KL = 0.444 +- 0.276 (in-sample avg dev_std = 0.360)
NEC for r=0.6 all L1 = 0.405 +- 0.231 (in-sample avg dev_std = 0.360)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.53
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.423
NEC for r=0.9 class 0 = 0.61 +- 0.263 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 1 = 0.489 +- 0.263 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 2 = 0.392 +- 0.263 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 3 = 0.552 +- 0.263 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 4 = 0.562 +- 0.263 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 5 = 0.566 +- 0.263 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 6 = 0.615 +- 0.263 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 7 = 0.447 +- 0.263 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 8 = 0.579 +- 0.263 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 9 = 0.604 +- 0.263 (in-sample avg dev_std = 0.447)
NEC for r=0.9 all KL = 0.633 +- 0.263 (in-sample avg dev_std = 0.447)
NEC for r=0.9 all L1 = 0.54 +- 0.208 (in-sample avg dev_std = 0.447)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.741
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.669
NEC for r=1.0 class 0 = 0.273 +- 0.298 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 1 = 0.108 +- 0.298 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 2 = 0.31 +- 0.298 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 3 = 0.409 +- 0.298 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 4 = 0.365 +- 0.298 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 5 = 0.453 +- 0.298 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 6 = 0.409 +- 0.298 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 7 = 0.206 +- 0.298 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 8 = 0.433 +- 0.298 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 9 = 0.481 +- 0.298 (in-sample avg dev_std = 0.384)
NEC for r=1.0 all KL = 0.389 +- 0.298 (in-sample avg dev_std = 0.384)
NEC for r=1.0 all L1 = 0.34 +- 0.250 (in-sample avg dev_std = 0.384)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.115
NEC for r=0.3 class 0 = 0.496 +- 0.282 (in-sample avg dev_std = 0.367)
NEC for r=0.3 class 1 = 0.461 +- 0.282 (in-sample avg dev_std = 0.367)
NEC for r=0.3 class 2 = 0.465 +- 0.282 (in-sample avg dev_std = 0.367)
NEC for r=0.3 class 3 = 0.46 +- 0.282 (in-sample avg dev_std = 0.367)
NEC for r=0.3 class 4 = 0.443 +- 0.282 (in-sample avg dev_std = 0.367)
NEC for r=0.3 class 5 = 0.459 +- 0.282 (in-sample avg dev_std = 0.367)
NEC for r=0.3 class 6 = 0.482 +- 0.282 (in-sample avg dev_std = 0.367)
NEC for r=0.3 class 7 = 0.479 +- 0.282 (in-sample avg dev_std = 0.367)
NEC for r=0.3 class 8 = 0.521 +- 0.282 (in-sample avg dev_std = 0.367)
NEC for r=0.3 class 9 = 0.484 +- 0.282 (in-sample avg dev_std = 0.367)
NEC for r=0.3 all KL = 0.533 +- 0.282 (in-sample avg dev_std = 0.367)
NEC for r=0.3 all L1 = 0.475 +- 0.188 (in-sample avg dev_std = 0.367)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.117
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.113
NEC for r=0.6 class 0 = 0.249 +- 0.273 (in-sample avg dev_std = 0.245)
NEC for r=0.6 class 1 = 0.534 +- 0.273 (in-sample avg dev_std = 0.245)
NEC for r=0.6 class 2 = 0.198 +- 0.273 (in-sample avg dev_std = 0.245)
NEC for r=0.6 class 3 = 0.241 +- 0.273 (in-sample avg dev_std = 0.245)
NEC for r=0.6 class 4 = 0.193 +- 0.273 (in-sample avg dev_std = 0.245)
NEC for r=0.6 class 5 = 0.185 +- 0.273 (in-sample avg dev_std = 0.245)
NEC for r=0.6 class 6 = 0.244 +- 0.273 (in-sample avg dev_std = 0.245)
NEC for r=0.6 class 7 = 0.259 +- 0.273 (in-sample avg dev_std = 0.245)
NEC for r=0.6 class 8 = 0.298 +- 0.273 (in-sample avg dev_std = 0.245)
NEC for r=0.6 class 9 = 0.359 +- 0.273 (in-sample avg dev_std = 0.245)
NEC for r=0.6 all KL = 0.295 +- 0.273 (in-sample avg dev_std = 0.245)
NEC for r=0.6 all L1 = 0.28 +- 0.242 (in-sample avg dev_std = 0.245)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.146
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.171
NEC for r=0.9 class 0 = 0.655 +- 0.283 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 1 = 0.501 +- 0.283 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 2 = 0.365 +- 0.283 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 3 = 0.461 +- 0.283 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 4 = 0.443 +- 0.283 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 5 = 0.468 +- 0.283 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 6 = 0.494 +- 0.283 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 7 = 0.497 +- 0.283 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 8 = 0.559 +- 0.283 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 9 = 0.55 +- 0.283 (in-sample avg dev_std = 0.395)
NEC for r=0.9 all KL = 0.704 +- 0.283 (in-sample avg dev_std = 0.395)
NEC for r=0.9 all L1 = 0.499 +- 0.225 (in-sample avg dev_std = 0.395)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.183
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.215
NEC for r=1.0 class 0 = 0.604 +- 0.340 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 1 = 0.428 +- 0.340 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 2 = 0.362 +- 0.340 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 3 = 0.437 +- 0.340 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 4 = 0.359 +- 0.340 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 5 = 0.5 +- 0.340 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 6 = 0.412 +- 0.340 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 7 = 0.465 +- 0.340 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 8 = 0.471 +- 0.340 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 9 = 0.391 +- 0.340 (in-sample avg dev_std = 0.341)
NEC for r=1.0 all KL = 0.618 +- 0.340 (in-sample avg dev_std = 0.341)
NEC for r=1.0 all L1 = 0.442 +- 0.269 (in-sample avg dev_std = 0.341)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 15:56:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:03 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:03 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:03 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:03 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 03:56:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ACCURACY: 0.9609
Train Loss: 0.1130
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3439
ID Test ACCURACY: 0.8937
ID Test Loss: 0.3554
OOD Validation ACCURACY: 0.7863
OOD Validation Loss: 0.8914
OOD Test ACCURACY: 0.2307
OOD Test Loss: 10.8940

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.9328
Train Loss: 0.1957
ID Validation ACCURACY: 0.8821
ID Validation Loss: 0.3581
ID Test ACCURACY: 0.8791
ID Test Loss: 0.3593
OOD Validation ACCURACY: 0.8147
OOD Validation Loss: 0.5922
OOD Test ACCURACY: 0.3769
OOD Test Loss: 3.0655

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.2307 0.8791 0.3769 0.8821 0.8147[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.114
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
SUFF++ for r=0.3 class 0 = 0.392 +- 0.263 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 1 = 0.483 +- 0.263 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 2 = 0.444 +- 0.263 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 3 = 0.45 +- 0.263 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 4 = 0.44 +- 0.263 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 5 = 0.451 +- 0.263 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 6 = 0.459 +- 0.263 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 7 = 0.518 +- 0.263 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 8 = 0.386 +- 0.263 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 9 = 0.41 +- 0.263 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 all KL = 0.441 +- 0.263 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 all L1 = 0.445 +- 0.155 (in-sample avg dev_std = 0.425)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.18
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.128
SUFF++ for r=0.6 class 0 = 0.257 +- 0.162 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 1 = 0.401 +- 0.162 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 2 = 0.289 +- 0.162 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 3 = 0.301 +- 0.162 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 4 = 0.286 +- 0.162 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 5 = 0.298 +- 0.162 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 6 = 0.276 +- 0.162 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 7 = 0.318 +- 0.162 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 8 = 0.261 +- 0.162 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 9 = 0.287 +- 0.162 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 all KL = 0.18 +- 0.162 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 all L1 = 0.299 +- 0.093 (in-sample avg dev_std = 0.507)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.771
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.42
SUFF++ for r=0.9 class 0 = 0.264 +- 0.158 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.9 class 1 = 0.468 +- 0.158 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.9 class 2 = 0.396 +- 0.158 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.9 class 3 = 0.347 +- 0.158 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.9 class 4 = 0.293 +- 0.158 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.9 class 5 = 0.298 +- 0.158 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.9 class 6 = 0.344 +- 0.158 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.9 class 7 = 0.521 +- 0.158 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.9 class 8 = 0.322 +- 0.158 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.9 class 9 = 0.36 +- 0.158 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.9 all KL = 0.119 +- 0.158 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.9 all L1 = 0.366 +- 0.152 (in-sample avg dev_std = 0.659)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.115
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.114
SUFF++ for r=0.3 class 0 = 0.469 +- 0.248 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 class 1 = 0.456 +- 0.248 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 class 2 = 0.471 +- 0.248 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 class 3 = 0.46 +- 0.248 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 class 4 = 0.463 +- 0.248 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 class 5 = 0.455 +- 0.248 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 class 6 = 0.46 +- 0.248 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 class 7 = 0.494 +- 0.248 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 class 8 = 0.423 +- 0.248 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 class 9 = 0.465 +- 0.248 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 all KL = 0.498 +- 0.248 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 all L1 = 0.462 +- 0.145 (in-sample avg dev_std = 0.396)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.162
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.135
SUFF++ for r=0.6 class 0 = 0.278 +- 0.148 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 1 = 0.39 +- 0.148 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 2 = 0.275 +- 0.148 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 3 = 0.278 +- 0.148 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 4 = 0.296 +- 0.148 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 5 = 0.27 +- 0.148 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 6 = 0.284 +- 0.148 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 7 = 0.303 +- 0.148 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 8 = 0.258 +- 0.148 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 9 = 0.279 +- 0.148 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 all KL = 0.162 +- 0.148 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 all L1 = 0.293 +- 0.090 (in-sample avg dev_std = 0.508)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.549
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.344
SUFF++ for r=0.9 class 0 = 0.296 +- 0.189 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.9 class 1 = 0.71 +- 0.189 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.9 class 2 = 0.468 +- 0.189 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.9 class 3 = 0.351 +- 0.189 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.9 class 4 = 0.31 +- 0.189 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.9 class 5 = 0.352 +- 0.189 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.9 class 6 = 0.349 +- 0.189 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.9 class 7 = 0.38 +- 0.189 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.9 class 8 = 0.328 +- 0.189 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.9 class 9 = 0.334 +- 0.189 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.9 all KL = 0.171 +- 0.189 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.9 all L1 = 0.393 +- 0.192 (in-sample avg dev_std = 0.558)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.119
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.399 +- 0.249 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 1 = 0.386 +- 0.249 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 2 = 0.359 +- 0.249 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 3 = 0.377 +- 0.249 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 4 = 0.405 +- 0.249 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 5 = 0.409 +- 0.249 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 6 = 0.364 +- 0.249 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 7 = 0.4 +- 0.249 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 8 = 0.404 +- 0.249 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 9 = 0.416 +- 0.249 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 all KL = 0.37 +- 0.249 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 all L1 = 0.391 +- 0.144 (in-sample avg dev_std = 0.400)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.184
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.167
SUFF++ for r=0.6 class 0 = 0.388 +- 0.193 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.6 class 1 = 0.489 +- 0.193 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.6 class 2 = 0.379 +- 0.193 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.6 class 3 = 0.353 +- 0.193 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.6 class 4 = 0.371 +- 0.193 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.6 class 5 = 0.363 +- 0.193 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.6 class 6 = 0.376 +- 0.193 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.6 class 7 = 0.356 +- 0.193 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.6 class 8 = 0.342 +- 0.193 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.6 class 9 = 0.317 +- 0.193 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.6 all KL = 0.194 +- 0.193 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.6 all L1 = 0.375 +- 0.154 (in-sample avg dev_std = 0.602)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.168
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.178
SUFF++ for r=0.9 class 0 = 0.369 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 1 = 0.66 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 2 = 0.457 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 3 = 0.452 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 4 = 0.335 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 5 = 0.387 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 6 = 0.368 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 7 = 0.432 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 8 = 0.341 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 9 = 0.351 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 all KL = 0.242 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 all L1 = 0.419 +- 0.254 (in-sample avg dev_std = 0.460)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.114
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
NEC for r=0.3 class 0 = 0.598 +- 0.292 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 1 = 0.449 +- 0.292 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 2 = 0.552 +- 0.292 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 3 = 0.552 +- 0.292 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 4 = 0.558 +- 0.292 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 5 = 0.563 +- 0.292 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 6 = 0.517 +- 0.292 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 7 = 0.49 +- 0.292 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 8 = 0.638 +- 0.292 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 9 = 0.579 +- 0.292 (in-sample avg dev_std = 0.377)
NEC for r=0.3 all KL = 0.555 +- 0.292 (in-sample avg dev_std = 0.377)
NEC for r=0.3 all L1 = 0.547 +- 0.194 (in-sample avg dev_std = 0.377)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.18
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.154
NEC for r=0.6 class 0 = 0.663 +- 0.242 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 1 = 0.499 +- 0.242 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 2 = 0.622 +- 0.242 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 3 = 0.615 +- 0.242 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 4 = 0.633 +- 0.242 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 5 = 0.622 +- 0.242 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 6 = 0.624 +- 0.242 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 7 = 0.55 +- 0.242 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 8 = 0.628 +- 0.242 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 9 = 0.641 +- 0.242 (in-sample avg dev_std = 0.408)
NEC for r=0.6 all KL = 0.669 +- 0.242 (in-sample avg dev_std = 0.408)
NEC for r=0.6 all L1 = 0.607 +- 0.161 (in-sample avg dev_std = 0.408)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.771
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.649
NEC for r=0.9 class 0 = 0.556 +- 0.300 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 1 = 0.253 +- 0.300 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 2 = 0.33 +- 0.300 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 3 = 0.427 +- 0.300 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 4 = 0.408 +- 0.300 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 5 = 0.57 +- 0.300 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 6 = 0.542 +- 0.300 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 7 = 0.348 +- 0.300 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 8 = 0.364 +- 0.300 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 9 = 0.616 +- 0.300 (in-sample avg dev_std = 0.446)
NEC for r=0.9 all KL = 0.555 +- 0.300 (in-sample avg dev_std = 0.446)
NEC for r=0.9 all L1 = 0.434 +- 0.245 (in-sample avg dev_std = 0.446)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.931
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.85
NEC for r=1.0 class 0 = 0.131 +- 0.302 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 1 = 0.037 +- 0.302 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 2 = 0.204 +- 0.302 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 3 = 0.282 +- 0.302 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 4 = 0.153 +- 0.302 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 5 = 0.371 +- 0.302 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 6 = 0.243 +- 0.302 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 7 = 0.219 +- 0.302 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 8 = 0.196 +- 0.302 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 9 = 0.373 +- 0.302 (in-sample avg dev_std = 0.332)
NEC for r=1.0 all KL = 0.293 +- 0.302 (in-sample avg dev_std = 0.332)
NEC for r=1.0 all L1 = 0.216 +- 0.236 (in-sample avg dev_std = 0.332)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.115
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
NEC for r=0.3 class 0 = 0.514 +- 0.275 (in-sample avg dev_std = 0.359)
NEC for r=0.3 class 1 = 0.461 +- 0.275 (in-sample avg dev_std = 0.359)
NEC for r=0.3 class 2 = 0.51 +- 0.275 (in-sample avg dev_std = 0.359)
NEC for r=0.3 class 3 = 0.535 +- 0.275 (in-sample avg dev_std = 0.359)
NEC for r=0.3 class 4 = 0.452 +- 0.275 (in-sample avg dev_std = 0.359)
NEC for r=0.3 class 5 = 0.503 +- 0.275 (in-sample avg dev_std = 0.359)
NEC for r=0.3 class 6 = 0.5 +- 0.275 (in-sample avg dev_std = 0.359)
NEC for r=0.3 class 7 = 0.457 +- 0.275 (in-sample avg dev_std = 0.359)
NEC for r=0.3 class 8 = 0.548 +- 0.275 (in-sample avg dev_std = 0.359)
NEC for r=0.3 class 9 = 0.442 +- 0.275 (in-sample avg dev_std = 0.359)
NEC for r=0.3 all KL = 0.446 +- 0.275 (in-sample avg dev_std = 0.359)
NEC for r=0.3 all L1 = 0.491 +- 0.194 (in-sample avg dev_std = 0.359)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.162
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.139
NEC for r=0.6 class 0 = 0.626 +- 0.256 (in-sample avg dev_std = 0.402)
NEC for r=0.6 class 1 = 0.362 +- 0.256 (in-sample avg dev_std = 0.402)
NEC for r=0.6 class 2 = 0.608 +- 0.256 (in-sample avg dev_std = 0.402)
NEC for r=0.6 class 3 = 0.586 +- 0.256 (in-sample avg dev_std = 0.402)
NEC for r=0.6 class 4 = 0.588 +- 0.256 (in-sample avg dev_std = 0.402)
NEC for r=0.6 class 5 = 0.601 +- 0.256 (in-sample avg dev_std = 0.402)
NEC for r=0.6 class 6 = 0.558 +- 0.256 (in-sample avg dev_std = 0.402)
NEC for r=0.6 class 7 = 0.547 +- 0.256 (in-sample avg dev_std = 0.402)
NEC for r=0.6 class 8 = 0.599 +- 0.256 (in-sample avg dev_std = 0.402)
NEC for r=0.6 class 9 = 0.546 +- 0.256 (in-sample avg dev_std = 0.402)
NEC for r=0.6 all KL = 0.604 +- 0.256 (in-sample avg dev_std = 0.402)
NEC for r=0.6 all L1 = 0.558 +- 0.181 (in-sample avg dev_std = 0.402)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.549
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.487
NEC for r=0.9 class 0 = 0.523 +- 0.290 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 1 = 0.166 +- 0.290 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 2 = 0.434 +- 0.290 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 3 = 0.466 +- 0.290 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 4 = 0.587 +- 0.290 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 5 = 0.562 +- 0.290 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 6 = 0.621 +- 0.290 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 7 = 0.505 +- 0.290 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 8 = 0.576 +- 0.290 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 9 = 0.615 +- 0.290 (in-sample avg dev_std = 0.438)
NEC for r=0.9 all KL = 0.597 +- 0.290 (in-sample avg dev_std = 0.438)
NEC for r=0.9 all L1 = 0.5 +- 0.243 (in-sample avg dev_std = 0.438)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.788
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.713
NEC for r=1.0 class 0 = 0.205 +- 0.303 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 1 = 0.035 +- 0.303 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 2 = 0.264 +- 0.303 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 3 = 0.334 +- 0.303 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 4 = 0.352 +- 0.303 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 5 = 0.377 +- 0.303 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 6 = 0.385 +- 0.303 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 7 = 0.254 +- 0.303 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 8 = 0.389 +- 0.303 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 9 = 0.442 +- 0.303 (in-sample avg dev_std = 0.378)
NEC for r=1.0 all KL = 0.36 +- 0.303 (in-sample avg dev_std = 0.378)
NEC for r=1.0 all L1 = 0.299 +- 0.251 (in-sample avg dev_std = 0.378)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.119
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
NEC for r=0.3 class 0 = 0.577 +- 0.283 (in-sample avg dev_std = 0.356)
NEC for r=0.3 class 1 = 0.493 +- 0.283 (in-sample avg dev_std = 0.356)
NEC for r=0.3 class 2 = 0.538 +- 0.283 (in-sample avg dev_std = 0.356)
NEC for r=0.3 class 3 = 0.563 +- 0.283 (in-sample avg dev_std = 0.356)
NEC for r=0.3 class 4 = 0.493 +- 0.283 (in-sample avg dev_std = 0.356)
NEC for r=0.3 class 5 = 0.584 +- 0.283 (in-sample avg dev_std = 0.356)
NEC for r=0.3 class 6 = 0.557 +- 0.283 (in-sample avg dev_std = 0.356)
NEC for r=0.3 class 7 = 0.53 +- 0.283 (in-sample avg dev_std = 0.356)
NEC for r=0.3 class 8 = 0.551 +- 0.283 (in-sample avg dev_std = 0.356)
NEC for r=0.3 class 9 = 0.506 +- 0.283 (in-sample avg dev_std = 0.356)
NEC for r=0.3 all KL = 0.513 +- 0.283 (in-sample avg dev_std = 0.356)
NEC for r=0.3 all L1 = 0.538 +- 0.181 (in-sample avg dev_std = 0.356)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.184
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.198
NEC for r=0.6 class 0 = 0.341 +- 0.344 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 1 = 0.312 +- 0.344 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 2 = 0.365 +- 0.344 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 3 = 0.398 +- 0.344 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 4 = 0.435 +- 0.344 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 5 = 0.441 +- 0.344 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 6 = 0.449 +- 0.344 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 7 = 0.47 +- 0.344 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 8 = 0.466 +- 0.344 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 9 = 0.519 +- 0.344 (in-sample avg dev_std = 0.352)
NEC for r=0.6 all KL = 0.486 +- 0.344 (in-sample avg dev_std = 0.352)
NEC for r=0.6 all L1 = 0.417 +- 0.277 (in-sample avg dev_std = 0.352)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.168
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.218
NEC for r=0.9 class 0 = 0.595 +- 0.337 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 1 = 0.381 +- 0.337 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 2 = 0.485 +- 0.337 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 3 = 0.522 +- 0.337 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 4 = 0.664 +- 0.337 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 5 = 0.56 +- 0.337 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 6 = 0.639 +- 0.337 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 7 = 0.58 +- 0.337 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 8 = 0.669 +- 0.337 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 9 = 0.677 +- 0.337 (in-sample avg dev_std = 0.367)
NEC for r=0.9 all KL = 0.672 +- 0.337 (in-sample avg dev_std = 0.367)
NEC for r=0.9 all L1 = 0.574 +- 0.274 (in-sample avg dev_std = 0.367)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.241
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.29
NEC for r=1.0 class 0 = 0.575 +- 0.306 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 1 = 0.441 +- 0.306 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 2 = 0.643 +- 0.306 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 3 = 0.622 +- 0.306 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 4 = 0.697 +- 0.306 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 5 = 0.627 +- 0.306 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 6 = 0.643 +- 0.306 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 7 = 0.713 +- 0.306 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 8 = 0.647 +- 0.306 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 9 = 0.697 +- 0.306 (in-sample avg dev_std = 0.371)
NEC for r=1.0 all KL = 0.743 +- 0.306 (in-sample avg dev_std = 0.371)
NEC for r=1.0 all L1 = 0.628 +- 0.242 (in-sample avg dev_std = 0.371)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.793, 0.274, 0.157, 1.0], 'all_L1': [0.785, 0.368, 0.367, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.175, 0.102, 1.0], 'all_L1': [0.511, 0.294, 0.343, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.604, 0.208, 0.092, 1.0], 'all_L1': [0.609, 0.3, 0.33, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.323, 0.361, 0.148, 1.0], 'all_L1': [0.424, 0.452, 0.365, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.441, 0.18, 0.119, 1.0], 'all_L1': [0.445, 0.299, 0.366, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.224, 0.59, 0.565, 0.313], 'all_L1': [0.228, 0.554, 0.448, 0.232]}), defaultdict(<class 'list'>, {'all_KL': [0.635, 0.762, 0.562, 0.309], 'all_L1': [0.534, 0.652, 0.427, 0.223]}), defaultdict(<class 'list'>, {'all_KL': [0.463, 0.689, 0.564, 0.305], 'all_L1': [0.426, 0.631, 0.434, 0.213]}), defaultdict(<class 'list'>, {'all_KL': [0.667, 0.559, 0.592, 0.325], 'all_L1': [0.584, 0.511, 0.466, 0.23]}), defaultdict(<class 'list'>, {'all_KL': [0.555, 0.669, 0.555, 0.293], 'all_L1': [0.547, 0.607, 0.434, 0.216]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.683, 0.187, 0.189, 1.0], 'all_L1': [0.687, 0.391, 0.353, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.481, 0.119, 0.169, 1.0], 'all_L1': [0.554, 0.277, 0.37, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.757, 0.239, 0.094, 1.0], 'all_L1': [0.738, 0.312, 0.288, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.355, 0.511, 0.236, 1.0], 'all_L1': [0.419, 0.582, 0.373, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.498, 0.162, 0.171, 1.0], 'all_L1': [0.462, 0.293, 0.393, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.254, 0.445, 0.606, 0.362], 'all_L1': [0.273, 0.397, 0.525, 0.312]}), defaultdict(<class 'list'>, {'all_KL': [0.526, 0.651, 0.634, 0.391], 'all_L1': [0.45, 0.542, 0.523, 0.325]}), defaultdict(<class 'list'>, {'all_KL': [0.273, 0.62, 0.668, 0.414], 'all_L1': [0.283, 0.589, 0.562, 0.331]}), defaultdict(<class 'list'>, {'all_KL': [0.573, 0.444, 0.633, 0.389], 'all_L1': [0.55, 0.405, 0.54, 0.34]}), defaultdict(<class 'list'>, {'all_KL': [0.446, 0.604, 0.597, 0.36], 'all_L1': [0.491, 0.558, 0.5, 0.299]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.558, 0.465, 0.389, 1.0], 'all_L1': [0.599, 0.609, 0.517, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.421, 0.194, 0.373, 1.0], 'all_L1': [0.478, 0.341, 0.516, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.459, 0.121, 0.081, 1.0], 'all_L1': [0.529, 0.308, 0.308, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.416, 0.701, 0.439, 1.0], 'all_L1': [0.503, 0.721, 0.559, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.37, 0.194, 0.242, 1.0], 'all_L1': [0.391, 0.375, 0.419, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.366, 0.306, 0.578, 0.454], 'all_L1': [0.367, 0.302, 0.476, 0.438]}), defaultdict(<class 'list'>, {'all_KL': [0.562, 0.632, 0.587, 0.512], 'all_L1': [0.506, 0.554, 0.478, 0.465]}), defaultdict(<class 'list'>, {'all_KL': [0.571, 0.841, 0.818, 0.75], 'all_L1': [0.513, 0.709, 0.68, 0.625]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.295, 0.704, 0.618], 'all_L1': [0.475, 0.28, 0.499, 0.442]}), defaultdict(<class 'list'>, {'all_KL': [0.513, 0.486, 0.672, 0.743], 'all_L1': [0.538, 0.417, 0.574, 0.628]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.555 +- 0.132, 0.343 +- 0.061, 0.354 +- 0.015, 1.000 +- 0.000
suff++ class all_KL  =  0.520 +- 0.163, 0.240 +- 0.070, 0.124 +- 0.025, 1.000 +- 0.000
suff++_acc_int  =  0.107 +- 0.009, 0.121 +- 0.006, 0.390 +- 0.017
nec class all_L1  =  0.464 +- 0.129, 0.591 +- 0.052, 0.442 +- 0.014, 0.223 +- 0.007
nec class all_KL  =  0.509 +- 0.159, 0.654 +- 0.072, 0.568 +- 0.013, 0.309 +- 0.010
nec_acc_int  =  0.109 +- 0.006, 0.130 +- 0.014, 0.644 +- 0.025, 0.841 +- 0.005

Eval split val
suff++ class all_L1  =  0.572 +- 0.124, 0.371 +- 0.113, 0.355 +- 0.036, 1.000 +- 0.000
suff++ class all_KL  =  0.555 +- 0.146, 0.244 +- 0.139, 0.172 +- 0.046, 1.000 +- 0.000
suff++_acc_int  =  0.107 +- 0.004, 0.113 +- 0.013, 0.285 +- 0.033
nec class all_L1  =  0.409 +- 0.112, 0.498 +- 0.081, 0.530 +- 0.020, 0.321 +- 0.014
nec class all_KL  =  0.414 +- 0.130, 0.553 +- 0.090, 0.628 +- 0.025, 0.383 +- 0.020
nec_acc_int  =  0.112 +- 0.005, 0.111 +- 0.015, 0.446 +- 0.024, 0.697 +- 0.016

Eval split test
suff++ class all_L1  =  0.500 +- 0.068, 0.471 +- 0.164, 0.464 +- 0.090, 1.000 +- 0.000
suff++ class all_KL  =  0.445 +- 0.063, 0.335 +- 0.217, 0.305 +- 0.129, 1.000 +- 0.000
suff++_acc_int  =  0.107 +- 0.007, 0.123 +- 0.022, 0.172 +- 0.026
nec class all_L1  =  0.480 +- 0.060, 0.452 +- 0.161, 0.541 +- 0.078, 0.520 +- 0.088
nec class all_KL  =  0.509 +- 0.074, 0.512 +- 0.206, 0.672 +- 0.088, 0.615 +- 0.119
nec_acc_int  =  0.114 +- 0.002, 0.153 +- 0.035, 0.212 +- 0.026, 0.290 +- 0.043


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.509 +- 0.010, 0.467 +- 0.010, 0.398 +- 0.013, 0.611 +- 0.004
Faith. Armon (L1)= 		  =  0.472 +- 0.060, 0.427 +- 0.030, 0.393 +- 0.013, 0.364 +- 0.010
Faith. GMean (L1)= 	  =  0.489 +- 0.035, 0.446 +- 0.019, 0.396 +- 0.013, 0.472 +- 0.008
Faith. Aritm (KL)= 		  =  0.514 +- 0.017, 0.447 +- 0.017, 0.346 +- 0.017, 0.655 +- 0.005
Faith. Armon (KL)= 		  =  0.464 +- 0.065, 0.340 +- 0.059, 0.202 +- 0.034, 0.472 +- 0.012
Faith. GMean (KL)= 	  =  0.487 +- 0.041, 0.388 +- 0.035, 0.264 +- 0.029, 0.556 +- 0.009

Eval split val
Faith. Aritm (L1)= 		  =  0.491 +- 0.013, 0.435 +- 0.035, 0.443 +- 0.010, 0.661 +- 0.007
Faith. Armon (L1)= 		  =  0.450 +- 0.042, 0.406 +- 0.038, 0.424 +- 0.022, 0.486 +- 0.017
Faith. GMean (L1)= 	  =  0.469 +- 0.022, 0.420 +- 0.036, 0.433 +- 0.016, 0.567 +- 0.013
Faith. Aritm (KL)= 		  =  0.485 +- 0.021, 0.398 +- 0.054, 0.400 +- 0.019, 0.692 +- 0.010
Faith. Armon (KL)= 		  =  0.437 +- 0.047, 0.308 +- 0.095, 0.266 +- 0.058, 0.554 +- 0.021
Faith. GMean (KL)= 	  =  0.459 +- 0.028, 0.348 +- 0.074, 0.324 +- 0.044, 0.619 +- 0.016

Eval split test
Faith. Aritm (L1)= 		  =  0.490 +- 0.018, 0.462 +- 0.041, 0.503 +- 0.013, 0.760 +- 0.044
Faith. Armon (L1)= 		  =  0.482 +- 0.025, 0.411 +- 0.013, 0.486 +- 0.034, 0.680 +- 0.075
Faith. GMean (L1)= 	  =  0.486 +- 0.021, 0.435 +- 0.024, 0.494 +- 0.022, 0.718 +- 0.060
Faith. Aritm (KL)= 		  =  0.477 +- 0.025, 0.423 +- 0.059, 0.488 +- 0.044, 0.808 +- 0.060
Faith. Armon (KL)= 		  =  0.466 +- 0.028, 0.314 +- 0.071, 0.393 +- 0.136, 0.755 +- 0.093
Faith. GMean (KL)= 	  =  0.471 +- 0.027, 0.362 +- 0.053, 0.432 +- 0.100, 0.781 +- 0.077
Computed for split load_split = id



Completed in  2:31:10.737476  for GSATvGIN GOODCMNIST/color



DONE GSAT GOODCMNIST/color

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 16:26:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/22/2024 04:26:24 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 04:26:55 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:05 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:16 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:32 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 04:27:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ROC-AUC: 0.9769
Train Loss: 0.1241
ID Validation ROC-AUC: 0.9251
ID Validation Loss: 0.2646
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2693
OOD Validation ROC-AUC: 0.6274
OOD Validation Loss: 0.5719
OOD Test ROC-AUC: 0.7014
OOD Test Loss: 0.7027

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8627
Train Loss: 0.3460
ID Validation ROC-AUC: 0.8591
ID Validation Loss: 0.3495
ID Test ROC-AUC: 0.8621
ID Test Loss: 0.3525
OOD Validation ROC-AUC: 0.7045
OOD Validation Loss: 0.2921
OOD Test ROC-AUC: 0.7135
OOD Test Loss: 0.5263

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7014 0.8621 0.7135 0.8591 0.7045[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 04/22/2024 04:27:49 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19028)
Data example from val: Data(x=[23, 39], edge_index=[2, 50], edge_attr=[50, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 50], node_perm=[23])
Label distribution from val: (tensor([0., 1.]), tensor([ 1602, 17426]))
[1;34mDEBUG[0m: 04/22/2024 04:27:54 PM : [1mUnbalanced warning for LBAPcore (val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 04/22/2024 04:27:59 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.58
SUFF++ for r=0.3 class 0.0 = 0.67 +- 0.196 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.3 class 1.0 = 0.622 +- 0.196 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.3 all KL = 0.687 +- 0.196 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.3 all L1 = 0.628 +- 0.146 (in-sample avg dev_std = 0.484)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.649
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.588
SUFF++ for r=0.6 class 0.0 = 0.715 +- 0.198 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 1.0 = 0.656 +- 0.198 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all KL = 0.734 +- 0.198 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all L1 = 0.663 +- 0.156 (in-sample avg dev_std = 0.440)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.657
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.64
SUFF++ for r=0.9 class 0.0 = 0.825 +- 0.160 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 1.0 = 0.753 +- 0.160 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all KL = 0.869 +- 0.160 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all L1 = 0.762 +- 0.170 (in-sample avg dev_std = 0.277)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.509
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.519
SUFF++ for r=0.3 class 0.0 = 0.631 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 1.0 = 0.639 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 all KL = 0.69 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 all L1 = 0.638 +- 0.150 (in-sample avg dev_std = 0.476)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.523
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.56
SUFF++ for r=0.6 class 0.0 = 0.655 +- 0.178 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 1.0 = 0.659 +- 0.178 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all KL = 0.748 +- 0.178 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all L1 = 0.659 +- 0.146 (in-sample avg dev_std = 0.429)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.524
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.553
SUFF++ for r=0.9 class 0.0 = 0.78 +- 0.144 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 1.0 = 0.769 +- 0.144 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 all KL = 0.886 +- 0.144 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 all L1 = 0.77 +- 0.159 (in-sample avg dev_std = 0.260)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.589
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.553
SUFF++ for r=0.3 class 0.0 = 0.664 +- 0.203 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 1.0 = 0.646 +- 0.203 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 all KL = 0.69 +- 0.203 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 all L1 = 0.649 +- 0.149 (in-sample avg dev_std = 0.480)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.583
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.566
SUFF++ for r=0.6 class 0.0 = 0.72 +- 0.196 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 1.0 = 0.68 +- 0.196 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all KL = 0.753 +- 0.196 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all L1 = 0.686 +- 0.155 (in-sample avg dev_std = 0.430)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.593
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.574
SUFF++ for r=0.9 class 0.0 = 0.828 +- 0.150 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 1.0 = 0.778 +- 0.150 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 all KL = 0.888 +- 0.150 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 all L1 = 0.786 +- 0.158 (in-sample avg dev_std = 0.269)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.651
NEC for r=0.3 class 0.0 = 0.24 +- 0.195 (in-sample avg dev_std = 0.307)
NEC for r=0.3 class 1.0 = 0.247 +- 0.195 (in-sample avg dev_std = 0.307)
NEC for r=0.3 all KL = 0.16 +- 0.195 (in-sample avg dev_std = 0.307)
NEC for r=0.3 all L1 = 0.246 +- 0.191 (in-sample avg dev_std = 0.307)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.649
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.654
NEC for r=0.6 class 0.0 = 0.189 +- 0.167 (in-sample avg dev_std = 0.288)
NEC for r=0.6 class 1.0 = 0.222 +- 0.167 (in-sample avg dev_std = 0.288)
NEC for r=0.6 all KL = 0.131 +- 0.167 (in-sample avg dev_std = 0.288)
NEC for r=0.6 all L1 = 0.219 +- 0.169 (in-sample avg dev_std = 0.288)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.657
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.651
NEC for r=0.9 class 0.0 = 0.166 +- 0.127 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 1.0 = 0.199 +- 0.127 (in-sample avg dev_std = 0.252)
NEC for r=0.9 all KL = 0.096 +- 0.127 (in-sample avg dev_std = 0.252)
NEC for r=0.9 all L1 = 0.195 +- 0.143 (in-sample avg dev_std = 0.252)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.667
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.656
NEC for r=1.0 class 0.0 = 0.167 +- 0.109 (in-sample avg dev_std = 0.243)
NEC for r=1.0 class 1.0 = 0.19 +- 0.109 (in-sample avg dev_std = 0.243)
NEC for r=1.0 all KL = 0.084 +- 0.109 (in-sample avg dev_std = 0.243)
NEC for r=1.0 all L1 = 0.187 +- 0.135 (in-sample avg dev_std = 0.243)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.51
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.557
NEC for r=0.3 class 0.0 = 0.282 +- 0.202 (in-sample avg dev_std = 0.319)
NEC for r=0.3 class 1.0 = 0.254 +- 0.202 (in-sample avg dev_std = 0.319)
NEC for r=0.3 all KL = 0.175 +- 0.202 (in-sample avg dev_std = 0.319)
NEC for r=0.3 all L1 = 0.256 +- 0.200 (in-sample avg dev_std = 0.319)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.523
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.572
NEC for r=0.6 class 0.0 = 0.252 +- 0.158 (in-sample avg dev_std = 0.289)
NEC for r=0.6 class 1.0 = 0.229 +- 0.158 (in-sample avg dev_std = 0.289)
NEC for r=0.6 all KL = 0.132 +- 0.158 (in-sample avg dev_std = 0.289)
NEC for r=0.6 all L1 = 0.231 +- 0.171 (in-sample avg dev_std = 0.289)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.524
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.548
NEC for r=0.9 class 0.0 = 0.208 +- 0.119 (in-sample avg dev_std = 0.254)
NEC for r=0.9 class 1.0 = 0.202 +- 0.119 (in-sample avg dev_std = 0.254)
NEC for r=0.9 all KL = 0.094 +- 0.119 (in-sample avg dev_std = 0.254)
NEC for r=0.9 all L1 = 0.202 +- 0.138 (in-sample avg dev_std = 0.254)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.531
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.544
NEC for r=1.0 class 0.0 = 0.189 +- 0.113 (in-sample avg dev_std = 0.253)
NEC for r=1.0 class 1.0 = 0.195 +- 0.113 (in-sample avg dev_std = 0.253)
NEC for r=1.0 all KL = 0.087 +- 0.113 (in-sample avg dev_std = 0.253)
NEC for r=1.0 all L1 = 0.195 +- 0.132 (in-sample avg dev_std = 0.253)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.589
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.603
NEC for r=0.3 class 0.0 = 0.23 +- 0.210 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 1.0 = 0.246 +- 0.210 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all KL = 0.167 +- 0.210 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all L1 = 0.243 +- 0.205 (in-sample avg dev_std = 0.309)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.583
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.577
NEC for r=0.6 class 0.0 = 0.196 +- 0.161 (in-sample avg dev_std = 0.271)
NEC for r=0.6 class 1.0 = 0.216 +- 0.161 (in-sample avg dev_std = 0.271)
NEC for r=0.6 all KL = 0.125 +- 0.161 (in-sample avg dev_std = 0.271)
NEC for r=0.6 all L1 = 0.213 +- 0.176 (in-sample avg dev_std = 0.271)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.593
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.57
NEC for r=0.9 class 0.0 = 0.177 +- 0.113 (in-sample avg dev_std = 0.235)
NEC for r=0.9 class 1.0 = 0.191 +- 0.113 (in-sample avg dev_std = 0.235)
NEC for r=0.9 all KL = 0.086 +- 0.113 (in-sample avg dev_std = 0.235)
NEC for r=0.9 all L1 = 0.189 +- 0.143 (in-sample avg dev_std = 0.235)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.592
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.574
NEC for r=1.0 class 0.0 = 0.165 +- 0.121 (in-sample avg dev_std = 0.237)
NEC for r=1.0 class 1.0 = 0.189 +- 0.121 (in-sample avg dev_std = 0.237)
NEC for r=1.0 all KL = 0.085 +- 0.121 (in-sample avg dev_std = 0.237)
NEC for r=1.0 all L1 = 0.185 +- 0.137 (in-sample avg dev_std = 0.237)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 16:32:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/22/2024 04:32:16 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 04:32:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 04:32:57 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:24 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:33:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 04:33:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ROC-AUC: 0.9559
Train Loss: 0.1818
ID Validation ROC-AUC: 0.9207
ID Validation Loss: 0.2309
ID Test ROC-AUC: 0.9188
ID Test Loss: 0.2372
OOD Validation ROC-AUC: 0.6575
OOD Validation Loss: 0.3564
OOD Test ROC-AUC: 0.7045
OOD Test Loss: 0.5081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 6...
[0m[1;37mINFO[0m: [1mCheckpoint 6: 
-----------------------------------
Train ROC-AUC: 0.8717
Train Loss: 0.3292
ID Validation ROC-AUC: 0.8694
ID Validation Loss: 0.3314
ID Test ROC-AUC: 0.8710
ID Test Loss: 0.3354
OOD Validation ROC-AUC: 0.7102
OOD Validation Loss: 0.2911
OOD Test ROC-AUC: 0.7280
OOD Test Loss: 0.5120

[0m[1;37mINFO[0m: [1mChartInfo 0.9188 0.7045 0.8710 0.7280 0.8694 0.7102[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 04/22/2024 04:33:40 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19028)
Data example from val: Data(x=[23, 39], edge_index=[2, 50], edge_attr=[50, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 50], node_perm=[23])
Label distribution from val: (tensor([0., 1.]), tensor([ 1602, 17426]))
[1;34mDEBUG[0m: 04/22/2024 04:33:45 PM : [1mUnbalanced warning for LBAPcore (val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 04/22/2024 04:33:49 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.729
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.699
SUFF++ for r=0.3 class 0.0 = 0.765 +- 0.069 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 1.0 = 0.793 +- 0.069 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 all KL = 0.92 +- 0.069 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 all L1 = 0.79 +- 0.100 (in-sample avg dev_std = 0.238)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.81
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.774
SUFF++ for r=0.6 class 0.0 = 0.74 +- 0.113 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 1.0 = 0.816 +- 0.113 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 all KL = 0.892 +- 0.113 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 all L1 = 0.807 +- 0.144 (in-sample avg dev_std = 0.262)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.84
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.814
SUFF++ for r=0.9 class 0.0 = 0.837 +- 0.081 (in-sample avg dev_std = 0.144)
SUFF++ for r=0.9 class 1.0 = 0.903 +- 0.081 (in-sample avg dev_std = 0.144)
SUFF++ for r=0.9 all KL = 0.954 +- 0.081 (in-sample avg dev_std = 0.144)
SUFF++ for r=0.9 all L1 = 0.896 +- 0.116 (in-sample avg dev_std = 0.144)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.546
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.554
SUFF++ for r=0.3 class 0.0 = 0.762 +- 0.074 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 class 1.0 = 0.759 +- 0.074 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 all KL = 0.911 +- 0.074 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 all L1 = 0.759 +- 0.097 (in-sample avg dev_std = 0.249)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.571
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.583
SUFF++ for r=0.6 class 0.0 = 0.763 +- 0.116 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 class 1.0 = 0.752 +- 0.116 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 all KL = 0.871 +- 0.116 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 all L1 = 0.753 +- 0.137 (in-sample avg dev_std = 0.290)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.619
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.596
SUFF++ for r=0.9 class 0.0 = 0.851 +- 0.103 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 1.0 = 0.847 +- 0.103 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 all KL = 0.933 +- 0.103 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 all L1 = 0.847 +- 0.129 (in-sample avg dev_std = 0.178)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.667
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.627
SUFF++ for r=0.3 class 0.0 = 0.745 +- 0.072 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.3 class 1.0 = 0.766 +- 0.072 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.3 all KL = 0.911 +- 0.072 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.3 all L1 = 0.762 +- 0.096 (in-sample avg dev_std = 0.248)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.692
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.646
SUFF++ for r=0.6 class 0.0 = 0.756 +- 0.116 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.6 class 1.0 = 0.771 +- 0.116 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.6 all KL = 0.883 +- 0.116 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.6 all L1 = 0.769 +- 0.131 (in-sample avg dev_std = 0.272)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.708
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.68
SUFF++ for r=0.9 class 0.0 = 0.83 +- 0.089 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.9 class 1.0 = 0.86 +- 0.089 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.9 all KL = 0.94 +- 0.089 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.9 all L1 = 0.855 +- 0.123 (in-sample avg dev_std = 0.165)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.73
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.687
NEC for r=0.3 class 0.0 = 0.201 +- 0.052 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 1.0 = 0.146 +- 0.052 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all KL = 0.041 +- 0.052 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all L1 = 0.153 +- 0.096 (in-sample avg dev_std = 0.146)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.81
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.786
NEC for r=0.6 class 0.0 = 0.174 +- 0.071 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 1.0 = 0.13 +- 0.071 (in-sample avg dev_std = 0.174)
NEC for r=0.6 all KL = 0.055 +- 0.071 (in-sample avg dev_std = 0.174)
NEC for r=0.6 all L1 = 0.135 +- 0.110 (in-sample avg dev_std = 0.174)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.84
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.831
NEC for r=0.9 class 0.0 = 0.151 +- 0.052 (in-sample avg dev_std = 0.127)
NEC for r=0.9 class 1.0 = 0.081 +- 0.052 (in-sample avg dev_std = 0.127)
NEC for r=0.9 all KL = 0.032 +- 0.052 (in-sample avg dev_std = 0.127)
NEC for r=0.9 all L1 = 0.089 +- 0.095 (in-sample avg dev_std = 0.127)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.848
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.833
NEC for r=1.0 class 0.0 = 0.128 +- 0.042 (in-sample avg dev_std = 0.109)
NEC for r=1.0 class 1.0 = 0.064 +- 0.042 (in-sample avg dev_std = 0.109)
NEC for r=1.0 all KL = 0.023 +- 0.042 (in-sample avg dev_std = 0.109)
NEC for r=1.0 all L1 = 0.071 +- 0.079 (in-sample avg dev_std = 0.109)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.546
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.554
NEC for r=0.3 class 0.0 = 0.192 +- 0.062 (in-sample avg dev_std = 0.169)
NEC for r=0.3 class 1.0 = 0.185 +- 0.062 (in-sample avg dev_std = 0.169)
NEC for r=0.3 all KL = 0.053 +- 0.062 (in-sample avg dev_std = 0.169)
NEC for r=0.3 all L1 = 0.186 +- 0.106 (in-sample avg dev_std = 0.169)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.576
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.593
NEC for r=0.6 class 0.0 = 0.174 +- 0.092 (in-sample avg dev_std = 0.202)
NEC for r=0.6 class 1.0 = 0.182 +- 0.092 (in-sample avg dev_std = 0.202)
NEC for r=0.6 all KL = 0.072 +- 0.092 (in-sample avg dev_std = 0.202)
NEC for r=0.6 all L1 = 0.181 +- 0.117 (in-sample avg dev_std = 0.202)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.619
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.619
NEC for r=0.9 class 0.0 = 0.149 +- 0.072 (in-sample avg dev_std = 0.162)
NEC for r=0.9 class 1.0 = 0.131 +- 0.072 (in-sample avg dev_std = 0.162)
NEC for r=0.9 all KL = 0.049 +- 0.072 (in-sample avg dev_std = 0.162)
NEC for r=0.9 all L1 = 0.132 +- 0.104 (in-sample avg dev_std = 0.162)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.639
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.637
NEC for r=1.0 class 0.0 = 0.123 +- 0.060 (in-sample avg dev_std = 0.139)
NEC for r=1.0 class 1.0 = 0.107 +- 0.060 (in-sample avg dev_std = 0.139)
NEC for r=1.0 all KL = 0.037 +- 0.060 (in-sample avg dev_std = 0.139)
NEC for r=1.0 all L1 = 0.108 +- 0.096 (in-sample avg dev_std = 0.139)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.667
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.641
NEC for r=0.3 class 0.0 = 0.182 +- 0.067 (in-sample avg dev_std = 0.160)
NEC for r=0.3 class 1.0 = 0.179 +- 0.067 (in-sample avg dev_std = 0.160)
NEC for r=0.3 all KL = 0.051 +- 0.067 (in-sample avg dev_std = 0.160)
NEC for r=0.3 all L1 = 0.18 +- 0.107 (in-sample avg dev_std = 0.160)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.692
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.697
NEC for r=0.6 class 0.0 = 0.163 +- 0.083 (in-sample avg dev_std = 0.183)
NEC for r=0.6 class 1.0 = 0.163 +- 0.083 (in-sample avg dev_std = 0.183)
NEC for r=0.6 all KL = 0.061 +- 0.083 (in-sample avg dev_std = 0.183)
NEC for r=0.6 all L1 = 0.163 +- 0.111 (in-sample avg dev_std = 0.183)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.708
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.698
NEC for r=0.9 class 0.0 = 0.145 +- 0.070 (in-sample avg dev_std = 0.149)
NEC for r=0.9 class 1.0 = 0.119 +- 0.070 (in-sample avg dev_std = 0.149)
NEC for r=0.9 all KL = 0.043 +- 0.070 (in-sample avg dev_std = 0.149)
NEC for r=0.9 all L1 = 0.123 +- 0.105 (in-sample avg dev_std = 0.149)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.713
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.711
NEC for r=1.0 class 0.0 = 0.121 +- 0.048 (in-sample avg dev_std = 0.125)
NEC for r=1.0 class 1.0 = 0.097 +- 0.048 (in-sample avg dev_std = 0.125)
NEC for r=1.0 all KL = 0.031 +- 0.048 (in-sample avg dev_std = 0.125)
NEC for r=1.0 all L1 = 0.101 +- 0.088 (in-sample avg dev_std = 0.125)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 16:38:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/22/2024 04:38:08 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 04:38:39 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 04:38:49 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 04:38:59 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:15 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 04:39:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9718
Train Loss: 0.1502
ID Validation ROC-AUC: 0.9222
ID Validation Loss: 0.2869
ID Test ROC-AUC: 0.9201
ID Test Loss: 0.2932
OOD Validation ROC-AUC: 0.6430
OOD Validation Loss: 0.5048
OOD Test ROC-AUC: 0.7020
OOD Test Loss: 0.7112

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ROC-AUC: 0.8089
Train Loss: 0.4646
ID Validation ROC-AUC: 0.8084
ID Validation Loss: 0.4676
ID Test ROC-AUC: 0.8095
ID Test Loss: 0.4731
OOD Validation ROC-AUC: 0.6927
OOD Validation Loss: 0.3283
OOD Test ROC-AUC: 0.6938
OOD Test Loss: 0.4537

[0m[1;37mINFO[0m: [1mChartInfo 0.9201 0.7020 0.8095 0.6938 0.8084 0.6927[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 04/22/2024 04:39:32 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19028)
Data example from val: Data(x=[23, 39], edge_index=[2, 50], edge_attr=[50, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 50], node_perm=[23])
Label distribution from val: (tensor([0., 1.]), tensor([ 1602, 17426]))
[1;34mDEBUG[0m: 04/22/2024 04:39:36 PM : [1mUnbalanced warning for LBAPcore (val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 04/22/2024 04:39:40 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.627
SUFF++ for r=0.3 class 0.0 = 0.669 +- 0.213 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 class 1.0 = 0.588 +- 0.213 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 all KL = 0.636 +- 0.213 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 all L1 = 0.598 +- 0.150 (in-sample avg dev_std = 0.543)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.753
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.716
SUFF++ for r=0.6 class 0.0 = 0.652 +- 0.217 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 class 1.0 = 0.689 +- 0.217 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all KL = 0.709 +- 0.217 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all L1 = 0.684 +- 0.197 (in-sample avg dev_std = 0.441)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.799
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.783
SUFF++ for r=0.9 class 0.0 = 0.772 +- 0.174 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 1.0 = 0.854 +- 0.174 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all KL = 0.887 +- 0.174 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all L1 = 0.845 +- 0.176 (in-sample avg dev_std = 0.237)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.542
SUFF++ for r=0.3 class 0.0 = 0.661 +- 0.194 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.3 class 1.0 = 0.627 +- 0.194 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.3 all KL = 0.697 +- 0.194 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.3 all L1 = 0.63 +- 0.144 (in-sample avg dev_std = 0.492)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.619
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.619
SUFF++ for r=0.6 class 0.0 = 0.652 +- 0.218 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 1.0 = 0.657 +- 0.218 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 all KL = 0.701 +- 0.218 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 all L1 = 0.657 +- 0.178 (in-sample avg dev_std = 0.462)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.651
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.654
SUFF++ for r=0.9 class 0.0 = 0.793 +- 0.189 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.9 class 1.0 = 0.809 +- 0.189 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.9 all KL = 0.864 +- 0.189 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.9 all L1 = 0.807 +- 0.176 (in-sample avg dev_std = 0.268)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.541
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.561
SUFF++ for r=0.3 class 0.0 = 0.675 +- 0.202 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.3 class 1.0 = 0.622 +- 0.202 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.3 all KL = 0.694 +- 0.202 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.3 all L1 = 0.631 +- 0.150 (in-sample avg dev_std = 0.502)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.614
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.618
SUFF++ for r=0.6 class 0.0 = 0.642 +- 0.216 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 class 1.0 = 0.65 +- 0.216 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 all KL = 0.7 +- 0.216 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 all L1 = 0.649 +- 0.184 (in-sample avg dev_std = 0.464)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.664
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.645
SUFF++ for r=0.9 class 0.0 = 0.78 +- 0.169 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 1.0 = 0.814 +- 0.169 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 all KL = 0.875 +- 0.169 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 all L1 = 0.808 +- 0.173 (in-sample avg dev_std = 0.263)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.613
NEC for r=0.3 class 0.0 = 0.223 +- 0.201 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 1.0 = 0.285 +- 0.201 (in-sample avg dev_std = 0.339)
NEC for r=0.3 all KL = 0.196 +- 0.201 (in-sample avg dev_std = 0.339)
NEC for r=0.3 all L1 = 0.278 +- 0.178 (in-sample avg dev_std = 0.339)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.752
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.746
NEC for r=0.6 class 0.0 = 0.236 +- 0.189 (in-sample avg dev_std = 0.312)
NEC for r=0.6 class 1.0 = 0.222 +- 0.189 (in-sample avg dev_std = 0.312)
NEC for r=0.6 all KL = 0.165 +- 0.189 (in-sample avg dev_std = 0.312)
NEC for r=0.6 all L1 = 0.223 +- 0.186 (in-sample avg dev_std = 0.312)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.799
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.795
NEC for r=0.9 class 0.0 = 0.238 +- 0.146 (in-sample avg dev_std = 0.205)
NEC for r=0.9 class 1.0 = 0.12 +- 0.146 (in-sample avg dev_std = 0.205)
NEC for r=0.9 all KL = 0.09 +- 0.146 (in-sample avg dev_std = 0.205)
NEC for r=0.9 all L1 = 0.134 +- 0.160 (in-sample avg dev_std = 0.205)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.81
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.81
NEC for r=1.0 class 0.0 = 0.21 +- 0.122 (in-sample avg dev_std = 0.188)
NEC for r=1.0 class 1.0 = 0.1 +- 0.122 (in-sample avg dev_std = 0.188)
NEC for r=1.0 all KL = 0.072 +- 0.122 (in-sample avg dev_std = 0.188)
NEC for r=1.0 all L1 = 0.113 +- 0.142 (in-sample avg dev_std = 0.188)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.546
NEC for r=0.3 class 0.0 = 0.268 +- 0.180 (in-sample avg dev_std = 0.312)
NEC for r=0.3 class 1.0 = 0.27 +- 0.180 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all KL = 0.173 +- 0.180 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all L1 = 0.27 +- 0.169 (in-sample avg dev_std = 0.312)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.618
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.622
NEC for r=0.6 class 0.0 = 0.233 +- 0.186 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 1.0 = 0.242 +- 0.186 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all KL = 0.167 +- 0.186 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all L1 = 0.242 +- 0.176 (in-sample avg dev_std = 0.330)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.65
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.663
NEC for r=0.9 class 0.0 = 0.203 +- 0.157 (in-sample avg dev_std = 0.253)
NEC for r=0.9 class 1.0 = 0.172 +- 0.157 (in-sample avg dev_std = 0.253)
NEC for r=0.9 all KL = 0.113 +- 0.157 (in-sample avg dev_std = 0.253)
NEC for r=0.9 all L1 = 0.175 +- 0.162 (in-sample avg dev_std = 0.253)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.664
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.669
NEC for r=1.0 class 0.0 = 0.179 +- 0.144 (in-sample avg dev_std = 0.234)
NEC for r=1.0 class 1.0 = 0.15 +- 0.144 (in-sample avg dev_std = 0.234)
NEC for r=1.0 all KL = 0.1 +- 0.144 (in-sample avg dev_std = 0.234)
NEC for r=1.0 all L1 = 0.152 +- 0.150 (in-sample avg dev_std = 0.234)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.541
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.56
NEC for r=0.3 class 0.0 = 0.237 +- 0.180 (in-sample avg dev_std = 0.302)
NEC for r=0.3 class 1.0 = 0.265 +- 0.180 (in-sample avg dev_std = 0.302)
NEC for r=0.3 all KL = 0.162 +- 0.180 (in-sample avg dev_std = 0.302)
NEC for r=0.3 all L1 = 0.26 +- 0.174 (in-sample avg dev_std = 0.302)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.614
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.624
NEC for r=0.6 class 0.0 = 0.265 +- 0.194 (in-sample avg dev_std = 0.324)
NEC for r=0.6 class 1.0 = 0.251 +- 0.194 (in-sample avg dev_std = 0.324)
NEC for r=0.6 all KL = 0.172 +- 0.194 (in-sample avg dev_std = 0.324)
NEC for r=0.6 all L1 = 0.253 +- 0.183 (in-sample avg dev_std = 0.324)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.664
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.662
NEC for r=0.9 class 0.0 = 0.226 +- 0.154 (in-sample avg dev_std = 0.254)
NEC for r=0.9 class 1.0 = 0.18 +- 0.154 (in-sample avg dev_std = 0.254)
NEC for r=0.9 all KL = 0.117 +- 0.154 (in-sample avg dev_std = 0.254)
NEC for r=0.9 all L1 = 0.187 +- 0.171 (in-sample avg dev_std = 0.254)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.666
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.663
NEC for r=1.0 class 0.0 = 0.2 +- 0.155 (in-sample avg dev_std = 0.238)
NEC for r=1.0 class 1.0 = 0.152 +- 0.155 (in-sample avg dev_std = 0.238)
NEC for r=1.0 all KL = 0.103 +- 0.155 (in-sample avg dev_std = 0.238)
NEC for r=1.0 all L1 = 0.16 +- 0.163 (in-sample avg dev_std = 0.238)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 16:44:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/22/2024 04:44:01 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 04:44:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 04:44:41 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 04:44:52 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 04:45:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ROC-AUC: 0.9605
Train Loss: 0.1572
ID Validation ROC-AUC: 0.9210
ID Validation Loss: 0.2207
ID Test ROC-AUC: 0.9206
ID Test Loss: 0.2229
OOD Validation ROC-AUC: 0.6437
OOD Validation Loss: 0.4343
OOD Test ROC-AUC: 0.7008
OOD Test Loss: 0.5543

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8643
Train Loss: 0.3237
ID Validation ROC-AUC: 0.8622
ID Validation Loss: 0.3271
ID Test ROC-AUC: 0.8643
ID Test Loss: 0.3301
OOD Validation ROC-AUC: 0.7009
OOD Validation Loss: 0.2819
OOD Test ROC-AUC: 0.7289
OOD Test Loss: 0.4908

[0m[1;37mINFO[0m: [1mChartInfo 0.9206 0.7008 0.8643 0.7289 0.8622 0.7009[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 04/22/2024 04:45:24 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19028)
Data example from val: Data(x=[23, 39], edge_index=[2, 50], edge_attr=[50, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 50], node_perm=[23])
Label distribution from val: (tensor([0., 1.]), tensor([ 1602, 17426]))
[1;34mDEBUG[0m: 04/22/2024 04:45:28 PM : [1mUnbalanced warning for LBAPcore (val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 04/22/2024 04:45:32 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.535
SUFF++ for r=0.3 class 0.0 = 0.721 +- 0.127 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.3 class 1.0 = 0.672 +- 0.127 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.3 all KL = 0.832 +- 0.127 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.3 all L1 = 0.678 +- 0.119 (in-sample avg dev_std = 0.347)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.618
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.617
SUFF++ for r=0.6 class 0.0 = 0.765 +- 0.095 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.6 class 1.0 = 0.709 +- 0.095 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.6 all KL = 0.88 +- 0.095 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.6 all L1 = 0.715 +- 0.110 (in-sample avg dev_std = 0.291)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.657
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.669
SUFF++ for r=0.9 class 0.0 = 0.873 +- 0.078 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.9 class 1.0 = 0.803 +- 0.078 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.9 all KL = 0.942 +- 0.078 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.9 all L1 = 0.812 +- 0.116 (in-sample avg dev_std = 0.198)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.494
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.529
SUFF++ for r=0.3 class 0.0 = 0.699 +- 0.110 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.3 class 1.0 = 0.691 +- 0.110 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.3 all KL = 0.852 +- 0.110 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.3 all L1 = 0.691 +- 0.111 (in-sample avg dev_std = 0.330)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.534
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.543
SUFF++ for r=0.6 class 0.0 = 0.746 +- 0.082 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.6 class 1.0 = 0.738 +- 0.082 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.6 all KL = 0.897 +- 0.082 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.6 all L1 = 0.738 +- 0.103 (in-sample avg dev_std = 0.280)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.612
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.601
SUFF++ for r=0.9 class 0.0 = 0.862 +- 0.054 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.9 class 1.0 = 0.845 +- 0.054 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.9 all KL = 0.961 +- 0.054 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.9 all L1 = 0.847 +- 0.099 (in-sample avg dev_std = 0.170)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.5
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.53
SUFF++ for r=0.3 class 0.0 = 0.73 +- 0.099 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 class 1.0 = 0.691 +- 0.099 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 all KL = 0.858 +- 0.099 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 all L1 = 0.698 +- 0.101 (in-sample avg dev_std = 0.327)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.553
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.562
SUFF++ for r=0.6 class 0.0 = 0.76 +- 0.088 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.6 class 1.0 = 0.732 +- 0.088 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.6 all KL = 0.894 +- 0.088 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.6 all L1 = 0.737 +- 0.103 (in-sample avg dev_std = 0.280)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.594
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.595
SUFF++ for r=0.9 class 0.0 = 0.867 +- 0.060 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.9 class 1.0 = 0.838 +- 0.060 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.9 all KL = 0.958 +- 0.060 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.9 all L1 = 0.843 +- 0.104 (in-sample avg dev_std = 0.168)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.533
NEC for r=0.3 class 0.0 = 0.25 +- 0.122 (in-sample avg dev_std = 0.261)
NEC for r=0.3 class 1.0 = 0.272 +- 0.122 (in-sample avg dev_std = 0.261)
NEC for r=0.3 all KL = 0.119 +- 0.122 (in-sample avg dev_std = 0.261)
NEC for r=0.3 all L1 = 0.269 +- 0.138 (in-sample avg dev_std = 0.261)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.618
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.634
NEC for r=0.6 class 0.0 = 0.18 +- 0.083 (in-sample avg dev_std = 0.223)
NEC for r=0.6 class 1.0 = 0.234 +- 0.083 (in-sample avg dev_std = 0.223)
NEC for r=0.6 all KL = 0.078 +- 0.083 (in-sample avg dev_std = 0.223)
NEC for r=0.6 all L1 = 0.228 +- 0.113 (in-sample avg dev_std = 0.223)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.657
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.665
NEC for r=0.9 class 0.0 = 0.127 +- 0.066 (in-sample avg dev_std = 0.193)
NEC for r=0.9 class 1.0 = 0.179 +- 0.066 (in-sample avg dev_std = 0.193)
NEC for r=0.9 all KL = 0.05 +- 0.066 (in-sample avg dev_std = 0.193)
NEC for r=0.9 all L1 = 0.173 +- 0.102 (in-sample avg dev_std = 0.193)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.678
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.687
NEC for r=1.0 class 0.0 = 0.117 +- 0.059 (in-sample avg dev_std = 0.185)
NEC for r=1.0 class 1.0 = 0.166 +- 0.059 (in-sample avg dev_std = 0.185)
NEC for r=1.0 all KL = 0.044 +- 0.059 (in-sample avg dev_std = 0.185)
NEC for r=1.0 all L1 = 0.16 +- 0.097 (in-sample avg dev_std = 0.185)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.494
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.547
NEC for r=0.3 class 0.0 = 0.26 +- 0.111 (in-sample avg dev_std = 0.263)
NEC for r=0.3 class 1.0 = 0.272 +- 0.111 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all KL = 0.115 +- 0.111 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all L1 = 0.271 +- 0.131 (in-sample avg dev_std = 0.263)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.534
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.552
NEC for r=0.6 class 0.0 = 0.221 +- 0.077 (in-sample avg dev_std = 0.231)
NEC for r=0.6 class 1.0 = 0.228 +- 0.077 (in-sample avg dev_std = 0.231)
NEC for r=0.6 all KL = 0.079 +- 0.077 (in-sample avg dev_std = 0.231)
NEC for r=0.6 all L1 = 0.227 +- 0.112 (in-sample avg dev_std = 0.231)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.612
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.604
NEC for r=0.9 class 0.0 = 0.158 +- 0.056 (in-sample avg dev_std = 0.192)
NEC for r=0.9 class 1.0 = 0.166 +- 0.056 (in-sample avg dev_std = 0.192)
NEC for r=0.9 all KL = 0.046 +- 0.056 (in-sample avg dev_std = 0.192)
NEC for r=0.9 all L1 = 0.165 +- 0.098 (in-sample avg dev_std = 0.192)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.621
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.608
NEC for r=1.0 class 0.0 = 0.137 +- 0.050 (in-sample avg dev_std = 0.181)
NEC for r=1.0 class 1.0 = 0.151 +- 0.050 (in-sample avg dev_std = 0.181)
NEC for r=1.0 all KL = 0.039 +- 0.050 (in-sample avg dev_std = 0.181)
NEC for r=1.0 all L1 = 0.149 +- 0.092 (in-sample avg dev_std = 0.181)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.496
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.534
NEC for r=0.3 class 0.0 = 0.273 +- 0.107 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 1.0 = 0.263 +- 0.107 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all KL = 0.108 +- 0.107 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all L1 = 0.265 +- 0.126 (in-sample avg dev_std = 0.252)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.551
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.585
NEC for r=0.6 class 0.0 = 0.191 +- 0.078 (in-sample avg dev_std = 0.224)
NEC for r=0.6 class 1.0 = 0.232 +- 0.078 (in-sample avg dev_std = 0.224)
NEC for r=0.6 all KL = 0.077 +- 0.078 (in-sample avg dev_std = 0.224)
NEC for r=0.6 all L1 = 0.225 +- 0.111 (in-sample avg dev_std = 0.224)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.593
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.607
NEC for r=0.9 class 0.0 = 0.15 +- 0.060 (in-sample avg dev_std = 0.180)
NEC for r=0.9 class 1.0 = 0.163 +- 0.060 (in-sample avg dev_std = 0.180)
NEC for r=0.9 all KL = 0.043 +- 0.060 (in-sample avg dev_std = 0.180)
NEC for r=0.9 all L1 = 0.161 +- 0.095 (in-sample avg dev_std = 0.180)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.598
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.615
NEC for r=1.0 class 0.0 = 0.129 +- 0.052 (in-sample avg dev_std = 0.168)
NEC for r=1.0 class 1.0 = 0.147 +- 0.052 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all KL = 0.036 +- 0.052 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all L1 = 0.144 +- 0.091 (in-sample avg dev_std = 0.168)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 16:49:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/22/2024 04:49:58 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 04:50:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 04:50:41 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 04:50:51 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9755
Train Loss: 0.1331
ID Validation ROC-AUC: 0.9228
ID Validation Loss: 0.2627
ID Test ROC-AUC: 0.9230
ID Test Loss: 0.2676
OOD Validation ROC-AUC: 0.6330
OOD Validation Loss: 0.4920
OOD Test ROC-AUC: 0.6956
OOD Test Loss: 0.6669

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ROC-AUC: 0.8416
Train Loss: 0.7193
ID Validation ROC-AUC: 0.8417
ID Validation Loss: 0.7258
ID Test ROC-AUC: 0.8407
ID Test Loss: 0.7339
OOD Validation ROC-AUC: 0.7030
OOD Validation Loss: 0.4109
OOD Test ROC-AUC: 0.7172
OOD Test Loss: 0.4958

[0m[1;37mINFO[0m: [1mChartInfo 0.9230 0.6956 0.8407 0.7172 0.8417 0.7030[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 04/22/2024 04:51:23 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19028)
Data example from val: Data(x=[23, 39], edge_index=[2, 50], edge_attr=[50, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 50], node_perm=[23])
Label distribution from val: (tensor([0., 1.]), tensor([ 1602, 17426]))
[1;34mDEBUG[0m: 04/22/2024 04:51:28 PM : [1mUnbalanced warning for LBAPcore (val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 04/22/2024 04:51:32 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.579
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.536
SUFF++ for r=0.3 class 0.0 = 0.795 +- 0.173 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 class 1.0 = 0.764 +- 0.173 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 all KL = 0.804 +- 0.173 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 all L1 = 0.767 +- 0.146 (in-sample avg dev_std = 0.401)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.612
SUFF++ for r=0.6 class 0.0 = 0.714 +- 0.200 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 class 1.0 = 0.666 +- 0.200 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all KL = 0.739 +- 0.200 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all L1 = 0.671 +- 0.164 (in-sample avg dev_std = 0.466)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.743
SUFF++ for r=0.9 class 0.0 = 0.811 +- 0.169 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 1.0 = 0.741 +- 0.169 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 all KL = 0.854 +- 0.169 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 all L1 = 0.749 +- 0.166 (in-sample avg dev_std = 0.284)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.427
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.463
SUFF++ for r=0.3 class 0.0 = 0.81 +- 0.147 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.3 class 1.0 = 0.829 +- 0.147 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.3 all KL = 0.871 +- 0.147 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.3 all L1 = 0.827 +- 0.130 (in-sample avg dev_std = 0.315)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.528
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.511
SUFF++ for r=0.6 class 0.0 = 0.722 +- 0.169 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 1.0 = 0.716 +- 0.169 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 all KL = 0.806 +- 0.169 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 all L1 = 0.717 +- 0.155 (in-sample avg dev_std = 0.394)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.575
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.569
SUFF++ for r=0.9 class 0.0 = 0.793 +- 0.133 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 1.0 = 0.759 +- 0.133 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all KL = 0.886 +- 0.133 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all L1 = 0.762 +- 0.144 (in-sample avg dev_std = 0.257)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.59
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.537
SUFF++ for r=0.3 class 0.0 = 0.83 +- 0.161 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 class 1.0 = 0.815 +- 0.161 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 all KL = 0.856 +- 0.161 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 all L1 = 0.818 +- 0.131 (in-sample avg dev_std = 0.345)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.622
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.595
SUFF++ for r=0.6 class 0.0 = 0.757 +- 0.178 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 class 1.0 = 0.713 +- 0.178 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 all KL = 0.796 +- 0.178 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 all L1 = 0.72 +- 0.159 (in-sample avg dev_std = 0.411)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.667
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.627
SUFF++ for r=0.9 class 0.0 = 0.81 +- 0.141 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 class 1.0 = 0.756 +- 0.141 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 all KL = 0.882 +- 0.141 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 all L1 = 0.765 +- 0.157 (in-sample avg dev_std = 0.253)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.579
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.598
NEC for r=0.3 class 0.0 = 0.109 +- 0.130 (in-sample avg dev_std = 0.221)
NEC for r=0.3 class 1.0 = 0.149 +- 0.130 (in-sample avg dev_std = 0.221)
NEC for r=0.3 all KL = 0.085 +- 0.130 (in-sample avg dev_std = 0.221)
NEC for r=0.3 all L1 = 0.144 +- 0.136 (in-sample avg dev_std = 0.221)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.708
NEC for r=0.6 class 0.0 = 0.143 +- 0.157 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 1.0 = 0.213 +- 0.157 (in-sample avg dev_std = 0.282)
NEC for r=0.6 all KL = 0.119 +- 0.157 (in-sample avg dev_std = 0.282)
NEC for r=0.6 all L1 = 0.205 +- 0.162 (in-sample avg dev_std = 0.282)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.748
NEC for r=0.9 class 0.0 = 0.173 +- 0.127 (in-sample avg dev_std = 0.253)
NEC for r=0.9 class 1.0 = 0.209 +- 0.127 (in-sample avg dev_std = 0.253)
NEC for r=0.9 all KL = 0.102 +- 0.127 (in-sample avg dev_std = 0.253)
NEC for r=0.9 all L1 = 0.204 +- 0.142 (in-sample avg dev_std = 0.253)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.792
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.775
NEC for r=1.0 class 0.0 = 0.171 +- 0.115 (in-sample avg dev_std = 0.229)
NEC for r=1.0 class 1.0 = 0.176 +- 0.115 (in-sample avg dev_std = 0.229)
NEC for r=1.0 all KL = 0.085 +- 0.115 (in-sample avg dev_std = 0.229)
NEC for r=1.0 all L1 = 0.176 +- 0.131 (in-sample avg dev_std = 0.229)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.423
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.436
NEC for r=0.3 class 0.0 = 0.134 +- 0.118 (in-sample avg dev_std = 0.199)
NEC for r=0.3 class 1.0 = 0.125 +- 0.118 (in-sample avg dev_std = 0.199)
NEC for r=0.3 all KL = 0.074 +- 0.118 (in-sample avg dev_std = 0.199)
NEC for r=0.3 all L1 = 0.126 +- 0.121 (in-sample avg dev_std = 0.199)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.528
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.529
NEC for r=0.6 class 0.0 = 0.204 +- 0.133 (in-sample avg dev_std = 0.250)
NEC for r=0.6 class 1.0 = 0.193 +- 0.133 (in-sample avg dev_std = 0.250)
NEC for r=0.6 all KL = 0.098 +- 0.133 (in-sample avg dev_std = 0.250)
NEC for r=0.6 all L1 = 0.194 +- 0.154 (in-sample avg dev_std = 0.250)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.575
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.549
NEC for r=0.9 class 0.0 = 0.212 +- 0.111 (in-sample avg dev_std = 0.251)
NEC for r=0.9 class 1.0 = 0.223 +- 0.111 (in-sample avg dev_std = 0.251)
NEC for r=0.9 all KL = 0.1 +- 0.111 (in-sample avg dev_std = 0.251)
NEC for r=0.9 all L1 = 0.222 +- 0.137 (in-sample avg dev_std = 0.251)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.584
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.577
NEC for r=1.0 class 0.0 = 0.2 +- 0.108 (in-sample avg dev_std = 0.228)
NEC for r=1.0 class 1.0 = 0.191 +- 0.108 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all KL = 0.081 +- 0.108 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all L1 = 0.192 +- 0.130 (in-sample avg dev_std = 0.228)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.59
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.576
NEC for r=0.3 class 0.0 = 0.116 +- 0.116 (in-sample avg dev_std = 0.192)
NEC for r=0.3 class 1.0 = 0.13 +- 0.116 (in-sample avg dev_std = 0.192)
NEC for r=0.3 all KL = 0.072 +- 0.116 (in-sample avg dev_std = 0.192)
NEC for r=0.3 all L1 = 0.128 +- 0.122 (in-sample avg dev_std = 0.192)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.604
NEC for r=0.6 class 0.0 = 0.155 +- 0.146 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 1.0 = 0.194 +- 0.146 (in-sample avg dev_std = 0.254)
NEC for r=0.6 all KL = 0.101 +- 0.146 (in-sample avg dev_std = 0.254)
NEC for r=0.6 all L1 = 0.188 +- 0.157 (in-sample avg dev_std = 0.254)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.666
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.635
NEC for r=0.9 class 0.0 = 0.193 +- 0.124 (in-sample avg dev_std = 0.247)
NEC for r=0.9 class 1.0 = 0.219 +- 0.124 (in-sample avg dev_std = 0.247)
NEC for r=0.9 all KL = 0.099 +- 0.124 (in-sample avg dev_std = 0.247)
NEC for r=0.9 all L1 = 0.215 +- 0.140 (in-sample avg dev_std = 0.247)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.663
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.654
NEC for r=1.0 class 0.0 = 0.176 +- 0.121 (in-sample avg dev_std = 0.243)
NEC for r=1.0 class 1.0 = 0.195 +- 0.121 (in-sample avg dev_std = 0.243)
NEC for r=1.0 all KL = 0.088 +- 0.121 (in-sample avg dev_std = 0.243)
NEC for r=1.0 all L1 = 0.191 +- 0.138 (in-sample avg dev_std = 0.243)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.687, 0.734, 0.869, 1.0], 'all_L1': [0.628, 0.663, 0.762, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.92, 0.892, 0.954, 1.0], 'all_L1': [0.79, 0.807, 0.896, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.636, 0.709, 0.887, 1.0], 'all_L1': [0.598, 0.684, 0.845, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.832, 0.88, 0.942, 1.0], 'all_L1': [0.678, 0.715, 0.812, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.804, 0.739, 0.854, 1.0], 'all_L1': [0.767, 0.671, 0.749, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.16, 0.131, 0.096, 0.084], 'all_L1': [0.246, 0.219, 0.195, 0.187]}), defaultdict(<class 'list'>, {'all_KL': [0.041, 0.055, 0.032, 0.023], 'all_L1': [0.153, 0.135, 0.089, 0.071]}), defaultdict(<class 'list'>, {'all_KL': [0.196, 0.165, 0.09, 0.072], 'all_L1': [0.278, 0.223, 0.134, 0.113]}), defaultdict(<class 'list'>, {'all_KL': [0.119, 0.078, 0.05, 0.044], 'all_L1': [0.269, 0.228, 0.173, 0.16]}), defaultdict(<class 'list'>, {'all_KL': [0.085, 0.119, 0.102, 0.085], 'all_L1': [0.144, 0.205, 0.204, 0.176]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.69, 0.748, 0.886, 1.0], 'all_L1': [0.638, 0.659, 0.77, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.911, 0.871, 0.933, 1.0], 'all_L1': [0.759, 0.753, 0.847, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.697, 0.701, 0.864, 1.0], 'all_L1': [0.63, 0.657, 0.807, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.852, 0.897, 0.961, 1.0], 'all_L1': [0.691, 0.738, 0.847, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.871, 0.806, 0.886, 1.0], 'all_L1': [0.827, 0.717, 0.762, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.175, 0.132, 0.094, 0.087], 'all_L1': [0.256, 0.231, 0.202, 0.195]}), defaultdict(<class 'list'>, {'all_KL': [0.053, 0.072, 0.049, 0.037], 'all_L1': [0.186, 0.181, 0.132, 0.108]}), defaultdict(<class 'list'>, {'all_KL': [0.173, 0.167, 0.113, 0.1], 'all_L1': [0.27, 0.242, 0.175, 0.152]}), defaultdict(<class 'list'>, {'all_KL': [0.115, 0.079, 0.046, 0.039], 'all_L1': [0.271, 0.227, 0.165, 0.149]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.098, 0.1, 0.081], 'all_L1': [0.126, 0.194, 0.222, 0.192]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.69, 0.753, 0.888, 1.0], 'all_L1': [0.649, 0.686, 0.786, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.911, 0.883, 0.94, 1.0], 'all_L1': [0.762, 0.769, 0.855, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.694, 0.7, 0.875, 1.0], 'all_L1': [0.631, 0.649, 0.808, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.858, 0.894, 0.958, 1.0], 'all_L1': [0.698, 0.737, 0.843, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.796, 0.882, 1.0], 'all_L1': [0.818, 0.72, 0.765, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.167, 0.125, 0.086, 0.085], 'all_L1': [0.243, 0.213, 0.189, 0.185]}), defaultdict(<class 'list'>, {'all_KL': [0.051, 0.061, 0.043, 0.031], 'all_L1': [0.18, 0.163, 0.123, 0.101]}), defaultdict(<class 'list'>, {'all_KL': [0.162, 0.172, 0.117, 0.103], 'all_L1': [0.26, 0.253, 0.187, 0.16]}), defaultdict(<class 'list'>, {'all_KL': [0.108, 0.077, 0.043, 0.036], 'all_L1': [0.265, 0.225, 0.161, 0.144]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.101, 0.099, 0.088], 'all_L1': [0.128, 0.188, 0.215, 0.191]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.692 +- 0.075, 0.708 +- 0.053, 0.813 +- 0.054, 1.000 +- 0.000
suff++ class all_KL  =  0.776 +- 0.102, 0.791 +- 0.078, 0.901 +- 0.040, 1.000 +- 0.000
suff++_acc_int  =  0.595 +- 0.062, 0.661 +- 0.071, 0.730 +- 0.066
nec class all_L1  =  0.218 +- 0.058, 0.202 +- 0.034, 0.159 +- 0.043, 0.141 +- 0.043
nec class all_KL  =  0.120 +- 0.054, 0.110 +- 0.039, 0.074 +- 0.028, 0.062 +- 0.024
nec_acc_int  =  0.616 +- 0.052, 0.706 +- 0.056, 0.738 +- 0.070, 0.752 +- 0.069

Eval split val
suff++ class all_L1  =  0.709 +- 0.075, 0.705 +- 0.040, 0.807 +- 0.036, 1.000 +- 0.000
suff++ class all_KL  =  0.804 +- 0.092, 0.805 +- 0.073, 0.906 +- 0.036, 1.000 +- 0.000
suff++_acc_int  =  0.521 +- 0.032, 0.563 +- 0.036, 0.595 +- 0.035
nec class all_L1  =  0.222 +- 0.057, 0.215 +- 0.023, 0.179 +- 0.031, 0.159 +- 0.032
nec class all_KL  =  0.118 +- 0.050, 0.110 +- 0.035, 0.080 +- 0.028, 0.069 +- 0.026
nec_acc_int  =  0.528 +- 0.046, 0.573 +- 0.032, 0.597 +- 0.044, 0.607 +- 0.044

Eval split test
suff++ class all_L1  =  0.712 +- 0.070, 0.712 +- 0.041, 0.811 +- 0.034, 1.000 +- 0.000
suff++ class all_KL  =  0.802 +- 0.092, 0.805 +- 0.075, 0.909 +- 0.034, 1.000 +- 0.000
suff++_acc_int  =  0.562 +- 0.035, 0.597 +- 0.032, 0.624 +- 0.037
nec class all_L1  =  0.215 +- 0.053, 0.208 +- 0.031, 0.175 +- 0.031, 0.156 +- 0.032
nec class all_KL  =  0.112 +- 0.047, 0.107 +- 0.039, 0.078 +- 0.030, 0.069 +- 0.029
nec_acc_int  =  0.583 +- 0.037, 0.617 +- 0.043, 0.634 +- 0.044, 0.644 +- 0.046


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.455 +- 0.016, 0.455 +- 0.014, 0.486 +- 0.007, 0.571 +- 0.022
Faith. Armon (L1)= 		  =  0.323 +- 0.062, 0.311 +- 0.041, 0.262 +- 0.059, 0.245 +- 0.068
Faith. GMean (L1)= 	  =  0.382 +- 0.036, 0.375 +- 0.025, 0.354 +- 0.041, 0.371 +- 0.062
Faith. Aritm (KL)= 		  =  0.448 +- 0.026, 0.450 +- 0.021, 0.488 +- 0.007, 0.531 +- 0.012
Faith. Armon (KL)= 		  =  0.200 +- 0.078, 0.188 +- 0.058, 0.135 +- 0.048, 0.115 +- 0.044
Faith. GMean (KL)= 	  =  0.291 +- 0.057, 0.286 +- 0.041, 0.252 +- 0.048, 0.242 +- 0.054

Eval split val
Faith. Aritm (L1)= 		  =  0.465 +- 0.014, 0.460 +- 0.013, 0.493 +- 0.007, 0.580 +- 0.016
Faith. Armon (L1)= 		  =  0.330 +- 0.064, 0.328 +- 0.025, 0.291 +- 0.039, 0.273 +- 0.048
Faith. GMean (L1)= 	  =  0.390 +- 0.038, 0.388 +- 0.015, 0.378 +- 0.026, 0.397 +- 0.041
Faith. Aritm (KL)= 		  =  0.461 +- 0.023, 0.457 +- 0.020, 0.493 +- 0.005, 0.534 +- 0.013
Faith. Armon (KL)= 		  =  0.199 +- 0.072, 0.189 +- 0.051, 0.146 +- 0.046, 0.128 +- 0.046
Faith. GMean (KL)= 	  =  0.296 +- 0.051, 0.291 +- 0.033, 0.265 +- 0.044, 0.257 +- 0.052

Eval split test
Faith. Aritm (L1)= 		  =  0.463 +- 0.015, 0.460 +- 0.012, 0.493 +- 0.006, 0.578 +- 0.016
Faith. Armon (L1)= 		  =  0.324 +- 0.060, 0.320 +- 0.034, 0.286 +- 0.041, 0.269 +- 0.049
Faith. GMean (L1)= 	  =  0.385 +- 0.036, 0.383 +- 0.021, 0.374 +- 0.028, 0.393 +- 0.043
Faith. Aritm (KL)= 		  =  0.457 +- 0.024, 0.456 +- 0.019, 0.493 +- 0.005, 0.534 +- 0.015
Faith. Armon (KL)= 		  =  0.191 +- 0.069, 0.185 +- 0.057, 0.141 +- 0.051, 0.127 +- 0.052
Faith. GMean (KL)= 	  =  0.289 +- 0.049, 0.286 +- 0.039, 0.259 +- 0.049, 0.255 +- 0.060
Computed for split load_split = id



Completed in  0:29:30.112640  for GSATvGIN LBAPcore/assay



DONE GSAT LBAPcore/assay
